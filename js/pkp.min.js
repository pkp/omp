(function(a){function c(){a.fn.ajaxSubmit.debug&&(window.console&&window.console.log)&&window.console.log("[jquery.form] "+Array.prototype.join.call(arguments,""))}a.fn.ajaxSubmit=function(b){function d(){function d(){if(!w++){k.detachEvent?k.detachEvent("onload",d):k.removeEventListener("load",d,!1);var b=!0;try{if(x)throw"timeout";var e,i;i=k.contentWindow?k.contentWindow.document:k.contentDocument?k.contentDocument:k.document;var h="xml"==f.dataType||i.XMLDocument||a.isXMLDoc(i);c("isXml="+h);
if(!h&&(null==i.body||""==i.body.innerHTML)){if(--y){w=0;setTimeout(d,100);return}c("Could not access iframe DOM after 50 tries.");return}r.responseText=i.body?i.body.innerHTML:null;r.responseXML=i.XMLDocument?i.XMLDocument:i;r.getResponseHeader=function(a){return{"content-type":f.dataType}[a]};if("json"==f.dataType||"script"==f.dataType){var g=i.getElementsByTagName("textarea")[0];if(g)r.responseText=g.value;else{var p=i.getElementsByTagName("pre")[0];p&&(r.responseText=p.innerHTML)}}else if("xml"==
f.dataType&&!r.responseXML&&null!=r.responseText){i=r;var v=r.responseText,h=void 0;window.ActiveXObject?(h=new ActiveXObject("Microsoft.XMLDOM"),h.async="false",h.loadXML(v)):h=(new DOMParser).parseFromString(v,"text/xml");i.responseXML=h&&h.documentElement&&"parsererror"!=h.documentElement.tagName?h:null}e=a.httpData(r,f.dataType)}catch(q){b=!1,a.handleError(f,r,"error",q)}b&&(f.success(e,"success"),u&&a.event.trigger("ajaxSuccess",[r,f]));u&&a.event.trigger("ajaxComplete",[r,f]);u&&!--a.active&&
a.event.trigger("ajaxStop");f.complete&&f.complete(r,b?"success":"error");setTimeout(function(){j.remove();r.responseXML=null},100)}}var e=h[0];if(a(":input[name=submit]",e).length)alert('Error: Form elements must not be named "submit".');else{var f=a.extend({},a.ajaxSettings,b),i=a.extend(!0,{},a.extend(!0,{},a.ajaxSettings),f),g="jqFormIO"+(new Date).getTime(),j=a('<iframe id="'+g+'" name="'+g+'" src="'+f.iframeSrc+'" />'),k=j[0];j.css({position:"absolute",top:"-1000px",left:"-1000px"});var r={aborted:0,
responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;j.attr("src",f.iframeSrc)}},u=f.global;u&&!a.active++&&a.event.trigger("ajaxStart");u&&a.event.trigger("ajaxSend",[r,f]);if(i.beforeSend&&!1===i.beforeSend(r,i))i.global&&a.active--;else if(!r.aborted){var w=0,x=0;if(i=e.clk){var v=i.name;v&&!i.disabled&&(b.extraData=b.extraData||{},b.extraData[v]=i.value,"image"==
i.type&&(b.extraData[v+".x"]=e.clk_x,b.extraData[v+".y"]=e.clk_y))}setTimeout(function(){var c=h.attr("target"),i=h.attr("action");e.setAttribute("target",g);"POST"!=e.getAttribute("method")&&e.setAttribute("method","POST");e.getAttribute("action")!=f.url&&e.setAttribute("action",f.url);b.skipEncodingOverride||h.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});f.timeout&&setTimeout(function(){x=!0;d()},f.timeout);var u=[];try{if(b.extraData)for(var w in b.extraData)u.push(a('<input type="hidden" name="'+
w+'" value="'+b.extraData[w]+'" />').appendTo(e)[0]);j.appendTo("body");k.attachEvent?k.attachEvent("onload",d):k.addEventListener("load",d,!1);e.submit()}finally{e.setAttribute("action",i),c?e.setAttribute("target",c):h.removeAttr("target"),a(u).remove()}},10);var y=50}}}if(!this.length)return c("ajaxSubmit: skipping submit process - no element selected"),this;"function"==typeof b&&(b={success:b});var e=a.trim(this.attr("action"));e&&(e=(e.match(/^([^#]+)/)||[])[1]);e=e||window.location.href||"";
b=a.extend({url:e,type:this.attr("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},b||{});e={};this.trigger("form-pre-serialize",[this,b,e]);if(e.veto)return c("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(b.beforeSerialize&&!1===b.beforeSerialize(this,b))return c("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var f=this.formToArray(b.semantic);if(b.data){b.extraData=b.data;for(var i in b.data)if(b.data[i]instanceof
Array)for(var g in b.data[i])f.push({name:i,value:b.data[i][g]});else f.push({name:i,value:b.data[i]})}if(b.beforeSubmit&&!1===b.beforeSubmit(f,this,b))return c("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[f,this,b,e]);if(e.veto)return c("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;i=a.param(f);"GET"==b.type.toUpperCase()?(b.url+=(0<=b.url.indexOf("?")?"&":"?")+i,b.data=null):b.data=i;var h=this,j=[];b.resetForm&&j.push(function(){h.resetForm()});
b.clearForm&&j.push(function(){h.clearForm()});if(!b.dataType&&b.target){var k=b.success||function(){};j.push(function(c){a(b.target).html(c).each(k,arguments)})}else b.success&&j.push(b.success);b.success=function(a,c){for(var d=0,e=j.length;d<e;d++)j[d].apply(b,[a,c,h])};i=a("input:file",this).fieldValue();g=!1;for(e=0;e<i.length;e++)i[e]&&(g=!0);i.length&&!1!==b.iframe||b.iframe||g?b.closeKeepAlive?a.get(b.closeKeepAlive,d):d():a.ajax(b);this.trigger("form-submit-notify",[this,b]);return this};
a.fn.ajaxForm=function(c){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){a(this).ajaxSubmit(c);return!1}).bind("click.form-plugin",function(c){var b=c.target,f=a(b);if(!f.is(":submit,input:image")){b=f.closest(":submit");if(0==b.length)return;b=b[0]}var i=this;i.clk=b;"image"==b.type&&(void 0!=c.offsetX?(i.clk_x=c.offsetX,i.clk_y=c.offsetY):"function"==typeof a.fn.offset?(f=f.offset(),i.clk_x=c.pageX-f.left,i.clk_y=c.pageY-f.top):(i.clk_x=c.pageX-b.offsetLeft,i.clk_y=c.pageY-b.offsetTop));
setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)})};a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};a.fn.formToArray=function(c){var d=[];if(0==this.length)return d;var e=this[0],f=c?e.getElementsByTagName("*"):e.elements;if(!f)return d;for(var i=0,g=f.length;i<g;i++){var h=f[i],j=h.name;if(j)if(c&&e.clk&&"image"==h.type)!h.disabled&&e.clk==h&&(d.push({name:j,value:a(h).val()}),d.push({name:j+".x",value:e.clk_x},{name:j+".y",value:e.clk_y}));else if((h=
a.fieldValue(h,!0))&&h.constructor==Array)for(var k=0,l=h.length;k<l;k++)d.push({name:j,value:h[k]});else null!==h&&"undefined"!=typeof h&&d.push({name:j,value:h})}if(!c&&e.clk&&(c=a(e.clk),f=c[0],(j=f.name)&&!f.disabled&&"image"==f.type))d.push({name:j,value:c.val()}),d.push({name:j+".x",value:e.clk_x},{name:j+".y",value:e.clk_y});return d};a.fn.formSerialize=function(c){return a.param(this.formToArray(c))};a.fn.fieldSerialize=function(c){var d=[];this.each(function(){var e=this.name;if(e){var f=
a.fieldValue(this,c);if(f&&f.constructor==Array)for(var i=0,g=f.length;i<g;i++)d.push({name:e,value:f[i]});else null!==f&&"undefined"!=typeof f&&d.push({name:this.name,value:f})}});return a.param(d)};a.fn.fieldValue=function(c){for(var d=[],e=0,f=this.length;e<f;e++){var i=a.fieldValue(this[e],c);null===i||("undefined"==typeof i||i.constructor==Array&&!i.length)||(i.constructor==Array?a.merge(d,i):d.push(i))}return d};a.fieldValue=function(a,c){var e=a.name,f=a.type,i=a.tagName.toLowerCase();"undefined"==
typeof c&&(c=!0);if(c&&(!e||a.disabled||"reset"==f||"button"==f||("checkbox"==f||"radio"==f)&&!a.checked||("submit"==f||"image"==f)&&a.form&&a.form.clk!=a||"select"==i&&-1==a.selectedIndex))return null;if("select"==i){var g=a.selectedIndex;if(0>g)return null;for(var e=[],i=a.options,h=(f="select-one"==f)?g+1:i.length,g=f?g:0;g<h;g++){var j=i[g];if(j.selected){var k=j.value;k||(k=j.attributes&&j.attributes.value&&!j.attributes.value.specified?j.text:j.value);if(f)return k;e.push(k)}}return e}return a.value};
a.fn.clearForm=function(){return this.each(function(){a("input,select,textarea",this).clearFields()})};a.fn.clearFields=a.fn.clearInputs=function(){return this.each(function(){var a=this.type,c=this.tagName.toLowerCase();"text"==a||"password"==a||"textarea"==c?this.value="":"checkbox"==a||"radio"==a?this.checked=!1:"select"==c&&(this.selectedIndex=-1)})};a.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};
a.fn.enable=function(a){void 0==a&&(a=!0);return this.each(function(){this.disabled=!a})};a.fn.selected=function(c){void 0==c&&(c=!0);return this.each(function(){var d=this.type;"checkbox"==d||"radio"==d?this.checked=c:"option"==this.tagName.toLowerCase()&&(d=a(this).parent("select"),c&&(d[0]&&"select-one"==d[0].type)&&d.find("option").selected(!1),this.selected=c)})}})(jQuery);(function(a){a.widget("ui.tagit",{options:{itemName:"item",fieldName:"tags",availableTags:[],tagSource:null,removeConfirmation:!1,caseSensitive:!0,allowSpaces:!1,animate:!0,singleField:!1,singleFieldDelimiter:",",singleFieldNode:null,tabIndex:null,onTagAdded:null,onTagRemoved:null,onTagClicked:null},_create:function(){var c=this;this.element.is("input")?(this.tagList=a("<ul></ul>").insertAfter(this.element),this.options.singleField=!0,this.options.singleFieldNode=this.element,this.element.css("display",
"none")):this.tagList=this.element.find("ul, ol").andSelf().last();this._tagInput=a('<input type="text" />').addClass("ui-widget-content");this.options.tabIndex&&this._tagInput.attr("tabindex",this.options.tabIndex);this.options.tagSource=this.options.tagSource||function(c,b){var d=c.term.toLowerCase(),g=a.grep(this.options.availableTags,function(a){return 0===a.toLowerCase().indexOf(d)});b(this._subtractArray(g,this.assignedTags()))};a.isFunction(this.options.tagSource)&&(this.options.tagSource=
a.proxy(this.options.tagSource,this));this.tagList.addClass("tagit").addClass("ui-widget ui-widget-content ui-corner-all").append(a('<li class="tagit-new"></li>').append(this._tagInput)).click(function(b){var d=a(b.target);d.hasClass("tagit-label")?c._trigger("onTagClicked",b,d.closest(".tagit-choice")):c._tagInput.focus()});this.tagList.children("li").each(function(){a(this).hasClass("tagit-new")||(c.createTag(a(this).html(),a(this).attr("class"),!0),a(this).remove())});if(this.options.singleField)if(this.options.singleFieldNode){var b=
a(this.options.singleFieldNode),d=b.val().split(this.options.singleFieldDelimiter);b.val("");a.each(d,function(a,b){c.createTag(b,null,!1)})}else this.options.singleFieldNode=this.tagList.after('<input type="hidden" style="display:none;" value="" name="'+this.options.fieldName+'" />');this._tagInput.keydown(function(b){if(b.which==a.ui.keyCode.BACKSPACE&&""===c._tagInput.val()){var d=c._lastTag();!c.options.removeConfirmation||d.hasClass("remove")?c.removeTag(d):c.options.removeConfirmation&&d.addClass("remove ui-state-highlight")}else c.options.removeConfirmation&&
c._lastTag().removeClass("remove ui-state-highlight");if(b.which==a.ui.keyCode.COMMA||b.which==a.ui.keyCode.ENTER||b.which==a.ui.keyCode.TAB&&""!==c._tagInput.val()||b.which==a.ui.keyCode.SPACE&&!0!==c.options.allowSpaces&&('"'!=a.trim(c._tagInput.val()).replace(/^s*/,"").charAt(0)||'"'==a.trim(c._tagInput.val()).charAt(0)&&'"'==a.trim(c._tagInput.val()).charAt(a.trim(c._tagInput.val()).length-1)&&0!==a.trim(c._tagInput.val()).length-1))b.preventDefault(),c.createTag(c._cleanedInput(),null,!1),c._tagInput.autocomplete("close")}).blur(function(){c.createTag(c._cleanedInput(),
null,!1)});this._autocompleteVal=null;this._selectAction=function(){if(c._tagInput.val()==c._autocompleteVal)return c.createTag(c._autocompleteVal,null,!0),c.tagList.children(".tagit-new").children("input").val(""),!1};(this.options.availableTags||this.options.tagSource)&&this._tagInput.autocomplete({source:this.options.tagSource,close:this._selectAction,select:this._selectAction,minLength:2,autoFocus:!0,focus:function(b,d){c._autocompleteVal=d.item.value;a(this).val(c._unescapeHTML(d.item.value));
return!1}})},_cleanedInput:function(){return a.trim(this._tagInput.val().replace(/^"(.*)"$/,"$1"))},_lastTag:function(){return this.tagList.children(".tagit-choice:last")},assignedTags:function(){var c=this,b=[];this.options.singleField?(b=a(this.options.singleFieldNode).val().split(this.options.singleFieldDelimiter),""===b[0]&&(b=[])):this.tagList.children(".tagit-choice").each(function(){b.push(c.tagLabel(this))});return b},_updateSingleTagsField:function(c){a(this.options.singleFieldNode).val(c.join(this.options.singleFieldDelimiter))},
_subtractArray:function(c,b){for(var d=[],e=0;e<c.length;e++)-1==a.inArray(c[e],b)&&d.push(c[e]);return d},tagLabel:function(c){return this.options.singleField?a(c).children(".tagit-label").text():a(c).children("input").val()},_isNew:function(a){var b=this,d=!0;this.tagList.children(".tagit-choice").each(function(){if(b._formatStr(urlEncode(a))==b._formatStr(b.tagLabel(this)))return d=!1});return d},_formatStr:function(c){return this.options.caseSensitive?c:a.trim(c.toLowerCase())},_unescapeHTML:function(c){return a("<div/>").html(c).text()},
createTag:function(c,b,d){d&&(c=this._unescapeHTML(c));var e=this,c=a.trim(c);if(!this._isNew(c)||""===c)return!1;var d=a(this.options.onTagClicked?'<a class="tagit-label"></a>':'<span class="tagit-label"></span>').text(c),f=a("<li></li>").addClass("tagit-choice ui-widget-content ui-state-default ui-corner-all").addClass(b).append(d),b=a("<span></span>").addClass("ui-icon ui-icon-close"),b=a('<a><span class="text-icon">\u00d7</span></a>').addClass("tagit-close").append(b).click(function(){e.removeTag(f)});
f.append(b);this.options.singleField?(b=this.assignedTags(),b.push(c),this._updateSingleTagsField(b)):(c=urlEncode(c),f.append('<input type="hidden" style="display:none;" value="'+c+'" name="'+this.options.itemName+"["+this.options.fieldName+'][]" />'));this._trigger("onTagAdded",null,f);this._tagInput.val("");this._tagInput.parent().before(f)},removeTag:function(c,b){b=b||this.options.animate;c=a(c);this._trigger("onTagRemoved",null,c);if(this.options.singleField){var d=this.assignedTags(),e=this.tagLabel(c),
d=a.grep(d,function(a){return a!=e});this._updateSingleTagsField(d)}b?c.fadeOut("fast").hide("blind",{direction:"horizontal"},"fast",function(){c.remove()}).dequeue():c.remove()},removeAll:function(){var a=this;this.tagList.children(".tagit-choice").each(function(b,d){a.removeTag(d,!1)})}})})(jQuery);(function(a){var c,b,d,e;a.extend({pnotify_remove_all:function(){var c=d.data("pnotify");c&&c.length&&a.each(c,function(){this.pnotify_remove&&this.pnotify_remove()})},pnotify_position_all:function(){b&&clearTimeout(b);b=null;var c=d.data("pnotify");c&&c.length&&(a.each(c,function(){var a=this.opts.pnotify_stack;if(a&&(a.nextpos1||(a.nextpos1=a.firstpos1),a.nextpos2||(a.nextpos2=a.firstpos2),a.addpos2||(a.addpos2=0),"none"!=this.css("display"))){var c,b,d={},f;switch(a.dir1){case "down":f="top";break;
case "up":f="bottom";break;case "left":f="right";break;case "right":f="left"}c=parseInt(this.css(f));isNaN(c)&&(c=0);"undefined"==typeof a.firstpos1&&(a.firstpos1=c,a.nextpos1=a.firstpos1);var l;switch(a.dir2){case "down":l="top";break;case "up":l="bottom";break;case "left":l="right";break;case "right":l="left"}b=parseInt(this.css(l));isNaN(b)&&(b=0);"undefined"==typeof a.firstpos2&&(a.firstpos2=b,a.nextpos2=a.firstpos2);if("down"==a.dir1&&a.nextpos1+this.height()>e.height()||"up"==a.dir1&&a.nextpos1+
this.height()>e.height()||"left"==a.dir1&&a.nextpos1+this.width()>e.width()||"right"==a.dir1&&a.nextpos1+this.width()>e.width())a.nextpos1=a.firstpos1,a.nextpos2+=a.addpos2+10,a.addpos2=0;if(a.animation&&a.nextpos2<b)switch(a.dir2){case "down":d.top=a.nextpos2+"px";break;case "up":d.bottom=a.nextpos2+"px";break;case "left":d.right=a.nextpos2+"px";break;case "right":d.left=a.nextpos2+"px"}else this.css(l,a.nextpos2+"px");switch(a.dir2){case "down":case "up":this.outerHeight(!0)>a.addpos2&&(a.addpos2=
this.height());break;case "left":case "right":this.outerWidth(!0)>a.addpos2&&(a.addpos2=this.width())}if(a.nextpos1)if(a.animation&&(c>a.nextpos1||d.top||d.bottom||d.right||d.left))switch(a.dir1){case "down":d.top=a.nextpos1+"px";break;case "up":d.bottom=a.nextpos1+"px";break;case "left":d.right=a.nextpos1+"px";break;case "right":d.left=a.nextpos1+"px"}else this.css(f,a.nextpos1+"px");(d.top||d.bottom||d.right||d.left)&&this.animate(d,{duration:500,queue:!1});switch(a.dir1){case "down":case "up":a.nextpos1+=
this.height()+10;break;case "left":case "right":a.nextpos1+=this.width()+10}}}),a.each(c,function(){var a=this.opts.pnotify_stack;a&&(a.nextpos1=a.firstpos1,a.nextpos2=a.firstpos2,a.addpos2=0,a.animation=!0)}))},pnotify:function(f){d||(d=a("body"));e||(e=a(window));var i,g;"string"==typeof f?(g=a.extend({},a.pnotify.defaults),g.pnotify_text=f):g=a.extend({},a.pnotify.defaults,f);if(g.pnotify_before_init&&!1===g.pnotify_before_init(g))return null;var h=a("<div />",{"class":"ui-widget ui-helper-clearfix ui-pnotify "+
g.pnotify_addclass,css:{display:"none"},mouseenter:function(){"out"==i&&(h.stop(!0),h.css("height","auto").animate({width:g.pnotify_width,opacity:g.pnotify_opacity},"fast"));g.pnotify_hide&&h.pnotify_cancel_remove();g.pnotify_closer&&h.closer.show()},mouseleave:function(){g.pnotify_hide&&h.pnotify_queue_remove();h.closer.hide();a.pnotify_position_all()}});h.opts=g;g.pnotify_shadow&&(h.shadow_container=a("<div />",{"class":"ui-widget-shadow ui-pnotify-shadow"}).prependTo(h));h.container=a("<div />",
{"class":"ui-corner-all ui-pnotify-container "+("error"==g.pnotify_type?"ui-state-error":"ui-state-highlight")}).appendTo(h);h.pnotify_version="1.0.0";h.pnotify=function(c){var b=g;"string"==typeof c?g.pnotify_text=c:g=a.extend({},g,c);h.opts=g;g.pnotify_shadow!=b.pnotify_shadow&&(g.pnotify_shadow?h.shadow_container=a("<div />",{"class":"ui-widget-shadow ui-pnotify-shadow"}).prependTo(h):h.children(".ui-pnotify-shadow").remove());!1===g.pnotify_addclass?h.removeClass(b.pnotify_addclass):g.pnotify_addclass!==
b.pnotify_addclass&&h.removeClass(b.pnotify_addclass).addClass(g.pnotify_addclass);!1===g.pnotify_title?h.title_container.hide("fast"):g.pnotify_title!==b.pnotify_title&&h.title_container.html(g.pnotify_title).show("fast");!1===g.pnotify_text?h.text_container.hide("fast"):g.pnotify_text!==b.pnotify_text&&(g.pnotify_insert_brs&&(g.pnotify_text=g.pnotify_text.replace("\n","<br />")),h.text_container.html(g.pnotify_text).show("fast"));h.pnotify_history=g.pnotify_history;g.pnotify_type!=b.pnotify_type&&
h.container.toggleClass("ui-state-error ui-state-highlight");if(g.pnotify_notice_icon!=b.pnotify_notice_icon&&"notice"==g.pnotify_type||g.pnotify_error_icon!=b.pnotify_error_icon&&"error"==g.pnotify_type||g.pnotify_type!=b.pnotify_type)if(h.container.find("div.ui-pnotify-icon").remove(),g.pnotify_error_icon&&"error"==g.pnotify_type||g.pnotify_notice_icon)a("<div />",{"class":"ui-pnotify-icon"}).append(a("<span />",{"class":"error"==g.pnotify_type?g.pnotify_error_icon:g.pnotify_notice_icon})).prependTo(h.container);
g.pnotify_width!==b.pnotify_width&&h.animate({width:g.pnotify_width});g.pnotify_min_height!==b.pnotify_min_height&&h.container.animate({minHeight:g.pnotify_min_height});g.pnotify_opacity!==b.pnotify_opacity&&h.fadeTo(g.pnotify_animate_speed,g.pnotify_opacity);g.pnotify_hide?b.pnotify_hide||h.pnotify_queue_remove():h.pnotify_cancel_remove();h.pnotify_queue_position();return h};h.pnotify_queue_position=function(){b&&clearTimeout(b);b=setTimeout(a.pnotify_position_all,10)};h.pnotify_display=function(){h.parent().length||
h.appendTo(d);g.pnotify_before_open&&!1===g.pnotify_before_open(h)||(h.pnotify_queue_position(),"fade"==g.pnotify_animation||"fade"==g.pnotify_animation.effect_in?h.show().fadeTo(0,0).hide():1!=g.pnotify_opacity&&h.show().fadeTo(0,g.pnotify_opacity).hide(),h.animate_in(function(){g.pnotify_after_open&&g.pnotify_after_open(h);h.pnotify_queue_position();g.pnotify_hide&&h.pnotify_queue_remove()}))};h.pnotify_remove=function(){h.timer&&(window.clearTimeout(h.timer),h.timer=null);g.pnotify_before_close&&
!1===g.pnotify_before_close(h)||h.animate_out(function(){g.pnotify_after_close&&!1===g.pnotify_after_close(h)||(h.pnotify_queue_position(),g.pnotify_remove&&h.detach())})};h.animate_in=function(a){i="in";var c;c="undefined"!=typeof g.pnotify_animation.effect_in?g.pnotify_animation.effect_in:g.pnotify_animation;"none"==c?(h.show(),a()):"show"==c?h.show(g.pnotify_animate_speed,a):"fade"==c?h.show().fadeTo(g.pnotify_animate_speed,g.pnotify_opacity,a):"slide"==c?h.slideDown(g.pnotify_animate_speed,a):
"function"==typeof c?c("in",a,h):h.effect&&h.effect(c,{},g.pnotify_animate_speed,a)};h.animate_out=function(a){i="out";var c;c="undefined"!=typeof g.pnotify_animation.effect_out?g.pnotify_animation.effect_out:g.pnotify_animation;"none"==c?(h.hide(),a()):"show"==c?h.hide(g.pnotify_animate_speed,a):"fade"==c?h.fadeOut(g.pnotify_animate_speed,a):"slide"==c?h.slideUp(g.pnotify_animate_speed,a):"function"==typeof c?c("out",a,h):h.effect&&h.effect(c,{},g.pnotify_animate_speed,a)};h.pnotify_cancel_remove=
function(){h.timer&&window.clearTimeout(h.timer)};h.pnotify_queue_remove=function(){h.pnotify_cancel_remove();h.timer=window.setTimeout(function(){h.pnotify_remove()},isNaN(g.pnotify_delay)?0:g.pnotify_delay)};h.closer=a("<div />",{"class":"ui-pnotify-closer",css:{cursor:"pointer",display:"none"},click:function(){h.pnotify_remove();h.closer.hide()}}).append(a("<span />",{"class":"ui-icon ui-icon-circle-close"})).appendTo(h.container);if(g.pnotify_error_icon&&"error"==g.pnotify_type||g.pnotify_notice_icon)a("<div />",
{"class":"ui-pnotify-icon"}).append(a("<span />",{"class":"error"==g.pnotify_type?g.pnotify_error_icon:g.pnotify_notice_icon})).appendTo(h.container);h.title_container=a("<div />",{"class":"ui-pnotify-title",html:g.pnotify_title}).appendTo(h.container);"string"!=typeof g.pnotify_title&&h.title_container.hide();g.pnotify_insert_brs&&"string"==typeof g.pnotify_text&&(g.pnotify_text=g.pnotify_text.replace("\n","<br />"));h.text_container=a("<div />",{"class":"ui-pnotify-text",html:g.pnotify_text}).appendTo(h.container);
"string"!=typeof g.pnotify_text&&h.text_container.hide();"string"==typeof g.pnotify_width&&h.css("width",g.pnotify_width);"string"==typeof g.pnotify_min_height&&h.container.css("min-height",g.pnotify_min_height);h.pnotify_history=g.pnotify_history;var j=d.data("pnotify");if(null==j||"object"!=typeof j)j=[];j="top"==g.pnotify_stack.push?a.merge([h],j):a.merge(j,[h]);d.data("pnotify",j);g.pnotify_after_init&&g.pnotify_after_init(h);if(g.pnotify_history){var k=d.data("pnotify_history");"undefined"==
typeof k&&(k=a("<div />",{"class":"ui-pnotify-history-container ui-state-default ui-corner-bottom",mouseleave:function(){k.animate({top:"-"+c+"px"},{duration:100,queue:!1})}}).append(a("<div />",{"class":"ui-pnotify-history-header",text:"Redisplay"})).append(a("<button />",{"class":"ui-pnotify-history-all ui-state-default ui-corner-all",text:"All",hover:function(){a(this).toggleClass("ui-state-hover")},click:function(){a.each(j,function(){this.pnotify_history&&this.pnotify_display&&this.pnotify_display()});
return!1}})).append(a("<button />",{"class":"ui-pnotify-history-last ui-state-default ui-corner-all",text:"Last",hover:function(){a(this).toggleClass("ui-state-hover")},click:function(){for(var a=1;!j[j.length-a]||!j[j.length-a].pnotify_history;){if(0===j.length-a)return!1;a++}j[j.length-a].pnotify_display&&j[j.length-a].pnotify_display();return!1}})).appendTo(d),c=a("<span />",{"class":"ui-pnotify-history-pulldown ui-icon ui-icon-grip-dotted-horizontal",mouseenter:function(){k.animate({top:"0"},
{duration:100,queue:!1})}}).appendTo(k).offset().top+2,k.css({top:"-"+c+"px"}),d.data("pnotify_history",k))}g.pnotify_stack.animation=!1;h.pnotify_display();return h}});a.pnotify.defaults={pnotify_addclass:"",pnotify_history:!0,pnotify_width:"300px",pnotify_min_height:"16px",pnotify_type:"notice",pnotify_notice_icon:"ui-icon ui-icon-info",pnotify_error_icon:"ui-icon ui-icon-alert",pnotify_animation:"fade",pnotify_animate_speed:"slow",pnotify_opacity:1,pnotify_shadow:!1,pnotify_closer:!0,pnotify_hide:!0,
pnotify_delay:8E3,pnotify_remove:!0,pnotify_insert_brs:!0,pnotify_stack:{dir1:"down",dir2:"left",push:"bottom"}}})(jQuery);(function(a){var c,b,d;a.extend({roundaboutShapes:{def:"lazySusan",lazySusan:function(a,c,b){return{x:Math.sin(a+c),y:Math.sin(a+3*Math.PI/2+c)/8*b,z:(Math.cos(a+c)+1)/2,scale:Math.sin(a+Math.PI/2+c)/2+0.5}}}});c={bearing:0,tilt:0,minZ:100,maxZ:280,minOpacity:0.4,maxOpacity:1,minScale:0.4,maxScale:1,duration:600,btnNext:null,btnNextCallback:function(){},btnPrev:null,btnPrevCallback:function(){},btnToggleAutoplay:null,btnStartAutoplay:null,btnStopAutoplay:null,easing:"swing",clickToFocus:!0,clickToFocusCallback:function(){},
focusBearing:0,shape:"lazySusan",debug:!1,childSelector:"li",startingChild:null,reflect:!1,floatComparisonThreshold:0.001,autoplay:!1,autoplayDuration:1E3,autoplayPauseOnHover:!1,autoplayCallback:function(){},autoplayInitialDelay:0,enableDrag:!1,dropDuration:600,dropEasing:"swing",dropAnimateTo:"nearest",dropCallback:function(){},dragAxis:"x",dragFactor:4,triggerFocusEvents:!0,triggerBlurEvents:!0,responsive:!1};b={autoplayInterval:null,autoplayIsRunning:!1,autoplayStartTimeout:null,animating:!1,
childInFocus:-1,touchMoveStartPosition:null,stopAnimation:!1,lastAnimationStep:!1};d={init:function(e,f,i){var g;(new Date).getTime();e="object"==typeof e?e:{};f=a.isFunction(f)?f:function(){};f=a.isFunction(e)?e:f;g=a.extend({},c,e,b);return this.each(function(){var c=a(this),b=c.children(g.childSelector).length,e=360/b,b=g.startingChild&&g.startingChild>b-1?b-1:g.startingChild,l=null===g.startingChild?g.bearing:360-b*e,p="static"!==c.css("position")?c.css("position"):"relative";c.css({padding:0,
position:p}).addClass("roundabout-holder").data("roundabout",a.extend({},g,{startingChild:b,bearing:l,oppositeOfFocusBearing:d.normalize.apply(null,[g.focusBearing-180]),dragBearing:l,period:e}));i?c.unbind(".roundabout").children(g.childSelector).unbind(".roundabout"):g.responsive&&a(window).bind("resize",function(){d.relayoutChildren.apply(c)});g.clickToFocus&&c.children(g.childSelector).each(function(b){a(this).bind("click.roundabout",function(){var e=d.getPlacement.apply(c,[b]);if(!d.isInFocus.apply(c,
[e]))return d.stopAnimation.apply(a(this)),c.data("roundabout").animating||d.animateBearingToFocus.apply(c,[e,c.data("roundabout").clickToFocusCallback]),!1})});g.btnNext&&a(g.btnNext).bind("click.roundabout",function(){c.data("roundabout").animating||d.animateToNextChild.apply(c,[c.data("roundabout").btnNextCallback]);return!1});g.btnPrev&&a(g.btnPrev).bind("click.roundabout",function(){d.animateToPreviousChild.apply(c,[c.data("roundabout").btnPrevCallback]);return!1});g.btnToggleAutoplay&&a(g.btnToggleAutoplay).bind("click.roundabout",
function(){d.toggleAutoplay.apply(c);return!1});g.btnStartAutoplay&&a(g.btnStartAutoplay).bind("click.roundabout",function(){d.startAutoplay.apply(c);return!1});g.btnStopAutoplay&&a(g.btnStopAutoplay).bind("click.roundabout",function(){d.stopAutoplay.apply(c);return!1});g.autoplayPauseOnHover&&c.bind("mouseenter.roundabout.autoplay",function(){d.stopAutoplay.apply(c,[!0])}).bind("mouseleave.roundabout.autoplay",function(){d.startAutoplay.apply(c)});g.enableDrag&&(a.isFunction(c.drag)?a.isFunction(c.drop)?
c.drag(function(a,b){var e=c.data("roundabout"),f="x"===e.dragAxis.toLowerCase()?"deltaX":"deltaY";d.stopAnimation.apply(c);d.setBearing.apply(c,[e.dragBearing+b[f]/e.dragFactor])}).drop(function(){var a=c.data("roundabout"),b=d.getAnimateToMethod(a.dropAnimateTo);d.allowAnimation.apply(c);d[b].apply(c,[a.dropDuration,a.dropEasing,a.dropCallback]);a.dragBearing=a.period*d.getNearestChild.apply(c)}):g.debug&&alert("You do not have the drop plugin loaded."):g.debug&&alert("You do not have the drag plugin loaded."),
c.each(function(){var c=a(this).get(0),b=a(this).data("roundabout"),e="x"===b.dragAxis.toLowerCase()?"pageX":"pageY",f=d.getAnimateToMethod(b.dropAnimateTo);c.addEventListener&&(c.addEventListener("touchstart",function(a){b.touchMoveStartPosition=a.touches[0][e]},!1),c.addEventListener("touchmove",function(c){var f=(c.touches[0][e]-b.touchMoveStartPosition)/b.dragFactor;c.preventDefault();d.stopAnimation.apply(a(this));d.setBearing.apply(a(this),[b.dragBearing+f])},!1),c.addEventListener("touchend",
function(c){c.preventDefault();d.allowAnimation.apply(a(this));f=d.getAnimateToMethod(b.dropAnimateTo);d[f].apply(a(this),[b.dropDuration,b.dropEasing,b.dropCallback]);b.dragBearing=b.period*d.getNearestChild.apply(a(this))},!1))}));d.initChildren.apply(c,[f,i])})},initChildren:function(c,b){var i=a(this),g=i.data("roundabout"),c=c||function(){};i.children(g.childSelector).each(function(c){var e,g,l,p=d.getPlacement.apply(i,[c]);b&&a(this).data("roundabout")&&(e=a(this).data("roundabout").startWidth,
g=a(this).data("roundabout").startHeight,l=a(this).data("roundabout").startFontSize);a(this).addClass("roundabout-moveable-item").css("position","absolute");a(this).data("roundabout",{startWidth:e||a(this).width(),startHeight:g||a(this).height(),startFontSize:l||parseInt(a(this).css("font-size"),10),degrees:p,backDegrees:d.normalize.apply(null,[p-180]),childNumber:c,currentScale:1,parent:i})});d.updateChildren.apply(i);g.autoplay&&(g.autoplayStartTimeout=setTimeout(function(){d.startAutoplay.apply(i)},
g.autoplayInitialDelay));i.trigger("ready");c.apply(i);return i},updateChildren:function(){return this.each(function(){var c=a(this),b=c.data("roundabout"),i=-1,g={bearing:b.bearing,tilt:b.tilt,stage:{width:Math.floor(0.9*a(this).width()),height:Math.floor(0.9*a(this).height())},animating:b.animating,inFocus:b.childInFocus,focusBearingRadian:d.degToRad.apply(null,[b.focusBearing]),shape:a.roundaboutShapes[b.shape]||a.roundaboutShapes[a.roundaboutShapes.def]};g.midStage={width:g.stage.width/2,height:g.stage.height/
2};g.nudge={width:g.midStage.width+0.05*g.stage.width,height:g.midStage.height+0.05*g.stage.height};g.zValues={min:b.minZ,max:b.maxZ,diff:b.maxZ-b.minZ};g.opacity={min:b.minOpacity,max:b.maxOpacity,diff:b.maxOpacity-b.minOpacity};g.scale={min:b.minScale,max:b.maxScale,diff:b.maxScale-b.minScale};c.children(b.childSelector).each(function(h){d.updateChild.apply(c,[a(this),g,h,function(){a(this).trigger("ready")}])&&(!g.animating||b.lastAnimationStep)?(i=h,a(this).addClass("roundabout-in-focus")):a(this).removeClass("roundabout-in-focus")});
i!==g.inFocus&&(b.triggerBlurEvents&&c.children(b.childSelector).eq(g.inFocus).trigger("blur"),b.childInFocus=i,b.triggerFocusEvents&&-1!==i&&c.children(b.childSelector).eq(i).trigger("focus"));c.trigger("childrenUpdated")})},updateChild:function(c,b,i,g){var h,c=a(c),j=c.data("roundabout"),k=[];h=d.degToRad.apply(null,[360-j.degrees+b.bearing]);g=g||function(){};h=d.normalizeRad.apply(null,[h]);h=b.shape(h,b.focusBearingRadian,b.tilt);h.scale=1<h.scale?1:h.scale;h.adjustedScale=(b.scale.min+b.scale.diff*
h.scale).toFixed(4);h.width=(h.adjustedScale*j.startWidth).toFixed(4);h.height=(h.adjustedScale*j.startHeight).toFixed(4);c.css({left:(h.x*b.midStage.width+b.nudge.width-h.width/2).toFixed(0)+"px",top:(h.y*b.midStage.height+b.nudge.height-h.height/2).toFixed(0)+"px",width:h.width+"px",height:h.height+"px",opacity:(b.opacity.min+b.opacity.diff*h.scale).toFixed(2),zIndex:Math.round(b.zValues.min+b.zValues.diff*h.z),fontSize:(h.adjustedScale*j.startFontSize).toFixed(1)+"px"});j.currentScale=h.adjustedScale;
this.data("roundabout").debug&&(k.push('<div style="font-weight: normal; font-size: 10px; padding: 2px; width: '+c.css("width")+'; background-color: #ffc;">'),k.push('<strong style="font-size: 12px; white-space: nowrap;">Child '+i+"</strong><br />"),k.push("<strong>left:</strong> "+c.css("left")+"<br />"),k.push("<strong>top:</strong> "+c.css("top")+"<br />"),k.push("<strong>width:</strong> "+c.css("width")+"<br />"),k.push("<strong>opacity:</strong> "+c.css("opacity")+"<br />"),k.push("<strong>height:</strong> "+
c.css("height")+"<br />"),k.push("<strong>z-index:</strong> "+c.css("z-index")+"<br />"),k.push("<strong>font-size:</strong> "+c.css("font-size")+"<br />"),k.push("<strong>scale:</strong> "+c.data("roundabout").currentScale),k.push("</div>"),c.html(k.join("")));c.trigger("reposition");g.apply(this);return d.isInFocus.apply(this,[j.degrees])},setBearing:function(c,b){b=b||function(){};c=d.normalize.apply(null,[c]);this.each(function(){var b,f=a(this),h=f.data("roundabout"),j=h.bearing;h.bearing=c;
f.trigger("bearingSet");d.updateChildren.apply(f);b=Math.abs(j-c);h.animating&&!(180<b)&&(b=Math.abs(j-c),f.children(h.childSelector).each(function(){var b;d.isChildBackDegreesBetween.apply(a(this),[c,j])&&(b=j>c?"Clockwise":"Counterclockwise",a(this).trigger("move"+b+"ThroughBack"))}))});b.apply(this);return this},adjustBearing:function(c,b){b=b||function(){};if(0===c)return this;this.each(function(){d.setBearing.apply(a(this),[a(this).data("roundabout").bearing+c])});b.apply(this);return this},
setTilt:function(c,b){b=b||function(){};this.each(function(){a(this).data("roundabout").tilt=c;d.updateChildren.apply(a(this))});b.apply(this);return this},adjustTilt:function(c,b){b=b||function(){};this.each(function(){d.setTilt.apply(a(this),[a(this).data("roundabout").tilt+c])});b.apply(this);return this},animateToBearing:function(c,b,i,g,h){var j=(new Date).getTime(),h=h||function(){};a.isFunction(g)?(h=g,g=null):a.isFunction(i)?(h=i,i=null):a.isFunction(b)&&(h=b,b=null);this.each(function(){var k,
l,p=a(this),m=p.data("roundabout"),q=b?b:m.duration,s=i?i:m.easing||"swing";g||(g={timerStart:j,start:m.bearing,totalTime:q});k=j-g.timerStart;m.stopAnimation?(d.allowAnimation.apply(p),m.animating=!1):k<q?(m.animating||p.trigger("animationStart"),m.animating=!0,"string"==typeof a.easing.def?(l=a.easing[s]||a.easing[a.easing.def],k=l(null,k,g.start,c-g.start,g.totalTime)):k=a.easing[s](k/g.totalTime,k,g.start,c-g.start,g.totalTime),0<=d.compareVersions.apply(null,[a().jquery,"1.7.2"])&&(k=g.start+
(c-g.start)*k),k=d.normalize.apply(null,[k]),m.dragBearing=k,d.setBearing.apply(p,[k,function(){setTimeout(function(){d.animateToBearing.apply(p,[c,q,s,g,h])},0)}])):(m.lastAnimationStep=!0,c=d.normalize.apply(null,[c]),d.setBearing.apply(p,[c,function(){p.trigger("animationEnd")}]),m.animating=!1,m.lastAnimationStep=!1,m.dragBearing=c,h.apply(p))});return this},animateToNearbyChild:function(c,b){var i=c[0],g=c[1],h=c[2]||function(){};a.isFunction(g)?(h=g,g=null):a.isFunction(i)&&(h=i,i=null);return this.each(function(){var c,
e,l,p=a(this),m=p.data("roundabout"),q=m.reflect?m.bearing:m.bearing%360,s=p.children(m.childSelector).length;if(!m.animating)if(m.reflect&&"previous"===b||!m.reflect&&"next"===b){q=Math.abs(q)<m.floatComparisonThreshold?360:q;for(l=0;l<s;l+=1)if(c=m.period*l,e=m.period*(l+1),e=l===s-1?360:e,q<=Math.ceil(e)&&q>=Math.floor(c)){2===s&&360===q?d.animateToDelta.apply(p,[-180,i,g,h]):d.animateBearingToFocus.apply(p,[c,i,g,h]);break}}else{q=Math.abs(q)<m.floatComparisonThreshold||360-Math.abs(q)<m.floatComparisonThreshold?
0:q;for(l=s-1;0<=l;l-=1)if(c=m.period*l,e=m.period*(l+1),e=l===s-1?360:e,q>=Math.floor(c)&&q<Math.ceil(e)){2===s&&360===q?d.animateToDelta.apply(p,[180,i,g,h]):d.animateBearingToFocus.apply(p,[e,i,g,h]);break}}})},animateToNearestChild:function(c,b,i){i=i||function(){};a.isFunction(b)?(i=b,b=null):a.isFunction(c)&&(i=c,c=null);return this.each(function(){var g=d.getNearestChild.apply(a(this));d.animateToChild.apply(a(this),[g,c,b,i])})},animateToChild:function(c,b,i,g){g=g||function(){};a.isFunction(i)?
(g=i,i=null):a.isFunction(b)&&(g=b,b=null);return this.each(function(){var h,j=a(this);h=j.data("roundabout");h.childInFocus!==c&&!h.animating&&(h=j.children(h.childSelector).eq(c),d.animateBearingToFocus.apply(j,[h.data("roundabout").degrees,b,i,g]))})},animateToNextChild:function(a,c,b){return d.animateToNearbyChild.apply(this,[arguments,"next"])},animateToPreviousChild:function(a,c,b){return d.animateToNearbyChild.apply(this,[arguments,"previous"])},animateToDelta:function(c,b,i,g){g=g||function(){};
a.isFunction(i)?(g=i,i=null):a.isFunction(b)&&(g=b,b=null);return this.each(function(){var h=a(this).data("roundabout").bearing+c;d.animateToBearing.apply(a(this),[h,b,i,g])})},animateBearingToFocus:function(c,b,i,g){g=g||function(){};a.isFunction(i)?(g=i,i=null):a.isFunction(b)&&(g=b,b=null);return this.each(function(){var h=a(this).data("roundabout").bearing-c,h=Math.abs(360-h)<Math.abs(h)?360-h:-h,h=180<h?-(360-h):h;0!==h&&d.animateToDelta.apply(a(this),[h,b,i,g])})},stopAnimation:function(){return this.each(function(){a(this).data("roundabout").stopAnimation=
!0})},allowAnimation:function(){return this.each(function(){a(this).data("roundabout").stopAnimation=!1})},startAutoplay:function(c){return this.each(function(){var b=a(this),i=b.data("roundabout");c=c||i.autoplayCallback||function(){};clearInterval(i.autoplayInterval);i.autoplayInterval=setInterval(function(){d.animateToNextChild.apply(b,[c])},i.autoplayDuration);i.autoplayIsRunning=!0;b.trigger("autoplayStart")})},stopAutoplay:function(c){return this.each(function(){clearInterval(a(this).data("roundabout").autoplayInterval);
a(this).data("roundabout").autoplayInterval=null;a(this).data("roundabout").autoplayIsRunning=!1;c||a(this).unbind(".autoplay");a(this).trigger("autoplayStop")})},toggleAutoplay:function(c){return this.each(function(){var b=a(this).data("roundabout");c=c||b.autoplayCallback||function(){};d.isAutoplaying.apply(a(this))?d.stopAutoplay.apply(a(this),[c]):d.startAutoplay.apply(a(this),[c])})},isAutoplaying:function(){return this.data("roundabout").autoplayIsRunning},changeAutoplayDuration:function(c){return this.each(function(){var b=
a(this);b.data("roundabout").autoplayDuration=c;d.isAutoplaying.apply(b)&&(d.stopAutoplay.apply(b),setTimeout(function(){d.startAutoplay.apply(b)},10))})},normalize:function(a){a%=360;return 0>a?360+a:a},normalizeRad:function(a){for(;0>a;)a+=2*Math.PI;for(;a>2*Math.PI;)a-=2*Math.PI;return a},isChildBackDegreesBetween:function(c,b){var d=a(this).data("roundabout").backDegrees;return c>b?d>=b&&d<c:d<b&&d>=c},getAnimateToMethod:function(a){a=a.toLowerCase();return"next"===a?"animateToNextChild":"previous"===
a?"animateToPreviousChild":"animateToNearestChild"},relayoutChildren:function(){return this.each(function(){var c=a(this),b=a.extend({},c.data("roundabout"));b.startingChild=c.data("roundabout").childInFocus;d.init.apply(c,[b,null,!0])})},getNearestChild:function(){var c=a(this),b=c.data("roundabout"),c=c.children(b.childSelector).length;return b.reflect?Math.round(b.bearing/b.period)%c:(c-Math.round(b.bearing/b.period)%c)%c},degToRad:function(a){return d.normalize.apply(null,[a])*Math.PI/180},getPlacement:function(a){var c=
this.data("roundabout");return c.reflect?c.period*a:360-c.period*a},isInFocus:function(a){var c=this.data("roundabout"),b=d.normalize.apply(null,[c.bearing]),a=d.normalize.apply(null,[a]),a=Math.abs(b-a);return a<=c.floatComparisonThreshold||a>=360-c.floatComparisonThreshold},getChildInFocus:function(){var c=a(this).data("roundabout");return-1<c.childInFocus?c.childInFocus:!1},compareVersions:function(a,c){var b,d=a.split(/\./i),h=c.split(/\./i),j=d.length>h.length?d.length:h.length;for(b=0;b<=j;b++){if(d[b]&&
!h[b]&&0!==parseInt(d[b],10))return 1;if(h[b]&&!d[b]&&0!==parseInt(h[b],10))return-1;if(d[b]!==h[b]&&d[b]&&h[b])return parseInt(d[b],10)>parseInt(h[b],10)?1:-1}return 0}};a.fn.roundabout=function(c){if(d[c])return d[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof c||a.isFunction(c)||!c)return d.init.apply(this,arguments);a.error("Method "+c+" does not exist for jQuery.roundabout.")}})(jQuery);jQuery.fn.sortElements=function(){var a=[].sort;return function(c,b){var b=b||function(){return this},d=this.map(function(){var a=b.call(this),c=a.parentNode,d=c.insertBefore(document.createTextNode(""),a.nextSibling);return function(){if(c===this)throw Error("You can't sort elements if any one is a descendant of another.");c.insertBefore(this,d);c.removeChild(d)}});return a.call(this,c).each(function(a){d[a].call(b.call(this))})}}();(function(a){a.fn.imgPreview=function(c){var b=a.extend({imgCSS:{},distanceFromCursor:{top:10,left:10},preloadImages:!0,onShow:function(){},onHide:function(){},onLoad:function(){},containerID:"imgPreviewContainer",containerLoadingClass:"loading",thumbPrefix:"",srcAttr:"href"},c),d,e;a("#"+b.containerID).length?(a("#"+b.containerID).html(""),d=a("#"+b.containerID).append("<img/>").hide()):d=a("<div/>").attr("id",b.containerID).append("<img/>").hide().css("position","absolute").css("z-index","10005").appendTo("body");
e=a("img",d).css(b.imgCSS);b.preloadImages&&this.each(function(){(new Image).src=a(this).attr(b.srcAttr).replace(/(\/?)([^\/]+)$/,"$1"+b.thumbPrefix+"$2")});this.mousemove(function(a){d.css({top:a.pageY+b.distanceFromCursor.top+"px",left:a.pageX+b.distanceFromCursor.left+"px"})}).hover(function(){var c=this;d.addClass(b.containerLoadingClass).show();e.load(function(){d.removeClass(b.containerLoadingClass);b.onLoad.call(e[0],c)}).attr("src",a(c).attr(b.srcAttr).replace(/\/([^\/]+)$/,"/"+b.thumbPrefix+
"$1"));b.onShow.call(d[0],c)},function(){d.hide();e.unbind("load").attr("src","");b.onHide.call(d[0],this)});return this}})(jQuery);jQuery.cookie=function(a,c,b){if("undefined"!=typeof c){b=b||{};null===c&&(c="",b.expires=-1);var d="";if(b.expires&&("number"==typeof b.expires||b.expires.toUTCString))"number"==typeof b.expires?(d=new Date,d.setTime(d.getTime()+864E5*b.expires)):d=b.expires,d="; expires="+d.toUTCString();var e=b.path?"; path="+b.path:"",f=b.domain?"; domain="+b.domain:"",b=b.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(c),d,e,f,b].join("")}else{c=null;if(document.cookie&&""!=document.cookie){b=
document.cookie.split(";");for(d=0;d<b.length;d++)if(e=jQuery.trim(b[d]),e.substring(0,a.length+1)==a+"="){c=decodeURIComponent(e.substring(a.length+1));break}}return c}};(function(a){a.fn.equalizeElementHeights=function(){var c=this.map(function(c,d){return a(d).height()}).get();return this.height(Math.max.apply(this,c))}})(jQuery);(function(a){a.fn.jLabel=function(c){function b(c){this.equals=function(a){return a.attr("id")==this.input.attr("id")};this.input=c;var b=a("label[for="+c.attr("id")+"]");0==b.size()&&(b=a("<label>").attr("for",c.attr("id")).text(c.attr("title")));c.before(b);b.css({"font-family":c.css("font-family"),"font-size":c.css("font-size"),"font-style":c.css("font-style"),"font-variant":c.css("font-variant"),"font-weight":c.css("font-weight"),"letter-spacing":c.css("letter-spacing"),"line-height":c.css("line-height"),
"text-decoration":c.css("text-decoration"),"text-transform":c.css("text-transform"),color:c.css("color"),cursor:c.css("cursor"),display:"inline-block"});b.mousedown(function(){return!1}).css({position:"relative","z-index":"100","margin-right":-b.width(),left:f.xShift+parseInt(c.css("padding-left"))+"px",top:f.yShift+"px"});this.label=b;""!=this.input.val()&&this.label.hide()}function d(c){var b;a.each(e,function(){if(this.equals(c))return b=this,!1});return b}var e=[],f=a.extend({},a.fn.jLabel.defaults,
c);return this.each(function(){var c=a(this);e.push(new b(c));c.focus(function(){var c=a(this);""==c.val()&&d(c).label.stop().fadeTo(f.speed,f.opacity)}).blur(function(){var c=a(this);""==c.val()&&d(c).label.stop().fadeTo(f.speed,1)}).keyup(function(){var c=a(this),b=d(c).label;""==c.val()?b.stop().fadeTo(f.speed,f.opacity):b.is(":visible")&&b.stop().fadeTo(f.speed,0,function(){b.hide()})})})};a.fn.jLabel.defaults={speed:200,opacity:0.4,xShift:2,yShift:0}})(jQuery);jQuery&&function(a){a.extend(a.fn,{selectBox:function(c,b){var d,e="",f=navigator.platform.match(/mac/i),i=function(c,b){var d,e=function(c,b){c.children("OPTION, OPTGROUP").each(function(){if(a(this).is("OPTION"))if(0<a(this).length){var c=a(this),d=b,f=a("<li />"),g=a("<a />");f.addClass(c.attr("class"));f.data(c.data());g.attr("rel",c.val()).text(c.text());f.append(g);c.attr("disabled")&&f.addClass("selectBox-disabled");c.attr("selected")&&f.addClass("selectBox-selected");d.append(f)}else b.append("<li>\u00a0</li>");
else c=a('<li class="selectBox-optgroup" />'),c.text(a(this).attr("label")),b.append(c),b=e(a(this),b)});return b};switch(b){case "inline":return d=a('<ul class="selectBox-options" />'),d=e(c,d),d.find("A").bind("mouseover.selectBox",function(){m(c,a(this).parent())}).bind("mouseout.selectBox",function(){q(c,a(this).parent())}).bind("mousedown.selectBox",function(a){a.preventDefault();c.selectBox("control").hasClass("selectBox-active")||c.selectBox("control").focus()}).bind("mouseup.selectBox",function(b){l();
p(c,a(this).parent(),b)}),r(d),d;case "dropdown":d=a('<ul class="selectBox-dropdown-menu selectBox-options" />');d=e(c,d);d.data("selectBox-select",c).css("display","none").appendTo("BODY").find("A").bind("mousedown.selectBox",function(a){a.preventDefault();a.screenX===d.data("selectBox-down-at-x")&&a.screenY===d.data("selectBox-down-at-y")&&(d.removeData("selectBox-down-at-x").removeData("selectBox-down-at-y"),l())}).bind("mouseup.selectBox",function(b){b.screenX===d.data("selectBox-down-at-x")&&
b.screenY===d.data("selectBox-down-at-y")||(d.removeData("selectBox-down-at-x").removeData("selectBox-down-at-y"),p(c,a(this).parent()),l())}).bind("mouseover.selectBox",function(){m(c,a(this).parent())}).bind("mouseout.selectBox",function(){q(c,a(this).parent())});var f=c.attr("class")||"";if(""!==f){var f=f.split(" "),g;for(g in f)d.addClass(f[g]+"-selectBox-dropdown-menu")}r(d);return d}},g=function(c){return("selectBox-label "+(a(c).find("OPTION:selected").attr("class")||"")).replace(/\s+$/,"")},
h=function(c){return a(c).find("OPTION:selected").text()||"\u00a0"},j=function(c){var c=a(c),b=c.data("selectBox-control");b&&b.find(".selectBox-label").attr("class",g(c)).text(h(c))},k=function(c){var c=a(c),b=c.data("selectBox-control"),d=c.data("selectBox-settings"),e=b.data("selectBox-options");if(b.hasClass("selectBox-disabled"))return!1;l();var f=isNaN(b.css("borderBottomWidth"))?0:parseInt(b.css("borderBottomWidth"));e.width(b.innerWidth()).css({top:b.offset().top+b.outerHeight()-f,left:b.offset().left});
if(c.triggerHandler("beforeopen"))return!1;f=function(){c.triggerHandler("open",{_selectBox:!0})};switch(d.menuTransition){case "fade":e.fadeIn(d.menuSpeed,f);break;case "slide":e.slideDown(d.menuSpeed,f);break;default:e.show(d.menuSpeed,f)}d.menuSpeed||f();d=e.find(".selectBox-selected:first");s(c,d,!0);m(c,d);b.addClass("selectBox-menuShowing");a(document).bind("mousedown.selectBox",function(c){a(c.target).parents().andSelf().hasClass("selectBox-options")||l()})},l=function(){0!==a(".selectBox-dropdown-menu:visible").length&&
(a(document).unbind("mousedown.selectBox"),a(".selectBox-dropdown-menu").each(function(){var c=a(this),b=c.data("selectBox-select"),d=b.data("selectBox-control"),e=b.data("selectBox-settings");if(b.triggerHandler("beforeclose"))return!1;var f=function(){b.triggerHandler("close",{_selectBox:!0})};if(e){switch(e.menuTransition){case "fade":c.fadeOut(e.menuSpeed,f);break;case "slide":c.slideUp(e.menuSpeed,f);break;default:c.hide(e.menuSpeed,f)}e.menuSpeed||f();d.removeClass("selectBox-menuShowing")}else a(this).hide(),
a(this).triggerHandler("close",{_selectBox:!0}),a(this).removeClass("selectBox-menuShowing")}))},p=function(c,b,d){var c=a(c),b=a(b),e=c.data("selectBox-control");c.data("selectBox-settings");if(e.hasClass("selectBox-disabled")||0===b.length||b.hasClass("selectBox-disabled"))return!1;c.attr("multiple")?d.shiftKey&&e.data("selectBox-last-selected")?(b.toggleClass("selectBox-selected"),d=b.index()>e.data("selectBox-last-selected").index()?b.siblings().slice(e.data("selectBox-last-selected").index(),
b.index()):b.siblings().slice(b.index(),e.data("selectBox-last-selected").index()),d=d.not(".selectBox-optgroup, .selectBox-disabled"),b.hasClass("selectBox-selected")?d.addClass("selectBox-selected"):d.removeClass("selectBox-selected")):f&&d.metaKey||!f&&d.ctrlKey?b.toggleClass("selectBox-selected"):(b.siblings().removeClass("selectBox-selected"),b.addClass("selectBox-selected")):(b.siblings().removeClass("selectBox-selected"),b.addClass("selectBox-selected"));e.hasClass("selectBox-dropdown")&&e.find(".selectBox-label").text(b.text());
var g=0,h=[];c.attr("multiple")?e.find(".selectBox-selected A").each(function(){h[g++]=a(this).attr("rel")}):h=b.find("A").attr("rel");e.data("selectBox-last-selected",b);c.val()!==h&&(c.val(h),j(c),c.trigger("change"));return!0},m=function(c,b){c=a(c);b=a(b);c.data("selectBox-control").data("selectBox-options").find(".selectBox-hover").removeClass("selectBox-hover");b.addClass("selectBox-hover")},q=function(c,b){c=a(c);a(b);c.data("selectBox-control").data("selectBox-options").find(".selectBox-hover").removeClass("selectBox-hover")},
s=function(c,b,d){if(b&&0!==b.length){var c=a(c),c=c.data("selectBox-control"),e=c.data("selectBox-options"),c=c.hasClass("selectBox-dropdown")?e:e.parent(),e=parseInt(b.offset().top-c.position().top),f=parseInt(e+b.outerHeight());d?c.scrollTop(b.offset().top-c.offset().top+c.scrollTop()-c.height()/2):(0>e&&c.scrollTop(b.offset().top-c.offset().top+c.scrollTop()),f>c.height()&&c.scrollTop(b.offset().top+b.outerHeight()-c.offset().top+c.scrollTop()-c.height()))}},t=function(c,b){var c=a(c),d=c.data("selectBox-control"),
f=d.data("selectBox-options"),g=c.data("selectBox-settings"),h=0,i=0;if(!d.hasClass("selectBox-disabled"))switch(b.keyCode){case 8:b.preventDefault();e="";break;case 9:case 27:l();q(c);break;case 13:d.hasClass("selectBox-menuShowing")?(p(c,f.find("LI.selectBox-hover:first"),b),d.hasClass("selectBox-dropdown")&&l()):k(c);break;case 38:case 37:b.preventDefault();if(d.hasClass("selectBox-menuShowing")){d=f.find(".selectBox-hover").prev("LI");h=f.find("LI:not(.selectBox-optgroup)").length;for(i=0;(0===
d.length||d.hasClass("selectBox-disabled")||d.hasClass("selectBox-optgroup"))&&!(d=d.prev("LI"),0===d.length&&(d=g.loopOptions?f.find("LI:last"):f.find("LI:first")),++i>=h););m(c,d);p(c,d,b);s(c,d)}else k(c);break;case 40:case 39:if(b.preventDefault(),d.hasClass("selectBox-menuShowing")){d=f.find(".selectBox-hover").next("LI");h=f.find("LI:not(.selectBox-optgroup)").length;for(i=0;(0===d.length||d.hasClass("selectBox-disabled")||d.hasClass("selectBox-optgroup"))&&!(d=d.next("LI"),0===d.length&&(d=
g.loopOptions?f.find("LI:first"):f.find("LI:last")),++i>=h););m(c,d);p(c,d,b);s(c,d)}else k(c)}},n=function(c,b){var c=a(c),f=c.data("selectBox-control"),g=f.data("selectBox-options");if(!f.hasClass("selectBox-disabled"))switch(b.keyCode){case 9:case 27:case 13:case 38:case 37:case 40:case 39:break;default:f.hasClass("selectBox-menuShowing")||k(c),b.preventDefault(),clearTimeout(d),e+=String.fromCharCode(b.charCode||b.keyCode),g.find("A").each(function(){if(a(this).text().substr(0,e.length).toLowerCase()===
e.toLowerCase())return m(c,a(this).parent()),s(c,a(this).parent()),!1}),d=setTimeout(function(){e=""},1E3)}},r=function(c){a(c).css("MozUserSelect","none").bind("selectstart",function(a){a.preventDefault()})};switch(c){case "control":return a(this).data("selectBox-control");case "settings":if(!b)return a(this).data("selectBox-settings");a(this).each(function(){a(this).data("selectBox-settings",a.extend(!0,a(this).data("selectBox-settings"),b))});break;case "options":if(void 0===b)return a(this).data("selectBox-control").data("selectBox-options");
a(this).each(function(){var c,d=b;c=a(this);var e=c.data("selectBox-control");c.data("selectBox-settings");switch(typeof b){case "string":c.html(b);break;case "object":c.html("");for(var f in b)if(null!==b[f]){if("object"===typeof b[f]){var d=a('<optgroup label="'+f+'" />'),g;for(g in b[f])d.append('<option value="'+g+'">'+b[f][g]+"</option>")}else d=a('<option value="'+f+'">'+b[f]+"</option>");c.append(d)}}if(e)switch(e.data("selectBox-options").remove(),f=e.hasClass("selectBox-dropdown")?"dropdown":
"inline",d=i(c,f),e.data("selectBox-options",d),f){case "inline":e.append(d);break;case "dropdown":j(c),a("BODY").append(d)}});break;case "value":if(void 0===b)return a(this).val();a(this).each(function(){var c,d=b;c=a(this);c.val(d);d=c.val();null===d&&(d=c.children().first().val(),c.val(d));var e=c.data("selectBox-control");if(e){var f=c.data("selectBox-settings"),e=e.data("selectBox-options");j(c);e.find(".selectBox-selected").removeClass("selectBox-selected");e.find("A").each(function(){if("object"===
typeof d)for(var c=0;c<d.length;c++)a(this).attr("rel")==d[c]&&a(this).parent().addClass("selectBox-selected");else a(this).attr("rel")==d&&a(this).parent().addClass("selectBox-selected")});f.change&&f.change.call(c)}});break;case "refresh":a(this).each(function(){var c;c=a(this);c.selectBox("options",c.html())});break;case "enable":a(this).each(function(){var c;c=a(this);c.attr("disabled",!1);(c=c.data("selectBox-control"))&&c.removeClass("selectBox-disabled")});break;case "disable":a(this).each(function(){var c;
c=a(this);c.attr("disabled",!0);(c=c.data("selectBox-control"))&&c.addClass("selectBox-disabled")});break;case "destroy":a(this).each(function(){var c;c=a(this);var b=c.data("selectBox-control");b&&(b.data("selectBox-options").remove(),b.remove(),c.removeClass("selectBox").removeData("selectBox-control").data("selectBox-control",null).removeData("selectBox-settings").data("selectBox-settings",null).show())});break;default:a(this).each(function(){var b=this,d;if(!navigator.userAgent.match(/iPad|iPhone|Android|IEMobile|BlackBerry/i)&&
"select"===b.tagName.toLowerCase()&&(b=a(b),!b.data("selectBox-control"))){var e=a('<a class="selectBox" />'),f=b.attr("multiple")||1<parseInt(b.attr("size")),j=c||{};e.width(b.outerWidth()).addClass(b.attr("class")).attr("title",b.attr("title")||"").attr("tabindex",parseInt(b.attr("tabindex"))).css("display","inline-block").bind("focus.selectBox",function(){this!==document.activeElement&&document.body!==document.activeElement&&a(document.activeElement).blur();e.hasClass("selectBox-active")||(e.addClass("selectBox-active"),
b.trigger("focus"))}).bind("blur.selectBox",function(){e.hasClass("selectBox-active")&&(e.removeClass("selectBox-active"),b.trigger("blur"))});a(window).data("selectBox-bindings")||a(window).data("selectBox-bindings",!0).bind("scroll.selectBox",l).bind("resize.selectBox",l);b.attr("disabled")&&e.addClass("selectBox-disabled");b.bind("click.selectBox",function(a){e.focus();a.preventDefault()});if(f){if(d=i(b,"inline"),e.append(d).data("selectBox-options",d).addClass("selectBox-inline selectBox-menuShowing").bind("keydown.selectBox",
function(a){t(b,a)}).bind("keypress.selectBox",function(a){n(b,a)}).bind("mousedown.selectBox",function(c){a(c.target).is("A.selectBox-inline")&&c.preventDefault();e.hasClass("selectBox-focus")||e.focus()}).insertAfter(b),!b[0].style.height){var f=b.attr("size")?parseInt(b.attr("size")):5,m=e.clone().removeAttr("id").css({position:"absolute",top:"-9999em"}).show().appendTo("body");m.find(".selectBox-options").html("<li><a>\u00a0</a></li>");var p=parseInt(m.find(".selectBox-options A:first").html("&nbsp;").outerHeight());
m.remove();e.height(p*f)}}else f=a('<span class="selectBox-label" />'),m=a('<span class="selectBox-arrow" />'),f.attr("class",g(b)).text(h(b)),d=i(b,"dropdown"),d.appendTo("BODY"),e.data("selectBox-options",d).addClass("selectBox-dropdown").append(f).append(m).bind("mousedown.selectBox",function(a){e.hasClass("selectBox-menuShowing")?l():(a.stopPropagation(),d.data("selectBox-down-at-x",a.screenX).data("selectBox-down-at-y",a.screenY),k(b))}).bind("keydown.selectBox",function(a){t(b,a)}).bind("keypress.selectBox",
function(a){n(b,a)}).bind("open.selectBox",function(a,c){c&&!0===c._selectBox||k(b)}).bind("close.selectBox",function(a,c){c&&!0===c._selectBox||l()}).insertAfter(b),m=e.width()-m.outerWidth()-parseInt(f.css("paddingLeft"))-parseInt(f.css("paddingLeft")),f.width(m);r(e);b.addClass("selectBox").data("selectBox-control",e).data("selectBox-settings",j).hide()}})}return a(this)}})}(jQuery);(function(a){var c={animationSpeed:100,closable:!1,resizable:!1,resizeHandles:"e,s,se",loadLastTab:!1,easing:"swing"};a.fn.scrollabletab=function(b){return this.each(function(){var d=a.extend({},c,b),e=a(this),f=e.find(".ui-tabs-nav"),i;e.css({padding:2,position:"relative"});e.wrap('<div id="stTabswrapper" class="stTabsMainWrapper" style="position:relative"/>').find(".ui-tabs-nav").css("overflow","hidden").wrapInner('<div class="stTabsInnerWrapper" style="width:30000px"><span class="stWidthChecker"/></div>');
var g=e.find(".stWidthChecker");e.find(".stTabsInnerWrapper");var h=e.parents("#stTabswrapper").width(e.outerWidth(!0));a.browser.safari&&h.width(e.width()+6);d.resizable&&(a.fn.resizable?h.resizable({minWidth:h.width(),maxWidth:2*h.width(),minHeight:h.height(),maxHeight:2*h.height(),handles:d.resizeHandles,alsoResize:e,resize:function(){e.trigger("resized")}}):alert('Error:\nCannot be resizable because "jQuery.resizable" plugin is not available.'));var j=parseInt(parseInt(f.innerHeight(!0)/2)-8),
k={cursor:"pointer","z-index":100,position:"absolute",top:3,height:f.outerHeight()-(a.browser.safari?2:1)};h.prepend(i=a("<div/>").disableSelection().css({position:"relative","z-index":100,display:"none"}).append(a("<span/>").disableSelection().attr("title","").css(k).addClass("ui-state-active ui-corner-tl ui-corner-bl stPrev stNav").css("left",3).append(a("<span/>").disableSelection().addClass("ui-icon ui-icon-carat-1-w").html("").css("margin-top",j)).click(function(){var c;if(!a(this).hasClass("ui-state-disabled"))return c=
f.find("li.ui-tabs-selected").prevAll().length-1,f.find("li").eq(c).find("a").trigger("click"),!1}),a("<span/>").disableSelection().attr("title","").css(k).addClass("ui-state-active ui-corner-tr ui-corner-br stNext stNav").css({right:3}).append(a("<span/>").addClass("ui-icon ui-icon-carat-1-e").html("").css("margin-top",j)).click(function(){var a;a=f.find("li.ui-tabs-selected").prevAll().length+1;f.find("li").eq(a).find("a").trigger("click");return!1})));e.bind("tabsremove",function(){e.trigger("scrollToTab").trigger("navHandler").trigger("navEnabler")}).bind("addCloseButton",
function(){d.closable&&a(this).find(".ui-tabs-nav li").each(function(){if(!(0<a(this).find(".ui-tabs-close").length)){var c=parseInt(parseInt(f.find("li:first").innerHeight()/2,10)-8);a(this).disableSelection().append(a('<span style="float:left;cursor:pointer;margin:'+c+'px 2px 0 -11px" class="ui-tabs-close ui-icon ui-icon-close" title="Close this tab"></span>').click(function(){e.tabs("remove",a(this).parents("li").prevAll().length);1==e.tabs("length")?f.find(".ui-icon-close").hide():f.find(".ui-icon-close").show();
if(a.isFunction(d.onTabClose))d.onTabClose();return!1}));f.find(".ui-icon-close").show()}})}).bind("bindTabClick",function(){f.find("a").click(function(){var c=a(this).parents("li"),b=i.find(".stPrev").outerWidth(!0);0>c.position().left-b?e.trigger("scrollToTab",[c,"tabClicked","left"]):c.outerWidth()+c.position().left>e.width()-b&&e.trigger("scrollToTab",[c,"tabClicked","right"]);e.trigger("navEnabler");return!1})}).bind("scrollToTab",function(c,b,g,h){var b="undefined"!=typeof b?a(b):f.find("li.ui-tabs-selected"),
j=i.is(":visible")?i.find(".stPrev").outerWidth(!0):0,c=-(e.width()-(b.outerWidth(!0)+j+parseInt(f.find("li:last").css("margin-right"),10)));f.scrollTo(b,d.animationSpeed,{axis:"x",margin:!0,offset:{left:"tabClicked"==g&&"left"==h?-j:c},easing:d.easing||""})}).bind("navEnabler",function(){setTimeout(function(){var a=f.find(".ui-tabs-selected").is(":last-child"),c=f.find(".ui-tabs-selected").is(":first-child"),b=h.find(".stNext"),d=h.find(".stPrev");a?(d.removeClass("ui-state-disabled"),b.addClass("ui-state-disabled")):
c?(b.removeClass("ui-state-disabled"),d.addClass("ui-state-disabled")):(b.removeClass("ui-state-disabled"),d.removeClass("ui-state-disabled"))},d.animationSpeed)}).bind("navHandler",function(){g.width()>f.width()?(i.show(),f.find("li:first").css("margin-left",i.find(".stPrev").outerWidth(!0))):(i.hide(),f.find("li:first").css("margin-left",0))}).bind("tabsselect",function(){}).bind("resized",function(){e.trigger("navHandler");e.trigger("scrollToTab",f.find("li.ui-tabs-selected"))}).trigger("addCloseButton").trigger("bindTabClick").trigger("navHandler").trigger("navEnabler");
d.loadLastTab&&setTimeout(function(){f.find("li:last a").trigger("click")},d.animationSpeed)})}})(jQuery);
(function(a){function c(a){return"object"==typeof a?a:{top:a,left:a}}var b=a.scrollTo=function(c,b,f){a(window).scrollTo(c,b,f)};b.defaults={axis:"xy",duration:1.3<=parseFloat(a.fn.jquery)?0:1};b.window=function(){return a(window)._scrollable()};a.fn._scrollable=function(){return this.map(function(){if(this.nodeName&&-1==a.inArray(this.nodeName.toLowerCase(),["iframe","#document","html","body"]))return this;var c=(this.contentWindow||this).document||this.ownerDocument||this;return a.browser.safari||
"BackCompat"==c.compatMode?c.body:c.documentElement})};a.fn.scrollTo=function(d,e,f){"object"==typeof e&&(f=e,e=0);"function"==typeof f&&(f={onAfter:f});"max"==d&&(d=9E9);f=a.extend({},b.defaults,f);e=e||f.speed||f.duration;f.queue=f.queue&&1<f.axis.length;f.queue&&(e/=2);f.offset=c(f.offset);f.over=c(f.over);return this._scrollable().each(function(){function i(a){h.animate(l,e,f.easing,a&&function(){a.call(this,d,f)})}var g=this,h=a(g),j=d,k,l={},p=h.is("html,body");switch(typeof j){case "number":case "string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(j)){j=
c(j);break}j=a(j,this);case "object":if(j.is||j.style)k=(j=a(j)).offset()}a.each(f.axis.split(""),function(a,c){var d="x"==c?"Left":"Top",e=d.toLowerCase(),n="scroll"+d,r=g[n],u=b.max(g,c);k?(l[n]=k[e]+(p?0:r-h.offset()[e]),f.margin&&(l[n]-=parseInt(j.css("margin"+d))||0,l[n]-=parseInt(j.css("border"+d+"Width"))||0),l[n]+=f.offset[e]||0,f.over[e]&&(l[n]+=j["x"==c?"width":"height"]()*f.over[e])):(d=j[e],l[n]=d.slice&&"%"==d.slice(-1)?parseFloat(d)/100*u:d);/^\d+$/.test(l[n])&&(l[n]=0>=l[n]?0:Math.min(l[n],
u));!a&&f.queue&&(r!=l[n]&&i(f.onAfterFirst),delete l[n])});i(f.onAfter)}).end()};b.max=function(c,b){var f="x"==b?"Width":"Height",i="scroll"+f;if(!a(c).is("html,body"))return c[i]-a(c)[f.toLowerCase()]();var f="client"+f,g=c.ownerDocument.documentElement,h=c.ownerDocument.body;return Math.max(g[i],h[i])-Math.min(g[f],h[f])}})(jQuery);var JSON;JSON||(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function c(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var c=g[a];return"string"===typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function b(a,d){var e,g,m,q,s=f,t,n=d[a];n&&("object"===typeof n&&"function"===typeof n.toJSON)&&(n=n.toJSON(a));"function"===typeof h&&(n=h.call(d,a,n));switch(typeof n){case "string":return c(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);case "object":if(!n)return"null";
f+=i;t=[];if("[object Array]"===Object.prototype.toString.apply(n)){q=n.length;for(e=0;e<q;e+=1)t[e]=b(e,n)||"null";m=0===t.length?"[]":f?"[\n"+f+t.join(",\n"+f)+"\n"+s+"]":"["+t.join(",")+"]";f=s;return m}if(h&&"object"===typeof h){q=h.length;for(e=0;e<q;e+=1)"string"===typeof h[e]&&(g=h[e],(m=b(g,n))&&t.push(c(g)+(f?": ":":")+m))}else for(g in n)Object.prototype.hasOwnProperty.call(n,g)&&(m=b(g,n))&&t.push(c(g)+(f?": ":":")+m);m=0===t.length?"{}":f?"{\n"+f+t.join(",\n"+f)+"\n"+s+"}":"{"+t.join(",")+
"}";f=s;return m}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,i,g={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,c,d){var e;i=f="";if("number"===typeof d)for(e=0;e<d;e+=1)i+=" ";else"string"===typeof d&&(i=d);if((h=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return b("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,c){function b(a,d){var e,f,g=a[d];if(g&&"object"===typeof g)for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(f=b(g,e),void 0!==f?g[e]=f:delete g[e]);return c.call(a,d,g)}var e,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof c?b({"":e},""):e;throw new SyntaxError("JSON.parse");})})();function confirmAction(a,c){return confirm(c)?(a&&(document.location.href=a),!0):!1}function openHelp(a){window.open(a,"Help","width=700,height=600,screenX=100,screenY=100,toolbar=0,scrollbars=1")}function openComments(a){window.open(a,"Comments","width=700,height=600,screenX=100,screenY=100,toolbar=0,resizable=1,scrollbars=1")}function openWindow(a){window.open(a,"Window","width=600,height=550,screenX=100,screenY=100,toolbar=0,resizable=1,scrollbars=1")}
function openRTWindow(a){window.open(a,"RT","width=700,height=500,screenX=100,screenY=100,toolbar=0,resizable=1,scrollbars=1")}function openRTWindowWithToolbar(a){window.open(a,"RT","width=700,height=500,screenX=100,screenY=100,toolbar=1,resizable=1,scrollbars=1")}function getBrowserObject(a,c){var b=0,d;document.getElementById?d=document.getElementById(a):document.all?d=document.all[a]:document.layers&&(d=document.layers[a],b=1);c&&!b&&(d=d.style);return d}
function loadUrl(a){document.location.href=a}function createCookie(a,c,b){if(b){var d=new Date;d.setTime(d.getTime()+864E5*b);b="; expires="+d.toGMTString()}else b="";document.cookie=a+"="+c+b+"; path=/"}function readCookie(a){for(var a=a+"=",c=document.cookie.split(";"),b=0;b<c.length;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null}
function makeAsyncRequest(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}function sendAsyncRequest(a,c,b,d){a.open(d,c,!0);a.setRequestHeader("Content-Type","text/html; Charset=utf-8");a.send(b)}function changeFormAction(a,c){document.getElementById(a).action=c;document.getElementById(a).submit()}
function urlEncode(a){return encodeURIComponent(a).replace(/\%20/g,"+").replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/\~/g,"%7E")}function escapeHTML(a){return $("<div/>").text(a).html()}function unescapeHTML(a){return $("<div/>").html(a).text()};(function(a){a.pkp=a.pkp||{};a.pkp.classes=a.pkp.classes||{};a.pkp.controllers=a.pkp.controllers||{};a.pkp.plugins=a.pkp.plugins||{};a.pkp.plugins.blocks=a.pkp.plugins.blocks||{};a.pkp.plugins.generic=a.pkp.plugins.generic||{};a.pkp.classes.Helper=function(){throw Error("Trying to instantiate the Helper singleton!");};a.pkp.classes.Helper.CHARS_="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");a.pkp.classes.Helper.uuid=function(){var c=a.pkp.classes.Helper.CHARS_,b=Array(36),
d=0,e,f;for(f=0;36>f;f++)8==f||13==f||18==f||23==f?b[f]="-":14==f?b[f]="4":(2>=d&&(d=33554432+16777216*Math.random()|0),e=d&15,d>>=4,b[f]=c[19==f?e&3|8:e]);return b.join("")};a.pkp.classes.Helper.inherits=function(a,b){var d=function(){};d.prototype=b.prototype;a.parent_=b.prototype;a.prototype=new d;a.prototype.constructor=a;b.prototype.constructor==Object.prototype.constructor&&(b.prototype.constructor=b)};a.pkp.classes.Helper.objectFactory=function(c,b){var d,e;d=a.pkp.classes.Helper.resolveObjectName(c);
e=a.pkp.classes.Helper.getObjectProxyInstance();a.extend(!0,e,a.pkp.classes.ObjectProxy);a.pkp.classes.Helper.inherits(e,d);a.extend(!0,e.prototype,a.pkp.classes.ObjectProxy.prototype);return new e(c,b)};a.pkp.classes.Helper.resolveObjectName=function(c){var b,d,e;b=c.split(".");if("$"!=b.shift())throw Error(['Namespace "',b[0],'" for object "',c,'" is currently not supported!'].join(""));e=b[b.length-1];if(e.charAt(0).toUpperCase()!==e.charAt(0))throw Error(['The name "',c,'" does not point to aconstructor which must always be upper case!'].join(""));
e=a;for(d in b)if(e=e[b[d]],void 0===e)throw Error(['Constructor for object "',c,'" not found!'].join(""));if(!a.isFunction(e))throw Error(['The name "',c,'" does not point to a,constructor which must always be a function!'].join());return e};a.pkp.classes.Helper.getObjectProxyInstance=function(){var a=function(a,c){this.objectName_=a;this.parent.apply(this,c)};a.objectName_="";a.prototype.parent=function(){};return a};a.pkp.classes.Helper.injectMixin=function(c,b){var d=a.pkp.classes.Helper.objectFactory(b,
[]);a.extend(!0,c,d)};a.pkp.classes.Helper.curry=function(a,b,d){if(2<arguments.length){var e,f;e=Array.prototype.slice.call(arguments,2);return function(){f=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(f,e);return a.apply(b,f)}}return function(){return a.apply(b,arguments)}}})(jQuery);(function(a){a.pkp.classes.ObjectProxy=function(){};a.pkp.classes.ObjectProxy.prototype.objectName_="";a.pkp.classes.ObjectProxy.prototype.self=function(c,b){var d,e;for(d=this.constructor;d;d=d.parent_&&d.parent_.constructor)if(d.hasOwnProperty(c))return d=d[c],a.isFunction(d)?(e=Array.prototype.slice.call(arguments,1),d.apply(this,e)):d;throw Error(['Static property "',c,'" not found!'].join(""));};a.pkp.classes.ObjectProxy.prototype.parent=function(c,b){var d,e,f,i;d=a.pkp.classes.ObjectProxy.prototype.parent.caller;
if(d.parent_)return e=Array.prototype.slice.call(arguments),d.parent_.constructor.apply(this,e);e=Array.prototype.slice.call(arguments,1);if(this.hasOwnProperty(c)&&this[c]===d)return this.constructor.parent_[c].apply(this,e);f=!1;for(i=this.constructor;i;i=i.parent_&&i.parent_.constructor)if(i.prototype.hasOwnProperty(c)&&i.prototype[c]===d)f=!0;else if(f)return i.prototype[c].apply(this,e);throw Error("Trying to call parent from a method of one name to a method of a different name");};a.pkp.classes.ObjectProxy.prototype.getObjectName=
function(){return this.objectName_}})(jQuery);(function(a){a.pkp.classes.Handler=function(a,b){if(1<a.length)throw Error("jQuery selector contained more than one handler!");this.$htmlElement_=a;if(void 0!==this.data("handler"))throw Error(['The handler "',this.getObjectName(),'" has already been bound to the selected element!'].join(""));this.eventBindings_={};this.dataItems_={};this.publishedEvents_={};b.$eventBridge&&(this.$eventBridge_=b.$eventBridge);if(b.publishChangeEvents){this.publishChangeEvents_=b.publishChangeEvents;var d;for(d=0;d<
this.publishChangeEvents_.length;d++)this.publishEvent(this.publishChangeEvents_[d])}else this.publishChangeEvents_=[];this.data("handler",this)};a.pkp.classes.Handler.prototype.publishChangeEvents_=null;a.pkp.classes.Handler.prototype.$htmlElement_=null;a.pkp.classes.Handler.prototype.eventBindings_=null;a.pkp.classes.Handler.prototype.dataItems_=null;a.pkp.classes.Handler.prototype.publishedEvents_=null;a.pkp.classes.Handler.prototype.$eventBridge_=null;a.pkp.classes.Handler.getHandler=function(c){c=
c.data("pkp.handler");if(!(c instanceof a.pkp.classes.Handler))throw Error("There is no handler bound to this element!");return c};a.pkp.classes.Handler.prototype.getHtmlElement=function(){a.pkp.classes.Handler.checkContext_(this);return this.$htmlElement_};a.pkp.classes.Handler.prototype.publishChangeEvents=function(){var a;for(a=0;a<this.publishChangeEvents_.length;a++)this.trigger(this.publishChangeEvents_[a])};a.pkp.classes.Handler.prototype.handleEvent=function(c){var b,d,e,f,i,g;b=a(this);d=
a.pkp.classes.Handler.getHandler(b);if(b[0]!==d.getHtmlElement.call(d)[0])throw Error("An invalid handler is bound to the calling element of an event!");b=d.eventBindings_[c.type];if(void 0===b)return!1;e=a.makeArray(arguments);f=!0;e.unshift(this);i=0;for(g=b.length;i<g&&!(!1===b[i].apply(d,e)&&(f=!1),c.isImmediatePropagationStopped());i++);c.stopPropagation();return f};a.pkp.classes.Handler.prototype.callbackWrapper=function(c,b){a.pkp.classes.Handler.checkContext_(this);b||(b=this);return function(){var d;
d=a.makeArray(arguments);d.unshift(this);return c.apply(b,d)}};a.pkp.classes.Handler.prototype.remoteResponse=function(a,b){return this.handleJson(b)};a.pkp.classes.Handler.prototype.remove=function(){a.pkp.classes.Handler.checkContext_(this);var c,b;c=this.getHtmlElement();c.unbind(".pkpHandler");for(b in this.dataItems_)"pkp.handler"!==b&&c.removeData(b);c.trigger("pkpRemoveHandler");c.unbind(".pkpHandlerRemove");c.removeData("pkp.handler")};a.pkp.classes.Handler.prototype.handleJson=function(a){if(!a)throw Error("Server error: Server returned no or invalid data!");
if(!0===a.status)return a.event&&(a.event.data?this.trigger(a.event.name,a.event.data):this.trigger(a.event.name)),a;a.content&&alert(a.content);return!1};a.pkp.classes.Handler.prototype.setHtmlElement=function(c){a.pkp.classes.Handler.checkContext_(this);return this.$htmlElement_=c};a.pkp.classes.Handler.prototype.bind=function(c,b){a.pkp.classes.Handler.checkContext_(this);if(!this.eventBindings_[c]){this.eventBindings_[c]=[];var d;d=".pkpHandler";"pkpRemoveHandler"===c&&(d=".pkpHandlerRemove");
this.getHtmlElement().bind(c+d,this.handleEvent)}this.eventBindings_[c].push(b)};a.pkp.classes.Handler.prototype.unbind=function(c,b){a.pkp.classes.Handler.checkContext_(this);if(!this.eventBindings_[c])return!1;var d,e;d=0;for(e=this.eventBindings_[c].length;d<e;d++)if(this.eventBindings_[c][d]===b){this.eventBindings_[c].splice([d],1);break}0===this.eventBindings_[c].length&&(delete this.eventBindings_[c],this.getHtmlElement().unbind(c,this.handleEvent));return!0};a.pkp.classes.Handler.prototype.data=
function(c,b){a.pkp.classes.Handler.checkContext_(this);c="pkp."+c;void 0!==b&&(this.dataItems_[c]=!0);return this.getHtmlElement().data(c,b)};a.pkp.classes.Handler.prototype.trigger=function(a,b){void 0===b&&(b=null);this.getHtmlElement().triggerHandler(a,b);this.publishedEvents_[a]||this.triggerPublicEvent_(a,b)};a.pkp.classes.Handler.prototype.publishEvent=function(a){this.publishedEvents_[a]||(this.publishedEvents_[a]=!0,this.bind(a,function(b,d,e){var f=null;2<arguments.length&&(f=Array.prototype.slice.call(arguments,
2));this.triggerPublicEvent_(a,f)}))};a.pkp.classes.Handler.prototype.switchViz=function(c){a(c.currentTarget).parent().parent().find("span").toggle()};a.pkp.classes.Handler.prototype.initializeTinyMCE=function(){if("undefined"!==typeof tinyMCE){var c=this.getHtmlElement().attr("id"),b;b=function(){var c=tinyMCE.activeEditor,b=c.dom.getRoot();b.scrollHeight>b.clientHeight?a("#mceLocalizationIcon-"+c.id).addClass("mceLocalizationIconScroll"):a("#mceLocalizationIcon-"+c.id).removeClass("mceLocalizationIconScroll")};
setTimeout(function(){a("#"+c).find(".richContent").each(function(){var c=a(this).attr("id"),e=a("<div></div>"),f=a("<div></div>");tinyMCE.execCommand("mceAddControl",!1,c);if(a(this).hasClass("localizable")||a(this).hasClass("flag")){e.addClass("mceLocalizationIcon localizable");e.attr("id","mceLocalizationIcon-"+c);f.addClass("mceLocalizationIconParent");a(this).wrap(f);a(this).parent().append(e);if(a(this).hasClass("localizable"))e.addClass("mceGlobe");else if(a(this).hasClass("flag")&&(c=a(this).attr("class").split(" "),
c.length))for(f=0;f<c.length;f++)if(c[f].match(/^flag_[a-z]{2}_[A-Z]{2}$/)){e.addClass(c[f]);break}b();tinyMCE.dom.Event.add(tinyMCE.activeEditor.dom.get("tinymce"),"keyup",function(){b()})}})},500)}};a.pkp.classes.Handler.prototype.triggerPublicEvent_=function(c,b){this.getHtmlElement().parent().trigger(c,b);this.$eventBridge_&&a('[id^="'+this.$eventBridge_+'"]').trigger(c,b)};a.pkp.classes.Handler.checkContext_=function(c){if(!(c instanceof a.pkp.classes.Handler))throw Error("Trying to call handler method in non-handler context!");
}})(jQuery);(function(a){a.pkp.classes.linkAction=a.pkp.classes.linkAction||{};a.pkp.classes.linkAction.LinkActionRequest=function(a,b){this.$linkActionElement=a;this.options=b;a.is("a")&&b.url&&a.attr("href",b.url)};a.pkp.classes.linkAction.LinkActionRequest.prototype.$linkActionElement=null;a.pkp.classes.linkAction.LinkActionRequest.prototype.options=null;a.pkp.classes.linkAction.LinkActionRequest.prototype.activate=function(){this.getLinkActionElement().trigger("actionStart");return!1};a.pkp.classes.linkAction.LinkActionRequest.prototype.finish=
function(){this.options.finishCallback&&this.options.finishCallback();this.getLinkActionElement().trigger("actionStop");return!1};a.pkp.classes.linkAction.LinkActionRequest.prototype.getUrl=function(){return this.options.url?this.options.url:null};a.pkp.classes.linkAction.LinkActionRequest.prototype.getOptions=function(){return this.options};a.pkp.classes.linkAction.LinkActionRequest.prototype.getLinkActionElement=function(){return this.$linkActionElement}})(jQuery);(function(a){a.pkp.classes.linkAction.RedirectRequest=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.linkAction.RedirectRequest,a.pkp.classes.linkAction.LinkActionRequest);a.pkp.classes.linkAction.RedirectRequest.prototype.activate=function(a,b){var d=this.getOptions();window.open(d.url,d.name,d.specs);return this.parent("activate",a,b)}})(jQuery);(function(a){a.pkp.classes.linkAction.OpenWindowRequest=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.linkAction.OpenWindowRequest,a.pkp.classes.linkAction.LinkActionRequest);a.pkp.classes.linkAction.OpenWindowRequest.prototype.activate=function(a,b){var d=this.getOptions();window.open(d.url);return this.parent("activate",a,b)}})(jQuery);(function(a){a.pkp.classes.linkAction.PostAndRedirectRequest=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.linkAction.PostAndRedirectRequest,a.pkp.classes.linkAction.LinkActionRequest);a.pkp.classes.linkAction.PostAndRedirectRequest.prototype.postJsonData_=null;a.pkp.classes.linkAction.PostAndRedirectRequest.prototype.activate=function(c,b){var d=this.parent("activate",c,b),e=this.getOptions(),f=a.pkp.classes.Helper.curry(this.handleResponse_,this);a.post(e.postUrl,f,
"json");return d};a.pkp.classes.linkAction.PostAndRedirectRequest.prototype.finishCallback_=function(){var c=this.getLinkActionElement(),c=a.pkp.classes.Handler.getHandler(c);this.finish();c.handleJson(this.postJsonData_)};a.pkp.classes.linkAction.PostAndRedirectRequest.prototype.handleResponse_=function(c){var b=this.getOptions(),d=null,e=null;this.postJsonData_=c;d=setInterval(function(){0==a.active&&(clearInterval(d),window.location=b.url)},100);e=a.pkp.classes.Helper.curry(this.finishCallback_,
this);setTimeout(e,2E3)}})(jQuery);(function(a){a.pkp.classes.linkAction.NullAction=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.linkAction.NullAction,a.pkp.classes.linkAction.LinkActionRequest);a.pkp.classes.linkAction.NullAction.prototype.activate=function(a,b){return this.parent("activate",a,b)}})(jQuery);(function(a){a.pkp.classes.linkAction.EventAction=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.linkAction.EventAction,a.pkp.classes.linkAction.LinkActionRequest);a.pkp.classes.linkAction.EventAction.prototype.activate=function(c,b){a(this.options.target).trigger(this.options.event,this.options);return this.parent("activate",c,b)};a.pkp.classes.linkAction.EventAction.prototype.shouldDebounce=function(){return!1}})(jQuery);(function(a){a.pkp.classes.linkAction.AjaxRequest=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.linkAction.AjaxRequest,a.pkp.classes.linkAction.LinkActionRequest);a.pkp.classes.linkAction.AjaxRequest.prototype.activate=function(c,b){var d=this.parent("activate",c,b),e=this.getOptions(),f=a.pkp.classes.Helper.curry(this.handleResponse,this);switch(e.requestType){case "get":a.getJSON(e.url,f);break;case "post":a.post(e.url,f,"json")}return d};a.pkp.classes.linkAction.AjaxRequest.prototype.handleResponse=
function(a){this.getLinkActionElement().data("pkp.handler").handleJson(a);this.finish()}})(jQuery);(function(a){a.pkp.classes.linkAction.ModalRequest=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.linkAction.ModalRequest,a.pkp.classes.linkAction.LinkActionRequest);a.pkp.classes.linkAction.ModalRequest.prototype.$dialog_=null;a.pkp.classes.linkAction.ModalRequest.prototype.activate=function(c,b){var d=this.getOptions(),e=this.getLinkActionElement(),f=e.text();void 0===d.title&&(""===f&&(f=e.attr("title")),d.title=f);e=a.pkp.classes.Helper.uuid();if(!d.modalHandler)throw Error('The "modalHandler" setting is required in a ModalRequest');
f=this.getLinkActionElement();f=a.pkp.classes.Handler.getHandler(f);f=a.extend(!0,{$eventBridge:f.getStaticId()},d);this.$dialog_=a("<div id="+e+"></div>").pkpHandler(d.modalHandler,f);a.pkp.classes.Handler.getHandler(this.$dialog_).bind("pkpRemoveHandler",a.pkp.classes.Helper.curry(this.finish,this));return this.parent("activate",c,b)};a.pkp.classes.linkAction.ModalRequest.prototype.finish=function(){this.$dialog_.remove();return this.parent("finish")}})(jQuery);(function(a){a.pkp.classes.notification=a.pkp.classes.notification||{};a.pkp.classes.notification.NotificationHelper=function(){};a.pkp.classes.notification.NotificationHelper.redirectNotifyUserEvent=function(c,b){var d,e,f,i,g,h,j,k,l,p,m;if(void 0!==b.content)c.getHtmlElement().parent().trigger("notifyUser",[b]);else{d=c.getHtmlElement();e=!1;!(c instanceof a.pkp.controllers.SiteHandler)&&0<a(b).parents(".pkp_controllers_grid").length&&(d.parent().trigger("notifyUser"),e=!0);d=a(".pkp_notification",
d);f=[];i=0;for(g=d.length;i<g;i++)if(j=a(d[i]),!(0<j.parents(":hidden").length)){h=j.parents();l=0;for(p=h.length;l<p;l++)if(k=a(h[l]).data("pkp.handler"),k instanceof a.pkp.classes.Handler){m=a(h[l]);break}if(m.has(b[0]).length||m[0]===b[0]){if(0<j.parents(".ui-accordion:first").length&&(h=j.parents(".ui-accordion:first"),!h.has(b[0])))continue;f.push(j)}}if(f.length)for(i=f.length-1;-1<i;i--)f[i].triggerHandler("notifyUser");else e||c.getHtmlElement().parent().trigger("notifyUser")}}})(jQuery);(function(a){a.pkp.classes.features=a.pkp.classes.features||{};a.pkp.classes.features.Feature=function(a,b){this.gridHandler=a;this.options_=b;this.addFeatureHtml(this.getGridHtmlElement(),b)};a.pkp.classes.features.Feature.prototype.gridHandler=null;a.pkp.classes.features.Feature.prototype.options_=null;a.pkp.classes.features.Feature.prototype.setOptions=function(a){this.options_=a};a.pkp.classes.features.Feature.prototype.getOptions=function(){return this.options_};a.pkp.classes.features.Feature.prototype.init=
function(){throw Error("Abstract method!");};a.pkp.classes.features.Feature.prototype.addElement=function(){return!1};a.pkp.classes.features.Feature.prototype.replaceElement=function(){return!1};a.pkp.classes.features.Feature.prototype.resequenceRows=function(){return!1};a.pkp.classes.features.Feature.prototype.refreshGrid=function(){return!1};a.pkp.classes.features.Feature.prototype.replaceElementResponseHandler=function(){return!1};a.pkp.classes.features.Feature.prototype.callbackWrapper=function(a,
b){return this.gridHandler.callbackWrapper(a,b)};a.pkp.classes.features.Feature.prototype.addFeatureHtml=function(){};a.pkp.classes.features.Feature.prototype.getGridHtmlElement=function(){return this.gridHandler.getHtmlElement()}})(jQuery);(function(a){a.pkp.classes.features.OrderItemsFeature=function(c,b){this.parent(c,b);this.$orderButton_=a("a.order_items:first",this.getGridHtmlElement()).not("table a");this.$finishControl_=a(".order_finish_controls",this.getGridHtmlElement());0===this.$orderButton_.length&&(this.isOrdering=!0);this.itemsOrder=[]};a.pkp.classes.Helper.inherits(a.pkp.classes.features.OrderItemsFeature,a.pkp.classes.features.Feature);a.pkp.classes.features.OrderItemsFeature.prototype.itemsOrder=null;a.pkp.classes.features.OrderItemsFeature.prototype.isOrdering=
!1;a.pkp.classes.features.OrderItemsFeature.prototype.$orderButton_=null;a.pkp.classes.features.OrderItemsFeature.prototype.$cancelButton_=null;a.pkp.classes.features.OrderItemsFeature.prototype.$saveButton_=null;a.pkp.classes.features.OrderItemsFeature.prototype.$finishControl_=null;a.pkp.classes.features.OrderItemsFeature.prototype.getOrderButton=function(){return this.$orderButton_};a.pkp.classes.features.OrderItemsFeature.prototype.getFinishControl=function(){return this.$finishControl_};a.pkp.classes.features.OrderItemsFeature.prototype.getSaveOrderButton=
function(){return this.getFinishControl().find(".saveButton")};a.pkp.classes.features.OrderItemsFeature.prototype.getCancelOrderButton=function(){return this.getFinishControl().find(".cancelFormButton")};a.pkp.classes.features.OrderItemsFeature.prototype.getMoveItemRowActionSelector=function(){return".orderable a.order_items"};a.pkp.classes.features.OrderItemsFeature.prototype.getMoveItemClasses=function(){return"pkp_helpers_moveicon ordering"};a.pkp.classes.features.OrderItemsFeature.prototype.dragStartCallback=
function(){};a.pkp.classes.features.OrderItemsFeature.prototype.dragStopCallback=function(){};a.pkp.classes.features.OrderItemsFeature.prototype.updateOrderCallback=function(){};a.pkp.classes.features.OrderItemsFeature.prototype.init=function(){this.addOrderingClassToRows();this.toggleMoveItemRowAction(this.isOrdering);this.toggleOrderLink_();this.isOrdering&&this.setupSortablePlugin()};a.pkp.classes.features.OrderItemsFeature.prototype.addFeatureHtml=function(c,b){var d;void 0!==b.orderFinishControls&&
(d=a(b.orderFinishControls),c.find("table").last().after(d),d.hide())};a.pkp.classes.features.OrderItemsFeature.prototype.addOrderingClassToRows=function(){this.gridHandler.getRows().addClass("orderable")};a.pkp.classes.features.OrderItemsFeature.prototype.setupSortablePlugin=function(){};a.pkp.classes.features.OrderItemsFeature.prototype.storeRowOrder=function(){};a.pkp.classes.features.OrderItemsFeature.prototype.clickOrderHandler=function(){this.gridHandler.hideAllVisibleRowActions();this.storeOrder(this.gridHandler.getRows());
this.toggleState(!0);return!1};a.pkp.classes.features.OrderItemsFeature.prototype.saveOrderHandler=function(){var a;this.gridHandler.updateControlRowsPosition();this.unbindOrderFinishControlsHandlers_();a=this.gridHandler.getRows();this.storeOrder(a);return!1};a.pkp.classes.features.OrderItemsFeature.prototype.cancelOrderHandler=function(){this.gridHandler.resequenceRows(this.itemsOrder);this.toggleState(!1);return!1};a.pkp.classes.features.OrderItemsFeature.prototype.toggleState=function(a){this.isOrdering=
a;this.toggleGridLinkActions_();this.toggleOrderLink_();this.toggleFinishControl_();this.toggleItemsDragMode();this.setupSortablePlugin()};a.pkp.classes.features.OrderItemsFeature.prototype.storeOrder=function(c){var b,d,e,f;this.itemsOrder=[];b=0;for(d=c.length;b<d;b++)e=a(c[b]),f=e.attr("id"),this.itemsOrder.push(f),this.storeRowOrder(b,e)};a.pkp.classes.features.OrderItemsFeature.prototype.toggleItemsDragMode=function(){var a=this.isOrdering,b=this.gridHandler.getRows().filter(".orderable"),d=
this.getMoveItemClasses();a?b.addClass(d):b.removeClass(d);this.toggleMoveItemRowAction(a)};a.pkp.classes.features.OrderItemsFeature.prototype.applySortPlgOnElements=function(c,b,d){var e=this.isOrdering,f=this.gridHandler.callbackWrapper(this.dragStartCallback,this),i=this.gridHandler.callbackWrapper(this.dragStopCallback,this),g=this.gridHandler.callbackWrapper(this.updateOrderCallback,this),b={disabled:!e,items:b,activate:f,deactivate:i,update:g,tolerance:"pointer"};"object"===typeof d&&(b=a.extend(!0,
b,d));c.sortable(b)};a.pkp.classes.features.OrderItemsFeature.prototype.getRowsDataId=function(c){var b,d=[],e;for(b in this.itemsOrder)e=a("#"+this.itemsOrder[b],c),1>e.length||(e=this.gridHandler.getRowDataId(e),d.push(e));return d};a.pkp.classes.features.OrderItemsFeature.prototype.toggleMoveItemRowAction=function(c){var b=this.getGridHtmlElement(),d=a("div.row_actions",b),e="a:not("+this.getMoveItemRowActionSelector()+")",f=d.find(e),d=a(this.getMoveItemRowActionSelector(),b);c?(f.addClass("pkp_helpers_display_none"),
d.show(),this.gridHandler.showRowActionsDiv()):(f.removeClass("pkp_helpers_display_none"),c=a(".gridRow div.row_actions",b),e=c.find(e),0===e.length&&this.gridHandler.hideRowActionsDiv(),d.hide())};a.pkp.classes.features.OrderItemsFeature.prototype.addElement=function(){this.addOrderingClassToRows();this.toggleItemsDragMode();return!1};a.pkp.classes.features.OrderItemsFeature.prototype.replaceElement=function(){this.addOrderingClassToRows();this.toggleItemsDragMode();return!1};a.pkp.classes.features.OrderItemsFeature.prototype.toggleGridLinkActions_=
function(){var c=this.isOrdering,b=a(".pkp_controllers_linkAction",this.getGridHtmlElement()).not(this.getMoveItemRowActionSelector()).not(this.getOrderButton()).not(this.getFinishControl().find("*"));this.gridHandler.changeLinkActionsState(!c,b)};a.pkp.classes.features.OrderItemsFeature.prototype.toggleOrderLink_=function(){if(this.isOrdering)this.$orderButton_.unbind("click"),this.$orderButton_.addClass("ui-state-disabled");else{var a=this.gridHandler.callbackWrapper(this.clickOrderHandler,this);
this.$orderButton_.click(a);this.$orderButton_.removeClass("ui-state-disabled")}};a.pkp.classes.features.OrderItemsFeature.prototype.toggleFinishControl_=function(){this.isOrdering?(this.bindOrderFinishControlsHandlers_(),this.getFinishControl().slideDown(300)):(this.unbindOrderFinishControlsHandlers_(),this.getFinishControl().slideUp(300))};a.pkp.classes.features.OrderItemsFeature.prototype.bindOrderFinishControlsHandlers_=function(){var a=this.getSaveOrderButton(),b=this.getCancelOrderButton(),
d=this.gridHandler.callbackWrapper(this.cancelOrderHandler,this),e=this.gridHandler.callbackWrapper(this.saveOrderHandler,this);a.click(e);b.click(d)};a.pkp.classes.features.OrderItemsFeature.prototype.unbindOrderFinishControlsHandlers_=function(){this.getSaveOrderButton().unbind("click");this.getCancelOrderButton().unbind("click")}})(jQuery);(function(a){a.pkp.classes.features.OrderGridItemsFeature=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.features.OrderGridItemsFeature,a.pkp.classes.features.OrderItemsFeature);a.pkp.classes.features.OrderGridItemsFeature.prototype.setupSortablePlugin=function(){this.applySortPlgOnElements(this.getGridHtmlElement(),"tr.orderable",null)};a.pkp.classes.features.OrderGridItemsFeature.prototype.saveOrderHandler=function(){var c,b,d=this.getOptions();this.parent("saveOrderHandler");
c=JSON.stringify(this.getItemsDataId());b=this.callbackWrapper(this.saveOrderResponseHandler_,this);a.post(d.saveItemsSequenceUrl,{data:c},b,"json");return!1};a.pkp.classes.features.OrderGridItemsFeature.prototype.getItemsDataId=function(){return this.getRowsDataId(this.getGridHtmlElement())};a.pkp.classes.features.OrderGridItemsFeature.prototype.saveOrderResponseHandler_=function(a,b){this.gridHandler.handleJson(b);this.toggleState(!1)}})(jQuery);(function(a){a.pkp.classes.features.OrderCategoryGridItemsFeature=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.features.OrderCategoryGridItemsFeature,a.pkp.classes.features.OrderGridItemsFeature);a.pkp.classes.features.OrderCategoryGridItemsFeature.prototype.setupSortablePlugin=function(){var c,b,d,e;this.applySortPlgOnElements(this.getGridHtmlElement(),"tbody.orderable",null);if(!(a.browser.msie&&8>=parseInt(a.browser.version.substring(0,1),10))){c=this.gridHandler.getCategories();
b=0;for(d=c.length;b<d;b++)e=a(c[b]),this.applySortPlgOnElements(e,"tr.orderable",null)}};a.pkp.classes.features.OrderCategoryGridItemsFeature.prototype.saveOrderHandler=function(){this.gridHandler.updateEmptyPlaceholderPosition();this.parent("saveOrderHandler");return!1};a.pkp.classes.features.OrderCategoryGridItemsFeature.prototype.cancelOrderHandler=function(){var a=this.getCategorySequence_(this.itemsOrder);this.parent("cancelOrderHandler");this.gridHandler.resequenceCategories(a);return!1};a.pkp.classes.features.OrderCategoryGridItemsFeature.prototype.toggleItemsDragMode=
function(){this.parent("toggleItemsDragMode");var c=this.gridHandler.getCategories(),b,d,e;b=0;for(d=c.length;b<d;b++)e=a(c[b]),this.toggleCategoryDragMode_(e)};a.pkp.classes.features.OrderCategoryGridItemsFeature.prototype.addOrderingClassToRows=function(){var c=this.getOptions().type,b;if(c==a.pkp.cons.ORDER_CATEGORY_GRID_CATEGORIES_ONLY||c==a.pkp.cons.ORDER_CATEGORY_GRID_CATEGORIES_AND_ROWS)b=this.gridHandler.getCategories(),b.addClass("orderable");(c==a.pkp.cons.ORDER_CATEGORY_GRID_CATEGORIES_ROWS_ONLY||
c==a.pkp.cons.ORDER_CATEGORY_GRID_CATEGORIES_AND_ROWS)&&this.parent("addOrderingClassToRows");this.gridHandler.getCategoryRow().removeClass("orderable")};a.pkp.classes.features.OrderCategoryGridItemsFeature.prototype.getItemsDataId=function(){var c=this.getCategorySequence_(this.itemsOrder),b=[],d,e,f,i;d=0;for(e=c.length;d<e;d++)f=a("#"+c[d]),i=this.getRowsDataId(f),f=this.gridHandler.getCategoryDataId(f),b.push({categoryId:f,rowsId:i});return b};a.pkp.classes.features.OrderCategoryGridItemsFeature.prototype.toggleCategoryDragMode_=
function(c){var b=this.isOrdering,c=this.gridHandler.getCategoryRow(c),c=a("td:first",c),d=this.getMoveItemClasses();b?c.addClass(d):c.removeClass(d)};a.pkp.classes.features.OrderCategoryGridItemsFeature.prototype.getCategorySequence_=function(c){var b,d,e=[],f;b=0;for(d=c.length;b<d;b++)f=this.gridHandler.getCategoryDataIdByRowId(c[b]),f=this.gridHandler.getCategoryIdPrefix()+f,-1<a.inArray(f,e)||e.push(f);return e}})(jQuery);(function(a){a.pkp.classes.features.OrderListbuilderItemsFeature=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.features.OrderListbuilderItemsFeature,a.pkp.classes.features.OrderItemsFeature);a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.addFeatureHtml=function(c,b){var d,e,f,i,g,h;this.parent("addFeatureHtml",c,b);d=this.getSequenceInput_();e=this.gridHandler.getRows();f=0;for(i=e.length;f<i;f++)g=a(e[f]),h=d.clone(),a("td.first_column",g).append(h)};
a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.setupSortablePlugin=function(){this.applySortPlgOnElements(this.getGridHtmlElement(),"tr.orderable",null)};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.init=function(){this.parent("init");this.toggleItemsDragMode()};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.toggleState=function(a){this.parent("toggleState",a);this.toggleContentHandlers_()};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.storeRowOrder=
function(a,b){b.find(".itemSequence").attr("value",a+1);b.find(".isModified").attr("value",1)};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.saveOrderHandler=function(){this.parent("saveOrderHandler");this.toggleState(!1);return!1};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.updateOrderCallback=function(){var a;this.parent("updateOrderCallback");a=this.gridHandler.getRows();this.storeOrder(a)};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.clickOrderHandler=
function(){var c=a("select:visible",this.getGridHtmlElement()),b,d;if(0<c.length){b=0;for(d=c.length;b<d;b++)this.gridHandler.saveRow(a(c[b]).parents(".gridRow"))}return this.parent("clickOrderHandler")};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.addElement=function(a){this.parent("addElement",a);this.formatAndStoreNewRow_(a);return!1};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.replaceElement=function(a){this.parent("replaceElement",a);this.formatAndStoreNewRow_(a);
return!1};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.getSequenceInput_=function(){return a('<input type="hidden" name="newRowId[sequence]" class="itemSequence" />')};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.toggleContentHandlers_=function(){var c=this.gridHandler.getRows(),b,d,e;b=0;for(d=c.length;b<d;b++)e=a(c[b]),this.isOrdering?e.find(".gridCellDisplay").unbind("click"):this.gridHandler.attachContentHandlers_(e)};a.pkp.classes.features.OrderListbuilderItemsFeature.prototype.formatAndStoreNewRow_=
function(a){a.children().after(this.getSequenceInput_());a=this.gridHandler.getRows();this.storeOrder(a)}})(jQuery);(function(a){a.pkp.classes.features.OrderMultipleListsItemsFeature=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.features.OrderMultipleListsItemsFeature,a.pkp.classes.features.OrderListbuilderItemsFeature);a.pkp.classes.features.OrderMultipleListsItemsFeature.prototype.addFeatureHtml=function(c,b){var d,e,f,i,g,h,j;this.parent("addFeatureHtml",c,b);d=a('<input type="hidden" name="newRowId[listId]" class="itemList" />');e=this.gridHandler.getRows();f=0;for(i=e.length;f<
i;f++)g=a(e[f]),h=this.gridHandler.getListIdByRow(g),j=d.clone(),j.attr("value",h),a("td.first_column",g).append(j)};a.pkp.classes.features.OrderMultipleListsItemsFeature.prototype.storeRowOrder=function(a,b){var d,e;this.parent("storeRowOrder",a,b);d=b.find(".itemList");e=this.gridHandler.getListIdByRow(b);d.attr("value",e)};a.pkp.classes.features.OrderMultipleListsItemsFeature.prototype.setupSortablePlugin=function(){var a=this.gridHandler.getLists().find("tbody");this.applySortPlgOnElements(a,
"tr.orderable",{connectWith:a})};a.pkp.classes.features.OrderMultipleListsItemsFeature.prototype.dragStartCallback=function(a,b,d){a=this.gridHandler.getListByRow(d.item);this.gridHandler.toggleListNoItemsRow(a,1,".ui-sortable-placeholder, .ui-sortable-helper")};a.pkp.classes.features.OrderMultipleListsItemsFeature.prototype.dragStopCallback=function(a,b,d){a=this.gridHandler.getListByRow(d.item);this.gridHandler.toggleListNoItemsRow(a,0,null)}})(jQuery);(function(a){a.pkp.classes.features.GridCategoryAccordionFeature=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.features.GridCategoryAccordionFeature,a.pkp.classes.features.Feature);a.pkp.classes.features.GridCategoryAccordionFeature.prototype.getExpandClass=function(){return"expanded"};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.getCollapseClass=function(){return"collapsed"};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.getAccordionLinks=
function(c){var b="."+this.getCollapseClass(),d="."+this.getExpandClass();return a(b+","+d,c)};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.init=function(){var c;a(".grid_header_bar .expand_all",this.getGridHtmlElement()).click(this.callbackWrapper(this.expandAllClickHandler_,this));c=a(".grid_header_bar .collapse_all",this.getGridHtmlElement());c.click(this.callbackWrapper(this.collapseAllClickHandler_,this));this.bindCategoryAccordionControls_(this.getGridHtmlElement());c.click();
this.hideEmptyPlaceholders_()};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.replaceElement=function(c){this.bindCategoryAccordionControls_(c);a("."+this.getExpandClass(),c).click();this.hideEmptyPlaceholders_();return!1};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.bindCategoryAccordionControls_=function(a){this.getAccordionLinks(a).click(this.callbackWrapper(this.accordionRowClickHandler_,this))};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.hideEmptyPlaceholders_=
function(){a("tbody.empty",this.getGridHtmlElement()).hide()};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.expandAllClickHandler_=function(c){a(c).hide();a(".grid_header_bar .collapse_all").show();a(".category ."+this.getExpandClass(),this.getGridHtmlElement()).click();return!1};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.collapseAllClickHandler_=function(c){a(c).hide();a(".grid_header_bar .expand_all").show();a(".category ."+this.getCollapseClass(),this.getGridHtmlElement()).click();
a(".row_controls :visible").closest("tr").prev().find(".row_actions > a:first").click();return!1};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.accordionRowClickHandler_=function(c){var b=a(c),d;b.hide();d=b.parents(".category_grid_body:first");c=this.gridHandler.getRowsInCategory(d);0===c.length&&(c=this.gridHandler.getCategoryEmptyPlaceholder(d));d=b.parent();b.hasClass(this.getExpandClass())?(b=a("."+this.getCollapseClass(),d),b.show(),c.show()):(b=a("."+this.getExpandClass(),d),
b.show(),c.hide());this.updateGridActions_();return!1};a.pkp.classes.features.GridCategoryAccordionFeature.prototype.updateGridActions_=function(){var c,b,d,e,f;this.getGridHtmlElement().is(":visible")&&(c=this.getGridHtmlElement(),b="."+this.getExpandClass()+", ."+this.getCollapseClass(),b=a(b,c).filter(":visible"),d=a("."+this.getExpandClass(),c).filter(":visible"),c=a("."+this.getCollapseClass(),c).filter(":visible"),e=a(".grid_header_bar .collapse_all"),f=a(".grid_header_bar .expand_all"),b.length==
d.length&&e.is(":visible")?e.click():b.length==c.length&&f.is(":visible")&&f.click())}})(jQuery);(function(a){a.pkp.classes.features.PagingFeature=function(a,b){b.defaultItemsPerPage=parseInt(b.defaultItemsPerPage,10);b.currentItemsPerPage=parseInt(b.currentItemsPerPage,10);b.itemsTotal=b.itemsTotal?parseInt(b.itemsTotal,10):0;b.currentPage=parseInt(b.currentPage,10);this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.classes.features.PagingFeature,a.pkp.classes.features.Feature);a.pkp.classes.features.PagingFeature.prototype.getOptions=function(){return this.parent("getOptions")};a.pkp.classes.features.PagingFeature.prototype.init=
function(){this.configPagingLinks_();this.configItemsPerPageElement_()};a.pkp.classes.features.PagingFeature.prototype.addFeatureHtml=function(a,b){a.append(b.pagingMarkup)};a.pkp.classes.features.PagingFeature.prototype.resequenceRows=function(){var a=this.gridHandler.getRows(),b,d;b=this.getOptions();b=a.length-b.currentItemsPerPage;if(0<b)for(d=0;d<b;d++)this.gridHandler.deleteElement(a.first(),!0);return!1};a.pkp.classes.features.PagingFeature.prototype.refreshGrid=function(){var c=this.getOptions(),
b,d,e;b=this.gridHandler.getFetchExtraParams();b[c.pageParamName]=c.currentPage;b[c.itemsPerPageParamName]=c.currentItemsPerPage;d=this.gridHandler.getRows().first();e=this.gridHandler.getRows().last();b.topLimitRowId=0==d.length?0:this.gridHandler.getRowDataId(d);b.bottomLimitRowId=0==e.length?0:this.gridHandler.getRowDataId(e);c.hasOwnProperty("filter")&&(c=a.parseJSON(c.filter),a.extend(!0,b,c));this.gridHandler.setFetchExtraParams(b);return!1};a.pkp.classes.features.PagingFeature.prototype.replaceElementResponseHandler=
function(c){var b,d;d=this.getOptions();void 0!=c.deletedRowReplacement&&(b=c.deletedRowReplacement,this.gridHandler.insertOrReplaceElement(b));void 0!=c.pagingInfo&&(b=c.pagingInfo,this.setOptions(b),a("div.gridPaging",this.getGridHtmlElement()).replaceWith(b.pagingMarkup),this.init());c.loadLastPage&&this.getGridHtmlElement().trigger("dataChanged");void 0!=c.newTopRow&&(b=this.gridHandler.getRows(),d.currentItemsPerPage==b.length&&this.gridHandler.deleteElement(b.last(),!0),b=c.newTopRow,this.gridHandler.insertOrReplaceElement(b,
!0));return!1};a.pkp.classes.features.PagingFeature.prototype.configPagingLinks_=function(){var c,b,d,e,f,i,g,h;c=this.getOptions();if(b=a("div.gridPaging",this.getGridHtmlElement())){h=this.callbackWrapper(function(b,d){i=RegExp("[?&]"+c.pageParamName+"(?:=([^&]*))?","i");g=i.exec(a(d.target).attr("href"));null!=g&&(c.currentPage=parseInt(g[1],10),this.getGridHtmlElement().trigger("dataChanged"));return!1},this);b=b.find("a").not(".showMoreItems").not(".showLessItems");d=0;for(e=b.length;d<e;d++)f=
a(b[d]),f.click(h)}};a.pkp.classes.features.PagingFeature.prototype.configItemsPerPageElement_=function(){var c,b,d,e,f,i;c=this.getOptions();if(b=a("div.gridPaging",this.getGridHtmlElement()))if(i=this.callbackWrapper(function(b,d){c.currentItemsPerPage=parseInt(a("option",d.target).filter(":selected").attr("value"),10);c.currentPage=1;this.getGridHtmlElement().trigger("dataChanged");return!1},this),e=b.find("select.itemsPerPage"),f=[10,25,50,75,100],0>a.inArray(c.defaultItemsPerPage,f)&&f.push(c.defaultItemsPerPage),
f.sort(function(a,c){return a-c}),c.itemsTotal<=f[0])a("div.gridItemsPerPage",b).hide();else{d=f.length-1;for(b=0;b<=d;b++)e.append(a('<option value="'+f[b]+'">'+f[b]+"</option>"));e.val(c.currentItemsPerPage.toString());e.change(i)}}})(jQuery);(function(a){a.pkp.controllers.SiteHandler=function(c,b){this.parent(c,b);this.options_=b;this.unsavedFormElements_=[];a(".go").button();this.bind("redirectRequested",this.redirectToUrl);this.bind("notifyUser",this.fetchNotificationHandler_);this.bind("updateHeader",this.updateHeaderHandler_);this.bind("updateSidebar",this.updateSidebarHandler_);this.bind("callWhenClickOutside",this.callWhenClickOutsideHandler_);this.bind("mousedown",this.mouseDownHandler_);this.bind("urlInDivLoaded",this.setMainMaxWidth_);
this.bind("gridInitialized",this.updateHelpDisplayHandler_);this.bind("toggleInlineHelp",this.toggleInlineHelpHandler_);a(window).bind("beforeunload",this.pageUnloadHandler_);a.ajaxSetup({cache:!1});a("select.applyPlugin",c).selectBox();b.hasSystemNotifications&&this.trigger("notifyUser");this.bind("formChanged",this.callbackWrapper(this.registerUnsavedFormElement_));this.bind("unregisterChangedForm",this.callbackWrapper(this.unregisterUnsavedFormElement_));this.bind("modalCanceled",this.callbackWrapper(this.unregisterUnsavedFormElement_));
this.bind("unregisterAllForms",this.callbackWrapper(this.unregisterAllFormElements_));this.outsideClickChecks_={}};a.pkp.classes.Helper.inherits(a.pkp.controllers.SiteHandler,a.pkp.classes.Handler);a.pkp.controllers.SiteHandler.prototype.options_=null;a.pkp.controllers.SiteHandler.prototype.outsideClickChecks_=null;a.pkp.controllers.SiteHandler.prototype.unsavedFormElements_=null;a.pkp.controllers.SiteHandler.prototype.triggerTinyMCEInitialized=function(c){a("#"+c.editorId).trigger("tinyMCEInitialized",
[c])};a.pkp.controllers.SiteHandler.prototype.triggerTinyMCESetup=function(c){a("#"+c.id).attr("readonly")&&(c.settings.readonly=!0);c.onInit.add(function(c){var d=a("#"+c.id),e;e=a("#"+c.id).attr("placeholder");""!==e&&(e=a("<span></span>").html(e),e.addClass("mcePlaceholder"),e.attr("id","mcePlaceholder-"+c.id),c.getContent().length&&e.hide(),c=a("<div></div>"),c.addClass("mcePlaceholderParent"),d.wrap(c),d.parent().append(e))});c.onActivate.add(function(c){a("#mcePlaceholder-"+c.id).hide()});c.onDeactivate.add(function(c){c.getContent().length||
a("#mcePlaceholder-"+c.id).show();c.dom.addClass(c.dom.select("li"),"show")})};a.pkp.controllers.SiteHandler.prototype.redirectToUrl=function(a,b,d){window.location=d};a.pkp.controllers.SiteHandler.prototype.registerUnsavedFormElement_=function(c,b,d){c=a(d.target.lastElementChild).attr("id");-1==a.inArray(c,this.unsavedFormElements_)&&this.unsavedFormElements_.push(c)};a.pkp.controllers.SiteHandler.prototype.unregisterUnsavedFormElement_=function(c,b,d){c=a(d.target.lastElementChild).attr("id");
c=a.inArray(c,this.unsavedFormElements_);-1!==c&&delete this.unsavedFormElements_[c]};a.pkp.controllers.SiteHandler.prototype.unregisterAllFormElements_=function(){this.unsavedFormElements_=[]};a.pkp.controllers.SiteHandler.prototype.toggleInlineHelpHandler_=function(){a.ajax({url:this.options_.toggleHelpUrl});this.options_.inlineHelpState=this.options_.inlineHelpState?0:1;this.updateHelpDisplayHandler_();return!1};a.pkp.controllers.SiteHandler.prototype.updateHelpDisplayHandler_=function(){var a;
a=this.getHtmlElement();this.options_.inlineHelpState?(a.find(".pkp_grid_description, #legend, .pkp_help").css("visibility","visible").show(),a.find('[id^="toggleHelp"]').html(this.options_.toggleHelpOffText)):(a.find(".pkp_grid_description, #legend, .pkp_help").hide(),a.find('[id^="toggleHelp"]').html(this.options_.toggleHelpOnText))};a.pkp.controllers.SiteHandler.prototype.fetchNotificationHandler_=function(c,b,d){void 0!==d?this.showNotification_(d):a.ajax({url:this.options_.fetchNotificationUrl,
data:this.options_.requestOptions,success:this.callbackWrapper(this.showNotificationResponseHandler_),dataType:"json",async:!1})};a.pkp.controllers.SiteHandler.prototype.updateHeaderHandler_=function(){a.pkp.classes.Handler.getHandler(a("#headerContainer")).reload()};a.pkp.controllers.SiteHandler.prototype.updateSidebarHandler_=function(){a.pkp.classes.Handler.getHandler(a("#sidebarContainer")).reload()};a.pkp.controllers.SiteHandler.prototype.callWhenClickOutsideHandler_=function(a,b,d){void 0!==
d.container&&void 0!==d.callback&&(a=d.container.attr("id"),this.outsideClickChecks_[a]=d)};a.pkp.controllers.SiteHandler.prototype.mouseDownHandler_=function(c,b){var d;if(!a.isEmptyObject(this.outsideClickChecks_))for(d in this.outsideClickChecks_)this.processOutsideClickCheck_(this.outsideClickChecks_[d],b);return!0};a.pkp.controllers.SiteHandler.prototype.processOutsideClickCheck_=function(a,b){if("click"!==b.type&&"mousedown"!==b.type&&"mouseup"!==b.type)throw Error("Can not check outside click with the passed event: "+
b.type+".");var d=a.container;return d.is(":hidden")||void 0!==a.skipWhenVisibleModals&&a.skipWhenVisibleModals&&0<this.getHtmlElement().find("div.ui-dialog").length?!1:0===d.has(b.target).length?(delete this.outsideClickChecks_[d.attr("id")],a.callback(),!0):!1};a.pkp.controllers.SiteHandler.prototype.pageUnloadHandler_=function(){var c,b,d;c=a.pkp.classes.Handler.getHandler(a("body"));b=0;for(d in c.unsavedFormElements_)d&&b++;if(0<b)return a.pkp.locale.form_dataHasChanged};a.pkp.controllers.SiteHandler.prototype.isFormUnsaved=
function(a){return null!==this.unsavedFormElements_&&void 0!==this.unsavedFormElements_[a]?!0:!1};a.pkp.controllers.SiteHandler.prototype.showNotificationResponseHandler_=function(a,b){this.showNotification_(b)};a.pkp.controllers.SiteHandler.prototype.showNotification_=function(c){var b,d,c=this.handleJson(c);if(!1!==c&&c.content.general)for(b in c=c.content.general,c)for(d in c[b])a.pnotify(c[b][d])};a.pkp.controllers.SiteHandler.prototype.setMainMaxWidth_=function(c,b,d){var e=this.getHtmlElement(),
c=a(".pkp_structure_main",e),f;c.find(".ui-tabs").tabs();"sidebarContainer"==d&&(d=a(".pkp_structure_content",e).width(),b=a(".pkp_structure_sidebar_left",e).outerWidth(!0),e=a(".pkp_structure_sidebar_right",e).outerWidth(!0),f=c.outerWidth(!0)-c.width(),c.css("max-width",d-(b+e+f)),1==c.find(".stTabsInnerWrapper").length&&(c.find(".stTabsMainWrapper").width(c.outerWidth(!0)),d=c.find(".ui-tabs-nav").offset().left+c.find(".ui-tabs-nav").outerWidth(!0),b=c.find(".ui-tabs-nav").find("li").last(),b=
b.offset().left+b.outerWidth(!0),b<=d?c.find(".stTabsMainWrapper").find("div").first().hide():c.find(".stTabsMainWrapper").find("div").first().show()))}})(jQuery);(function(a){a.pkp.controllers.UrlInDivHandler=function(a,b){this.parent(a,b);this.sourceUrl_=b.sourceUrl;this.reload()};a.pkp.classes.Helper.inherits(a.pkp.controllers.UrlInDivHandler,a.pkp.classes.Handler);a.pkp.controllers.UrlInDivHandler.sourceUrl_=null;a.pkp.controllers.UrlInDivHandler.prototype.reload=function(){a.get(this.sourceUrl_,this.callbackWrapper(this.handleLoadedContent_),"json")};a.pkp.controllers.UrlInDivHandler.prototype.handleLoadedContent_=function(a,b){var d=this.handleJson(b);
!0===d.status?void 0===d.content?this.getHtmlElement().hide():(jQuery.browser.msie?this.getHtmlElement().html(d.content):this.getHtmlElement().hide().html(d.content).fadeIn(400),this.trigger("urlInDivLoaded",[this.getHtmlElement().attr("id")])):alert(d.content);return!1}})(jQuery);(function(a){a.pkp.controllers.ExtrasOnDemandHandler=function(c,b){this.parent(c,b);a(".toggleExtras",c).show().click(this.callbackWrapper(this.toggleExtras));this.deactivateExtraContent_()};a.pkp.classes.Helper.inherits(a.pkp.controllers.ExtrasOnDemandHandler,a.pkp.classes.Handler);a.pkp.controllers.ExtrasOnDemandHandler.prototype.toggleExtras=function(c){var b=this.getHtmlElement();a(c,b).hasClass("active")?this.deactivateExtraContent_("slow"):this.activateExtraContent_("slow")};a.pkp.controllers.ExtrasOnDemandHandler.prototype.activateExtraContent_=
function(c){var b,d;b=this.getHtmlElement();a(".toggleExtras .toggleExtras-inactive",b).hide();a(".extrasContainer",b).show(c);a(".toggleExtras .toggleExtras-active",b).show();a(".toggleExtras",b).removeClass("inactive").addClass("active");a(".ui-icon",b).removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s");d=b.closest(".scrollable");0<d.size()&&(a.browser.msie&&7>=parseInt(a.browser.version.substring(0,1),10)?setTimeout(function(){this.scrollToMakeVisible_(b,d)},500):this.scrollToMakeVisible_(b,
d))};a.pkp.controllers.ExtrasOnDemandHandler.prototype.deactivateExtraContent_=function(c){var b=this.getHtmlElement();a(".extrasContainer",b).hide(c);a(".toggleExtras .toggleExtras-active",b).hide();a(".toggleExtras .toggleExtras-inactive",b).show();a(".toggleExtras",b).removeClass("active").addClass("inactive");a(".ui-icon",b).removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e")};a.pkp.controllers.ExtrasOnDemandHandler.prototype.scrollToMakeVisible_=function(a,b){var d,e,f;d=a.position().top;
e=b.position().top;f=parseInt(b.scrollTop(),10);d>e?(d=Math.ceil(d+a.height()-b.height()),0<d&&b.scrollTop(f+d)):(f=Math.max(Math.floor(f+d-e),0),b.scrollTop(f))}})(jQuery);(function(a){a.pkp.controllers.PageHandler=function(a,b){this.parent(a,b);this.bind("redirectRequested",this.redirectToUrl);this.bind("notifyUser",this.redirectNotifyUserEventHandler_);this.bind("redirectDataChangedToGrid",this.redirectDataChangedEventHandler_)};a.pkp.classes.Helper.inherits(a.pkp.controllers.PageHandler,a.pkp.classes.Handler);a.pkp.controllers.PageHandler.prototype.redirectToUrl=function(a,b,d){window.location=d};a.pkp.controllers.PageHandler.prototype.redirectNotifyUserEventHandler_=
function(c,b,d){!0===d.status?this.getHtmlElement().parent().trigger("notifyUser",[d]):a.pkp.classes.notification.NotificationHelper.redirectNotifyUserEvent(this,d)};a.pkp.controllers.PageHandler.prototype.redirectDataChangedEventHandler_=function(c,b,d){c=a("a",b.target);c=a.pkp.classes.Handler.getHandler(c).getUrl();c=a(".pkp_controllers_grid",this.getHtmlElement()).has("a[href="+c+"]");0<c.length&&c.each(function(){a(this).trigger("dataChanged",[d])})}})(jQuery);(function(a){a.pkp.controllers.TabHandler=function(a,b){var d,e,f;this.parent(a,b);this.bind("tabsselect",this.tabsSelect);this.bind("tabsshow",this.tabsShow);this.bind("tabsload",this.tabsLoad);this.bind("containerReloadRequested",this.tabsReloadRequested);this.bind("addTab",this.addTab);b.emptyLastTab&&(this.emptyLastTab_=b.emptyLastTab);d=document.location.toString();if(d.match("#")){d=d.split("#")[1];e=a.find("li a");for(f=0;f<e.length;f++)d==e[f].getAttribute("name")&&(b.selected=f)}a.tabs({ajaxOptions:{cache:!1,
dataFilter:this.callbackWrapper(this.dataFilter)},selected:b.selected});0==a.find(".stTabsInnerWrapper").length&&!b.notScrollable&&a.tabs().scrollabletab()};a.pkp.classes.Helper.inherits(a.pkp.controllers.TabHandler,a.pkp.classes.Handler);a.pkp.controllers.TabHandler.prototype.$currentTab_=null;a.pkp.controllers.TabHandler.prototype.currentTabIndex_=0;a.pkp.controllers.TabHandler.prototype.emptyLastTab_=!1;a.pkp.controllers.TabHandler.prototype.tabsSelect=function(){var c=!1;this.$currentTab_.find("form").each(function(){if(a.pkp.classes.Handler.getHandler(a("#"+
a(this).attr("id"))).formChangesTracked)return c=!0,!1});this.$currentTab_.find(".hasDatepicker").datepicker("hide");if(c)if(confirm(a.pkp.locale.form_dataHasChanged))this.trigger("unregisterAllForms");else return!1;this.emptyLastTab_&&(a(window).one("error",function(){return!1}),this.$currentTab_&&this.$currentTab_.empty());return!0};a.pkp.controllers.TabHandler.prototype.tabsShow=function(c,b,d){this.$currentTab_=d.panel.jquery?d.panel:a(d.panel);this.currentTabIndex_=d.index;return!0};a.pkp.controllers.TabHandler.prototype.tabsLoad=
function(){return!0};a.pkp.controllers.TabHandler.prototype.dataFilter=function(c,b){var d=this.handleJson(a.parseJSON(b));return!1===d?"":d.content};a.pkp.controllers.TabHandler.prototype.tabsReloadRequested=function(c,b,d){var e=this.getHtmlElement();a.get(d.tabsUrl,function(c){c=a.parseJSON(c);e.replaceWith(c.content)})};a.pkp.controllers.TabHandler.prototype.addTab=function(c,b,d){var e=this.getHtmlElement(),c=e.children("ul").children("li").length+1,d=a("<a/>").text(d.title).attr("href",d.url),
b=a("<span/>").addClass("ui-icon").addClass("ui-icon-close").text(a.pkp.locale.common_close).attr("role","presentation"),f=a("<li/>").append(d).append(b);b.click(function(){var c=a(this).closest("li"),b=a("#"+c.attr("aria-controls")),d=c.eq(0).index(),f;f=!1;b.find("form").each(function(){if(a.pkp.classes.Handler.getHandler(a(this)).formChangesTracked&&!confirm(a.pkp.locale.form_dataHasChanged))return f=!0,!1});f||(b.find("form").each(function(){var c=a.pkp.classes.Handler.getHandler(a(this));c&&
c.unregisterForm()}),e.tabs("option","selected")==d&&e.tabs("select",d-1),c.remove(),b.remove(),e.tabs("refresh"))});e.children("ul").append(f);e.tabs("refresh");e.tabs("option","active",c-1);d.click()};a.pkp.controllers.TabHandler.prototype.getCurrentTab=function(){return this.$currentTab_};a.pkp.controllers.TabHandler.prototype.getCurrentTabIndex=function(){return this.currentTabIndex_}})(jQuery);(function(a){a.pkp.controllers.UploaderHandler=function(c,b){this.parent(c,b);if(!c.is("div"))throw Error("An uploader widget controller can only be attached to a div!");var d=a.extend({},this.self("DEFAULT_PROPERTIES_"),{url:b.uploadUrl,flash_swf_url:b.baseUrl+"/lib/pkp/js/lib/plupload/plupload.flash.swf",silverlight_xap_url:b.baseUrl+"/lib/pkp/js/lib/plupload/plupload.silverlight.xap"});c.plupload(d);d=c.plupload("getUploader");d.refresh();/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)||c.find("div.plupload").css("z-index",
99999);c.find("div.plupload input").css("z-index",99999);d.bind("FilesAdded",this.callbackWrapper(this.limitQueueSize));d.bind("QueueChanged",this.callbackWrapper(this.refreshUploader))};a.pkp.classes.Helper.inherits(a.pkp.controllers.UploaderHandler,a.pkp.classes.Handler);a.pkp.controllers.UploaderHandler.prototype.limitQueueSize=function(a,b){1<b.files.length&&(b.splice(0,1),b.refresh())};a.pkp.controllers.UploaderHandler.prototype.refreshUploader=function(a,b){b.refresh()};a.pkp.controllers.UploaderHandler.DEFAULT_PROPERTIES_=
{runtimes:"html5, flash, silverlight",max_file_size:a.pkp.cons.UPLOAD_MAX_FILESIZE,multi_selection:!1,file_data_name:"uploadedFile",multipart:!0,headers:{browser_user_agent:navigator.userAgent}}})(jQuery);(function(a){a.pkp.controllers.AutocompleteHandler=function(c,b){var d;this.parent(c,b);this.sourceUrl_=b.sourceUrl;b.sourceUrl=void 0;this.jLabelText_=b.jLabelText;this.disableSync_=b.disableSync;d={};d.source=this.callbackWrapper(this.fetchAutocomplete);d=a.extend({},this.self("DEFAULT_PROPERTIES_"),d,b);this.textInput=c.find(":text");this.disableSync_||this.textInput.keyup(this.callbackWrapper(this.synchronizeFields_));this.textInput.autocomplete(d);this.textInput.attr("title",this.jLabelText_);
a("#"+this.textInput.attr("id")).jLabel();this.textInput.attr("title","");this.textLabel_=c.find("label");this.hiddenInput_=c.find("input:hidden");this.bind("autocompleteselect",this.itemSelected);this.bind("autocompletefocus",this.itemFocused);this.textInput.blur(this.callbackWrapper(this.textInputBlurHandler_))};a.pkp.classes.Helper.inherits(a.pkp.controllers.AutocompleteHandler,a.pkp.classes.Handler);a.pkp.controllers.AutocompleteHandler.textLabel_=null;a.pkp.controllers.AutocompleteHandler.jLabelText_=
null;a.pkp.controllers.AutocompleteHandler.disableSync_=null;a.pkp.controllers.AutocompleteHandler.DEFAULT_PROPERTIES_={minLength:2};a.pkp.controllers.AutocompleteHandler.prototype.hiddenInput_=null;a.pkp.controllers.AutocompleteHandler.prototype.sourceUrl_=null;a.pkp.controllers.AutocompleteHandler.prototype.textInput=null;a.pkp.controllers.AutocompleteHandler.prototype.itemSelected=function(a,b,d){a=this.hiddenInput_;b=this.textInput;""!==d.item.value&&(a.val(d.item.value),b.val(d.item.label),b.trigger("keyup"));
return!1};a.pkp.controllers.AutocompleteHandler.prototype.itemFocused=function(a,b,d){a=this.textInput;""!==d.item.value&&a.val(d.item.label);return!1};a.pkp.controllers.AutocompleteHandler.prototype.fetchAutocomplete=function(c,b,d){var e;e=this.textInput;e.addClass("spinner");a.post(this.getAutocompleteUrl(),{term:b.term},function(a){e.removeClass("spinner");d(a.content)},"json")};a.pkp.controllers.AutocompleteHandler.prototype.getAutocompleteUrl=function(){return this.sourceUrl_};a.pkp.controllers.AutocompleteHandler.prototype.setAutocompleteUrl=
function(a){this.sourceUrl_=a};a.pkp.controllers.AutocompleteHandler.prototype.textInputBlurHandler_=function(){""===this.hiddenInput_.val()&&this.textInput.val("")};a.pkp.controllers.AutocompleteHandler.prototype.synchronizeFields_=function(){this.hiddenInput_.val(String(this.textInput.val()))}})(jQuery);(function(a){a.pkp.controllers.RangeSliderHandler=function(c,b){this.parent(c,b);if(!b.min||!b.max)throw Error('The "min" and "max"settings are required in a RangeSliderHandler');this.slider_=c.children(".pkp_controllers_rangeSlider_slider");this.label_=c.find(".pkp_controllers_rangeSlider_sliderValue");var d={};d.min=b.min;d.max=b.max;d.values=[b.min,b.max];d=a.extend({},this.self("DEFAULT_PROPERTIES_"),d);this.slider_.slider(d);this.bind("slide",this.sliderAdjusted)};a.pkp.classes.Helper.inherits(a.pkp.controllers.RangeSliderHandler,
a.pkp.classes.Handler);a.pkp.controllers.RangeSliderHandler.slider_=null;a.pkp.controllers.RangeSliderHandler.label_=null;a.pkp.controllers.RangeSliderHandler.DEFAULT_PROPERTIES_={range:!0};a.pkp.controllers.RangeSliderHandler.prototype.sliderAdjusted=function(c,b,d){this.label_.val(d.values[0]+" - "+d.values[1]);a(c).children(".pkp_controllers_rangeSlider_minInput").val(d.values[0]);a(c).children(".pkp_controllers_rangeSlider_maxInput").val(d.values[1])}})(jQuery);(function(a){a.pkp.controllers.NotificationHandler=function(a,b){this.parent(a,b);this.options_=b;this.bind("notifyUser",this.fetchNotificationHandler_);this.getHtmlElement().hide();this.getHtmlElement().triggerHandler("notifyUser")};a.pkp.classes.Helper.inherits(a.pkp.controllers.NotificationHandler,a.pkp.classes.Handler);a.pkp.controllers.NotificationHandler.prototype.options_=null;a.pkp.controllers.NotificationHandler.prototype.trivialTimer_=null;a.pkp.controllers.NotificationHandler.prototype.fetchNotificationHandler_=
function(){var c={};c.requestOptions=this.options_.requestOptions;a.ajax({type:"POST",url:this.options_.fetchNotificationUrl,data:c,success:this.callbackWrapper(this.showNotificationResponseHandler_),dataType:"json",async:!1})};a.pkp.controllers.NotificationHandler.prototype.showNotificationResponseHandler_=function(c,b){clearTimeout(this.trivialTimer_);var d=this.getHtmlElement(),e=this.handleJson(b),f,i,g;if(!1!==e)if(e.content.inPlace){f=this.concatenateNotifications_(e.content.inPlace);i=this.removeAlreadyShownNotifications_(e);
d.html(f);d.show();e=this.getTrivialNotifications_(e.content.inPlace);if(!this.visibleWithoutScrolling_()&&i)for(g in d.parent().trigger("notifyUser",[i]),e)i=e[g],a("#pkp_notification_"+i,this.getHtmlElement()).remove();0===d.children().length?d.hide():this.addTimerToNotifications(e)}else this.getHtmlElement().empty(),this.getHtmlElement().hide()};a.pkp.controllers.NotificationHandler.prototype.visibleWithoutScrolling_=function(){var c=this.getHtmlElement(),b=c.offset().top+this.getHtmlElement().height()/
2,d=a(window).scrollTop(),e=d+a(window).height(),f=c.parents(".ui-dialog-content");return 0<f.length&&(c=f.offset().top,f=c+f.height(),b<c||b>f)?!1:b<d||b>e?!1:!0};a.pkp.controllers.NotificationHandler.prototype.removeAlreadyShownNotifications_=function(c){var b=!0,d,e,f;for(d in c.content.inPlace)for(e in c.content.inPlace[d])f=a("#pkp_notification_"+e),0<f.length?(delete c.content.inPlace[d][e],delete c.content.general[d][e]):b=!1;return b?!1:c};a.pkp.controllers.NotificationHandler.prototype.concatenateNotifications_=
function(a){var b="",d,e;for(d in a)for(e in a[d])b+=a[d][e];return b};a.pkp.controllers.NotificationHandler.prototype.getTrivialNotifications_=function(a){var b=[],d,e;for(d in a)if(1==d)for(e in a[d])b.push(e);return b};a.pkp.controllers.NotificationHandler.prototype.addTimerToNotifications=function(c){var b=function(){a(this).remove()};c.length&&(this.trivialTimer_=setTimeout(function(){var d,e;for(d in c)e=a("#pkp_notification_"+c[d]),e.fadeOut(400,b())},6E3))}})(jQuery);(function(a){a.pkp.controllers.form=a.pkp.controllers.form||{};a.pkp.controllers.form.FormHandler=function(c,b){var d;this.parent(c,b);if(!c.is("form"))throw Error("A form handler controller can only be bound to an HTML form element!");!1!==b.transformButtons&&a(".button",c).button();b.submitHandler&&(this.callerSubmitHandler_=b.submitHandler);b.cancelRedirectUrl&&(this.cancelRedirectUrl_=b.cancelRedirectUrl);"undefined"!==typeof b.trackFormChanges&&(this.trackFormChanges=b.trackFormChanges);b.disableControlsOnSubmit&&
(this.disableControlsOnSubmit=b.disableControlsOnSubmit);b.enableDisablePairs&&(this.enableDisablePairs_=b.enableDisablePairs,this.setupEnableDisablePairs());for(d in this.enableDisablePairs_)c.find("[id^='"+d+"']").trigger("updatePair");b.fetchUsernameSuggestionUrl&&b.usernameSuggestionTextAlert&&(this.fetchUsernameSuggestionUrl_=b.fetchUsernameSuggestionUrl,this.usernameSuggestionTextAlert_=b.usernameSuggestionTextAlert);d=c.validate({onfocusout:this.callbackWrapper(this.onFocusOutValidation_),
errorClass:"error",highlight:function(c,b){a(c).parent().parent().addClass(b)},unhighlight:function(c,b){a(c).parent().parent().removeClass(b)},submitHandler:this.callbackWrapper(this.submitHandler_),showErrors:this.callbackWrapper(this.showErrors)});a("#cancelFormButton",c).click(this.callbackWrapper(this.cancelForm));a("#resetFormButton",c).click(this.callbackWrapper(this.resetForm));c.find(".showMore, .showLess").bind("click",this.switchViz);a('[id^="suggestUsernameButton"]',c).click(this.callbackWrapper(this.generateUsername));
d.checkForm()?this.trigger("formValid"):this.trigger("formInvalid");this.initializeTinyMCE();a("#submitFormButton",c).click(this.callbackWrapper(this.pushTinyMCEChanges_));a(":input",c).change(this.callbackWrapper(this.formChange));c.click(this.callbackWrapper(this.hideDatepicker_));this.publishEvent("tinyMCEInitialized");this.bind("tinyMCEInitialized",this.tinyMCEInitHandler_)};a.pkp.classes.Helper.inherits(a.pkp.controllers.form.FormHandler,a.pkp.classes.Handler);a.pkp.controllers.form.FormHandler.prototype.disableControlsOnSubmit=
!1;a.pkp.controllers.form.FormHandler.prototype.trackFormChanges=!0;a.pkp.controllers.form.FormHandler.prototype.callerSubmitHandler_=null;a.pkp.controllers.form.FormHandler.prototype.cancelRedirectUrl_=null;a.pkp.controllers.form.FormHandler.prototype.formChangesTracked=!1;a.pkp.controllers.form.FormHandler.prototype.enableDisablePairs_=null;a.pkp.controllers.form.FormHandler.prototype.fetchUsernameSuggestionUrl_="";a.pkp.controllers.form.FormHandler.prototype.usernameSuggestionTextAlert_="";a.pkp.controllers.form.FormHandler.prototype.showErrors=
function(c){"undefined"!==typeof tinyMCE&&tinyMCE.triggerSave();var b=a.extend(!0,{},c);setTimeout(this.callbackWrapper(function(){b.defaultShowErrors();b=null}),250);c.checkForm()?this.trigger("formValid"):(this.trigger("formInvalid"),this.enableFormControls())};a.pkp.controllers.form.FormHandler.prototype.formChange=function(){this.trackFormChanges&&!this.formChangesTracked&&(this.formChangesTracked=!0,this.trigger("formChanged"))};a.pkp.controllers.form.FormHandler.prototype.disableFormControls=
function(){this.disableControlsOnSubmit&&this.getHtmlElement().find(":submit").attr("disabled","disabled").addClass("ui-state-disabled");return!0};a.pkp.controllers.form.FormHandler.prototype.enableFormControls=function(){this.getHtmlElement().find(":submit").removeAttr("disabled").removeClass("ui-state-disabled");return!0};a.pkp.controllers.form.FormHandler.prototype.cancelForm=function(){this.unregisterForm();this.trigger("formCanceled");return!1};a.pkp.controllers.form.FormHandler.prototype.unregisterForm=
function(){this.formChangesTracked=!1;this.trigger("unregisterChangedForm")};a.pkp.controllers.form.FormHandler.prototype.resetForm=function(){this.formChangesTracked=!1;this.trigger("unregisterChangedForm");this.getHtmlElement().each(function(){this.reset()});return!1};a.pkp.controllers.form.FormHandler.prototype.setupEnableDisablePairs=function(){var c=this.getHtmlElement(),b;for(b in this.enableDisablePairs_)a(c).find("[id^='"+b+"']").bind("click updatePair",this.callbackWrapper(this.toggleDependentElement_));
return!0};a.pkp.controllers.form.FormHandler.prototype.submitFormWithoutValidation=function(a){a.settings.submitHandler=null;this.disableFormControls();this.getHtmlElement().submit();this.formChangesTracked=!1};a.pkp.controllers.form.FormHandler.prototype.generateUsername=function(){var c=this.getHtmlElement(),b;""===a('[id^="lastName"]',c).val()?alert(this.usernameSuggestionTextAlert_):(b=a('[id^="firstName"]',c).val(),c=a('[id^="lastName"]',c).val(),b=this.fetchUsernameSuggestionUrl_.replace("FIRST_NAME_DUMMY",
b).replace("LAST_NAME_DUMMY",c),a.get(b,this.callbackWrapper(this.setUsername),"json"))};a.pkp.controllers.form.FormHandler.prototype.setUsername=function(c,b){var d=this.handleJson(b),e=this.getHtmlElement();if(!1===d)throw Error("JSON response must be set to true!");a('[id^="username"]',e).val(d.content)};a.pkp.controllers.form.FormHandler.prototype.initializeTinyMCE_=function(){if("undefined"!==typeof tinyMCE){var c;c=this.getHtmlElement().attr("id");setTimeout(function(){a("#"+c).find(".richContent").each(function(){tinyMCE.execCommand("mceAddControl",
!1,a(this).attr("id").toString())})},500)}};a.pkp.controllers.form.FormHandler.prototype.submitHandler_=function(c,b){var d=new a.Event("formSubmitRequested");a(b).find(".formWidget").trigger(d);d.isDefaultPrevented()||(a(b).find(".pkp_helpers_progressIndicator").show(),this.trigger("unregisterChangedForm"),null!==this.callerSubmitHandler_?(this.formChangesTracked=!1,this.callbackWrapper(this.callerSubmitHandler_).call(c,b)):this.submitFormWithoutValidation(c))};a.pkp.controllers.form.FormHandler.prototype.pushTinyMCEChanges_=
function(){"undefined"!==typeof tinyMCE&&tinyMCE.triggerSave();return!0};a.pkp.controllers.form.FormHandler.prototype.toggleDependentElement_=function(c){var b,d;b=this.getHtmlElement();d=a(c).attr("id");b=a(b).find("[id^='"+this.enableDisablePairs_[d]+"']");a(c).is(":checked")?a(b).attr("disabled",""):a(b).attr("disabled","disabled");return!0};a.pkp.controllers.form.FormHandler.prototype.tinyMCEInitHandler_=function(c,b,d){var e=d.editorId;a(d.getWin()).blur(this.callbackWrapper(function(){d.save();
var c=this.getHtmlElement(),b=a("#"+e,c);c.validate().element(b)}))};a.pkp.controllers.form.FormHandler.prototype.onFocusOutValidation_=function(c,b){var d=this.getHtmlElement();a(b).parents("#"+d.attr("id")).length&&c.element(b);return!0};a.pkp.controllers.form.FormHandler.prototype.hideDatepicker_=function(c,b){var d,e;d=b.originalEvent.relatedTarget;e=this.getHtmlElement();!a(d).hasClass("hasDatepicker")&&(!a(d).hasClass("ui-datepicker")&&!a(d).hasClass("ui-icon")&&!a(d).hasClass("ui-datepicker-next")&&
!a(d).hasClass("ui-datepicker-prev")&&!a(d).parent().parents(".ui-datepicker").length)&&a(e).find(".hasDatepicker").datepicker("hide")}})(jQuery);(function(a){a.pkp.controllers.form.DropdownHandler=function(a,b){this.parent(a,b);this.eventName_=b.eventName;this.defaultKey_=b.defaultKey;this.publishEvent(this.eventName_);this.getOptionsUrl_=b.getOptionsUrl;this.trackFormChanges=!1;a.find("select").change(this.callbackWrapper(this.selectOptionHandler_));this.loadOptions_();this.bind("containerReloadRequested",this.containerReloadHandler_)};a.pkp.classes.Helper.inherits(a.pkp.controllers.form.DropdownHandler,a.pkp.classes.Handler);a.pkp.controllers.form.DropdownHandler.prototype.eventName_=
null;a.pkp.controllers.form.DropdownHandler.prototype.defaultKey_=null;a.pkp.controllers.form.DropdownHandler.prototype.currentKey_=null;a.pkp.controllers.form.DropdownHandler.prototype.getOptionsUrl_=null;a.pkp.controllers.form.DropdownHandler.prototype.selectOptionHandler_=function(c){this.trigger(this.eventName_,[a(c).val()])};a.pkp.controllers.form.DropdownHandler.prototype.loadOptions_=function(){a.get(this.getOptionsUrl_,this.callbackWrapper(this.setOptionList_),"json")};a.pkp.controllers.form.DropdownHandler.prototype.setOptionList_=
function(c,b){var d=this.handleJson(b),e=this.getHtmlElement().find("select"),f,i;for(f in d.content){i=a("<option/>");i.attr("value",f);if(this.defaultKey_==f||this.currentKey_==f)i.attr("selected","selected"),this.trigger(this.eventName_,[f]);i.text(d.content[f]);e.append(i)}this.trigger("dropDownOptionSet")};a.pkp.controllers.form.DropdownHandler.prototype.containerReloadHandler_=function(){var a=this.getHtmlElement().find("select");this.currentKey_=a.find("option:selected").attr("value");a.find('option[value!="0"]').remove();
this.loadOptions_()}})(jQuery);(function(a){a.pkp.controllers.form.AjaxFormHandler=function(a,b){b.submitHandler=this.submitForm;this.parent(a,b);this.bind("refreshForm",this.refreshFormHandler_);this.publishEvent("containerReloadRequested")};a.pkp.classes.Helper.inherits(a.pkp.controllers.form.AjaxFormHandler,a.pkp.controllers.form.FormHandler);a.pkp.controllers.form.AjaxFormHandler.prototype.disableControlsOnSubmit=!0;a.pkp.controllers.form.AjaxFormHandler.prototype.submitForm=function(){var c=this.getHtmlElement();this.disableFormControls();
a.post(c.attr("action"),c.serialize(),this.callbackWrapper(this.handleResponse),"json")};a.pkp.controllers.form.AjaxFormHandler.prototype.refreshFormHandler_=function(a,b,d){d&&this.getHtmlElement().replaceWith(d)};a.pkp.controllers.form.AjaxFormHandler.prototype.handleResponse=function(c,b){var d,e;e=this.handleJson(b);if(!1!==e)if(""===e.content)d=new a.Event("formSubmitted"),a(this.getHtmlElement()).find(".formWidget").trigger(d),this.trigger("formSubmitted"),this.publishChangeEvents(),this.disableControlsOnSubmit&&
this.enableFormControls();else{if(void 0!==e.reloadContainer)return this.trigger("dataChanged"),this.trigger("containerReloadRequested",[e]),e.status;d=this.getHtmlElement();d.replaceWith(e.content)}else this.enableFormControls();a(this.getHtmlElement()).find(".pkp_helpers_progressIndicator").hide();this.getHtmlElement().find(":submit").button();this.trigger("notifyUser",[this.getHtmlElement()]);return e.status}})(jQuery);(function(a){a.pkp.controllers.form.ClientFormHandler=function(a,b){b.submitHandler=this.submitForm;this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.controllers.form.ClientFormHandler,a.pkp.controllers.form.FormHandler);a.pkp.controllers.form.ClientFormHandler.prototype.submitForm=function(){var c;c=this.getHtmlElement().serializeArray();c.push({name:"clientSubmit",value:!0});this.trigger("formSubmitted",[a.param(c)])}})(jQuery);(function(a){a.pkp.controllers.form.ToggleFormHandler=function(a){this.parent(a,{trackFormChanges:!1});a.change(this.callbackWrapper(this.toggleHandler_))};a.pkp.classes.Helper.inherits(a.pkp.controllers.form.ToggleFormHandler,a.pkp.controllers.form.ClientFormHandler);a.pkp.controllers.form.ToggleFormHandler.prototype.toggleHandler_=function(){this.getHtmlElement().submit();return!0}})(jQuery);(function(a){a.pkp.controllers.form.FileUploadFormHandler=function(a,b){this.parent(a,b);void 0!==b.resetUploader&&(this.resetUploader_=b.resetUploader);this.attachUploader_(b.$uploader,b.uploaderOptions);this.uploaderSetup(b.$uploader)};a.pkp.classes.Helper.inherits(a.pkp.controllers.form.FileUploadFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.form.FileUploadFormHandler.prototype.resetUploader_=!1;a.pkp.controllers.form.FileUploadFormHandler.prototype.handleResponse=function(c,
b){var d;this.resetUploader_&&(d=a("#plupload",this.getHtmlElement()).plupload("getUploader"),d.splice(),d.refresh(),a("#temporaryFileId",this.getHtmlElement()).val(""));return this.parent("handleResponse",c,b)};a.pkp.controllers.form.FileUploadFormHandler.prototype.uploaderSetup=function(a){a.plupload("getUploader").bind("FileUploaded",this.callbackWrapper(this.handleUploadResponse))};a.pkp.controllers.form.FileUploadFormHandler.prototype.handleUploadResponse=function(c,b,d,e){c=this.handleJson(a.parseJSON(e.response));
!1!==c&&(this.trigger("fileUploaded",[c.uploadedFile]),""===c.content?(b=this.getHtmlElement(),b=b.find("#temporaryFileId"),b.val(c.temporaryFileId)):this.getHtmlElement().replaceWith(c.content))};a.pkp.controllers.form.FileUploadFormHandler.prototype.attachUploader_=function(a,b){a.pkpHandler("$.pkp.controllers.UploaderHandler",b)}})(jQuery);(function(a){a.pkp.controllers.form.MultilingualInputHandler=function(a,b){this.parent(a,b);var d=null,d=a.hasClass("pkpTagit")?a.find(":input").filter(":visible"):a.find(":input").first();d.focus(this.callbackWrapper(this.focusHandler_));a.find(":input").blur(this.callbackWrapper(this.blurHandler_));this.publishEvent("tinyMCEInitialized");this.bind("tinyMCEInitialized",this.tinyMCEInitHandler_)};a.pkp.classes.Helper.inherits(a.pkp.controllers.form.MultilingualInputHandler,a.pkp.classes.Handler);
a.pkp.controllers.form.MultilingualInputHandler.prototype.focusHandler_=function(){this.showPopover_()};a.pkp.controllers.form.MultilingualInputHandler.prototype.blurHandler_=function(){setTimeout(this.callbackWrapper(function(){this.hasElementInFocus_()||this.hidePopover_()}),0);return!0};a.pkp.controllers.form.MultilingualInputHandler.prototype.hidePopover_=function(){var a=this.getHtmlElement();a.removeClass("localization_popover_container_focus");a.find(".localization_popover").hide()};a.pkp.controllers.form.MultilingualInputHandler.prototype.showPopover_=
function(){var a=this.getHtmlElement();a.addClass("localization_popover_container_focus");a.find(".localization_popover").width(a.width());a.find(".localization_popover").show()};a.pkp.controllers.form.MultilingualInputHandler.prototype.hasElementInFocus_=function(){return this.getHtmlElement().has(document.activeElement).length?!0:!1};a.pkp.controllers.form.MultilingualInputHandler.prototype.tinyMCEInitHandler_=function(c,b,d){c=a("#"+d.editorId).height();a(d.getBody()).height(78*(c/100));a(d.getWin()).focus(this.callbackWrapper(function(){this.trigger("callWhenClickOutside",
{container:this.getHtmlElement(),callback:this.callbackWrapper(this.hidePopover_),skipWhenVisibleModals:!1});var c=this.callbackWrapper(function(c){c=a(c.getWin());this.getHtmlElement().hasClass("localization_popover_container_focus")||c.focus()});d.onSetContent.remove(c);d.onSetContent.add(c);this.showPopover_()}));a(d.getWin()).blur(this.callbackWrapper(function(){if(a(d.getContainer()).find("iframe").attr("id")==a(document.activeElement).attr("id"))return!1;setTimeout(this.callbackWrapper(function(){this.hasElementInFocus_()||
this.hidePopover_()}),0)}))}})(jQuery);(function(a){a.pkp.controllers.form.reviewer=a.pkp.controllers.form.reviewer||{};a.pkp.controllers.form.reviewer.ReviewerReviewStep3FormHandler=function(c,b){this.parent(c,b);a("#submitFormButton",c).click(this.callbackWrapper(this.updateCommentsRequired_))};a.pkp.classes.Helper.inherits(a.pkp.controllers.form.reviewer.ReviewerReviewStep3FormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.form.reviewer.ReviewerReviewStep3FormHandler.prototype.updateCommentsRequired_=function(){var c=
this.getHtmlElement().find('[id^="comments"]');1==a("#reviewAttachmentsGridContainer").find("tbody.empty:visible").length?c.attr("required","1"):c.removeAttr("required");return!0}})(jQuery);(function(a){a.pkp.controllers.grid=a.pkp.controllers.grid||{};a.pkp.controllers.grid.GridHandler=function(a,b){this.parent(a,b);this.initialize(b);this.initFeatures_(b.features)};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.GridHandler,a.pkp.classes.Handler);a.pkp.controllers.grid.GridHandler.prototype.bodySelector=null;a.pkp.controllers.grid.GridHandler.prototype.fetchRowUrl=null;a.pkp.controllers.grid.GridHandler.prototype.gridId_=null;a.pkp.controllers.grid.GridHandler.prototype.fetchGridUrl_=
null;a.pkp.controllers.grid.GridHandler.prototype.features_=null;a.pkp.controllers.grid.GridHandler.prototype.fetchExtraParams_=null;a.pkp.controllers.grid.GridHandler.prototype.getFetchExtraParams=function(){return this.fetchExtraParams_};a.pkp.controllers.grid.GridHandler.prototype.setFetchExtraParams=function(a){this.fetchExtraParams_=a};a.pkp.controllers.grid.GridHandler.prototype.getFetchRowUrl=function(){return this.fetchRowUrl};a.pkp.controllers.grid.GridHandler.prototype.getRows=function(){return a(".gridRow",
this.getHtmlElement())};a.pkp.controllers.grid.GridHandler.prototype.getGridIdPrefix=function(){return"component-"+this.gridId_};a.pkp.controllers.grid.GridHandler.prototype.getRowIdPrefix=function(){return this.getGridIdPrefix()+"-row-"};a.pkp.controllers.grid.GridHandler.prototype.getRowDataId=function(a){var b,d,e,a=a.attr("class").split(" ");for(b in a)if(e=a[b].indexOf("element"),-1!=e){d=a[b].slice(7);break}return d};a.pkp.controllers.grid.GridHandler.prototype.getParentRow=function(a){return a.parents(".gridRow:first")};
a.pkp.controllers.grid.GridHandler.prototype.getElementsByType=function(c){return c.hasClass("gridRow")?(c=c.parents("tbody:first"),a(".gridRow",c)):null};a.pkp.controllers.grid.GridHandler.prototype.getEmptyElement=function(a){return a.hasClass("gridRow")?a.parents("tbody:first").next(".empty"):null};a.pkp.controllers.grid.GridHandler.prototype.toggleRowActions=function(c){c=a(c).parents("tr").next(".row_controls");this.applyToggleRowActionEffect_(c)};a.pkp.controllers.grid.GridHandler.prototype.hideAllVisibleRowActions=
function(){var c,b,d;c=a(".row_controls:visible",this.getHtmlElement());b=0;for(d=c.length;b<d;b++)this.applyToggleRowActionEffect_(a(c[b]))};a.pkp.controllers.grid.GridHandler.prototype.hideRowActionsDiv=function(){var c,b,d,e;c=a(".gridRow div.row_actions",this.getHtmlElement());c.hide();b=0;for(d=c.length;b<d;b++)e=a(c[b]),e.parents(".row_container:first").attr("style","padding-left:0px !important")};a.pkp.controllers.grid.GridHandler.prototype.showRowActionsDiv=function(){var c,b,d,e;c=a(".gridRow div.row_actions",
this.getHtmlElement());c.show();b=0;for(d=c.length;b<d;b++)e=a(c[b]),e.parents(".row_container:first").removeAttr("style")};a.pkp.controllers.grid.GridHandler.prototype.changeLinkActionsState=function(c,b){void 0===b&&(b=a(".pkp_controllers_linkAction",this.getHtmlElement()));b.each(function(){var b;b=a.pkp.classes.Handler.getHandler(a(this));c?b.enableLink():b.disableLink()})};a.pkp.controllers.grid.GridHandler.prototype.resequenceRows=function(c){var b,d,e;for(d in c){b=c[d];e=a("#"+b);0==e.length&&
(e=a("tr.element"+b,this.getHtmlElement()));if(0==e.length)throw Error("Row with id "+b+" not found!");this.addElement(e)}this.updateControlRowsPosition();this.callFeaturesHook("resequenceRows",c)};a.pkp.controllers.grid.GridHandler.prototype.updateControlRowsPosition=function(){var c,b,d,e,f;c=this.getRows();b=0;for(d=c.length;b<d;b++)e=a(c[b]),f=this.getControlRowByGridRow(e),0<f.length&&f.insertAfter(e)};a.pkp.controllers.grid.GridHandler.prototype.insertOrReplaceElement=function(c,b){var d,e,
f;d=a(c);e=d.attr("id");f=this.getHtmlElement();e=e?f.find("#"+e):null;if(null!==e&&1<e.length)throw Error("There were "+e.length+" rather than 0 or 1 elements to be replaced!");this.hasSameNumOfColumns(d)?(null!==e&&1===e.length?this.replaceElement(e,d):this.addElement(d,null,b),this.activateRowActions_()):a.get(this.fetchGridUrl_,null,this.callbackWrapper(this.replaceGridResponseHandler_),"json")};a.pkp.controllers.grid.GridHandler.prototype.deleteElement=function(a,b){var d,e,f;if(1!==a.length)throw Error("There were "+
a.length+" rather than 1 element to delete!");d=!1;1==this.getElementsByType(a).length&&(d=!0);a.hasClass("gridRow")&&this.deleteControlsRow_(a);e=this.getEmptyElement(a);f=function(){a.remove();d&&e.fadeIn(500)};void 0!=b&&b?f():a.fadeOut(500,f)};a.pkp.controllers.grid.GridHandler.prototype.initialize=function(a){this.bind("dataChanged",this.refreshGridHandler);this.bind("addRow",this.addRowHandler_);this.bind("formSubmitted",this.refreshGridWithFilterHandler_);this.gridId_=a.gridId;this.fetchRowUrl=
a.fetchRowUrl;this.fetchGridUrl_=a.fetchGridUrl;this.bodySelector=a.bodySelector;this.activateRowActions_();this.setFetchExtraParams({});this.trigger("gridInitialized")};a.pkp.controllers.grid.GridHandler.prototype.callFeaturesHook=function(c,b){var d;a.isArray(b)||(b=[b]);for(d in this.features_)this.features_[d][c].apply(this.features_[d],b)};a.pkp.controllers.grid.GridHandler.prototype.refreshGridHandler=function(c,b,d,e){this.callFeaturesHook("refreshGrid",null);c=this.getFetchExtraParams();e||
(d?(c.rowId=d,a.get(this.fetchRowUrl,c,this.callbackWrapper(this.replaceElementResponseHandler),"json")):a.get(this.fetchGridUrl_,c,this.callbackWrapper(this.replaceGridResponseHandler_),"json"));this.trigger("gridRefreshRequested");this.publishChangeEvents()};a.pkp.controllers.grid.GridHandler.prototype.addElement=function(a,b,d){if(void 0===b||null===b)b=this.getHtmlElement().find(this.bodySelector);void 0!=d&&d?b.prepend(a):b.append(a);this.getEmptyElement(a).hide();this.callFeaturesHook("addElement",
a)};a.pkp.controllers.grid.GridHandler.prototype.replaceElement=function(a,b){b.hasClass("gridRow")&&this.deleteControlsRow_(a);a.replaceWith(b);this.callFeaturesHook("replaceElement",b)};a.pkp.controllers.grid.GridHandler.prototype.hasSameNumOfColumns=function(a,b){var d,e;d=this.getHtmlElement().find("th").length;e=a.first().find("td");e=b?e.attr("colspan"):e.length;return d==e};a.pkp.controllers.grid.GridHandler.prototype.replaceElementResponseHandler=function(a,b){var d,e;e=this.handleJson(b);
!1!==e&&(e.elementNotFound?(d=e.elementNotFound,d=this.getHtmlElement().find(".element"+d),0<d.length&&this.deleteElement(d)):(this.insertOrReplaceElement(e.content),this.resequenceRows(e.sequenceMap)));this.callFeaturesHook("replaceElementResponseHandler",[e])};a.pkp.controllers.grid.GridHandler.prototype.refreshGridWithFilterHandler_=function(c,b,d){a.post(this.fetchGridUrl_,d,this.callbackWrapper(this.replaceGridResponseHandler_),"json")};a.pkp.controllers.grid.GridHandler.prototype.addRowHandler_=
function(c,b,d){a.get(this.fetchRowUrl,d,this.callbackWrapper(this.replaceElementResponseHandler),"json")};a.pkp.controllers.grid.GridHandler.prototype.replaceGridResponseHandler_=function(a,b){var d,e;d=this.handleJson(b);!1!==d&&(e=this.getHtmlElement(),e.replaceWith(d.content),this.activateRowActions_())};a.pkp.controllers.grid.GridHandler.prototype.deleteControlsRow_=function(c){c=a("#"+c.attr("id")+"-control-row",this.getHtmlElement());c.is("tr")&&c.hasClass("row_controls")&&c.remove()};a.pkp.controllers.grid.GridHandler.prototype.getControlRowByGridRow=
function(c){c=c.attr("id")+"-control-row";return a("#"+c)};a.pkp.controllers.grid.GridHandler.prototype.activateRowActions_=function(){this.getHtmlElement().find("a.settings").unbind("click").bind("click",this.callbackWrapper(this.toggleRowActions))};a.pkp.controllers.grid.GridHandler.prototype.applyToggleRowActionEffect_=function(a){var b;b=a.prev().find("td:not(.indent_row)");b=b.add(a.prev());a.is(":visible")?(setTimeout(function(){b.removeClass("no_border")},0),a.hide(0)):(b.addClass("no_border"),
a.show(0))};a.pkp.controllers.grid.GridHandler.prototype.addFeature_=function(a,b){this.features_||(this.features_=[]);this.features_[a]=b};a.pkp.controllers.grid.GridHandler.prototype.initFeatures_=function(c){var b,d;for(b in c)d=a.pkp.classes.Helper.objectFactory(c[b].JSClass,[this,c[b].options]),this.addFeature_(b,d),this.features_[b].init()}})(jQuery);(function(a){a.pkp.controllers.grid.CategoryGridHandler=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.CategoryGridHandler,a.pkp.controllers.grid.GridHandler);a.pkp.controllers.grid.CategoryGridHandler.prototype.getCategoryIdPrefix=function(){return this.getGridIdPrefix()+"-category-"};a.pkp.controllers.grid.CategoryGridHandler.prototype.getCategories=function(){return a(".category_grid_body:not(.empty)",this.getHtmlElement())};a.pkp.controllers.grid.CategoryGridHandler.prototype.getCategoryByDataId=
function(c){return a("#"+this.getCategoryIdPrefix()+c)};a.pkp.controllers.grid.CategoryGridHandler.prototype.getCategoryRow=function(c){var b=this.getHtmlElement();void 0!==c&&(b=c);return a("tr.category",b)};a.pkp.controllers.grid.CategoryGridHandler.prototype.getRowsInCategory=function(c){return a("tr.gridRow",c).not(".category")};a.pkp.controllers.grid.CategoryGridHandler.prototype.getCategoryEmptyPlaceholder=function(c){c="#"+c.attr("id")+"-emptyPlaceholder";return a(c,this.getHtmlElement())};
a.pkp.controllers.grid.CategoryGridHandler.prototype.getCategoryDataId=function(a){var a=a.attr("id"),b=this.getCategoryIdPrefix().length;return a.slice(b)};a.pkp.controllers.grid.CategoryGridHandler.prototype.getCategoryDataIdByRowId=function(c){c=c.replace(this.getCategoryIdPrefix()," ");c=c.match("(.*)-row");return a.trim(c[1])};a.pkp.controllers.grid.CategoryGridHandler.prototype.appendCategory=function(a){this.getHtmlElement().find(this.bodySelector).append(a)};a.pkp.controllers.grid.CategoryGridHandler.prototype.resequenceCategories=
function(c){var b,d;for(d in c)b=c[d],b=a("#"+b),this.appendCategory(b);this.updateEmptyPlaceholderPosition()};a.pkp.controllers.grid.CategoryGridHandler.prototype.updateEmptyPlaceholderPosition=function(){var c=this.getCategories(),b,d,e,f;b=0;for(d=c.length;b<d;b++)e=a(c[b]),f=this.getCategoryEmptyPlaceholder(e),0<f.length&&f.insertAfter(e)};a.pkp.controllers.grid.CategoryGridHandler.prototype.initialize=function(a){this.fetchCategoryUrl_=a.fetchCategoryUrl;this.parent("initialize",a)};a.pkp.controllers.grid.CategoryGridHandler.prototype.getElementsByType=
function(a){return a.hasClass("category_grid_body")?this.getCategories():this.parent("getElementsByType",a)};a.pkp.controllers.grid.CategoryGridHandler.prototype.getEmptyElement=function(a){return a.hasClass("category_grid_body")?this.getHtmlElement().find(".empty").not(".category_placeholder"):this.parent("getEmptyElement",a)};a.pkp.controllers.grid.CategoryGridHandler.prototype.refreshGridHandler=function(c,b,d){var e=!1;void 0!==d&&(void 0!==d.parentElementId?(e={rowId:d[0],rowCategoryId:d.parentElementId},
this.currentCategoryId_=d.parentElementId,a.get(this.fetchRowUrl,e,this.callbackWrapper(this.replaceElementResponseHandler),"json")):a.get(this.fetchCategoryUrl_,{rowId:d},this.callbackWrapper(this.replaceElementResponseHandler),"json"),e=!0);this.parent("refreshGridHandler",c,b,d,e)};a.pkp.controllers.grid.CategoryGridHandler.prototype.deleteElement=function(c){var b,d,e,f;if(1<c.length&&(2==c.length&&(c.hasClass("category_grid_body")&&c.hasClass("category"))&&(c=c.filter(".category_grid_body")),
this.currentCategoryId_)){b=this.getCategoryByDataId(this.currentCategoryId_);d=0;for(e=c.length;d<e;d++)if(f=a(c[d]).parents("#"+b.attr("id")),1===f.length){c=a(c[d]);break}}c.hasClass("category_grid_body")&&(b=this.getCategoryEmptyPlaceholder(c),b.remove());this.parent("deleteElement",c)};a.pkp.controllers.grid.CategoryGridHandler.prototype.addElement=function(a){var b=null;a.hasClass("gridRow")&&(b=this.getCategoryDataIdByRowId(a.attr("id")),b=this.getCategoryByDataId(b));this.parent("addElement",
a,b);a.hasClass("category_grid_body")&&(a=this.getEmptyElement(a),this.getHtmlElement().find(this.bodySelector).append(a))};a.pkp.controllers.grid.CategoryGridHandler.prototype.replaceElement=function(a,b){b.hasClass("category_grid_body")&&this.getCategoryEmptyPlaceholder(a).remove();this.parent("replaceElement",a,b)};a.pkp.controllers.grid.CategoryGridHandler.prototype.hasSameNumOfColumns=function(a){var b=a,d=!1;a.hasClass("category_grid_body")&&(b=a.find("tr"),d=!0);return this.parent("hasSameNumOfColumns",
b,d)}})(jQuery);(function(a){a.pkp.controllers.listbuilder=a.pkp.controllers.listbuilder||{};a.pkp.controllers.listbuilder.ListbuilderHandler=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.controllers.listbuilder.ListbuilderHandler,a.pkp.controllers.grid.GridHandler);a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.sourceType_=null;a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.saveUrl_=null;a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.saveFieldName_=null;
a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.fetchOptionsUrl_=null;a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.editItemCallingContext_=null;a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.initialize=function(a){this.parent("initialize",a);this.sourceType_=a.sourceType;this.saveUrl_=a.saveUrl;this.saveFieldName_=a.saveFieldName;this.fetchOptionsUrl_=a.fetchOptionsUrl;a=this.getHtmlElement();a.find('span[class="options"] > a[id*="addItem"]').mousedown(this.callbackWrapper(this.addItemHandler_));
this.attachContentHandlers_(a);this.bind("formSubmitRequested",this.formSubmitHandler_);this.bind("formSubmitted",this.formSubmittedHandler_)};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.getSaveUrl_=function(){return this.saveUrl_};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.getSaveFieldName_=function(){return this.saveFieldName_};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.closeEdits=function(){var a=this.getHtmlElement().find(".gridRowEdit:visible");
0!==a.length&&(this.saveRow(a),a.removeClass("gridRowEdit"))};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.save=function(){var c=this.getHtmlElement().find("input.deletions").val(),b=[],d,e,f=this;this.getHtmlElement().find('.gridRow input.isModified[value="1"]').each(function(c,d){var e=a(d).parents(".gridRow"),e=f.buildParamsFromInputs_(e.find(":input"));b.push(e)});d=this.getRows().length;c=JSON.stringify({deletions:c,changes:b,numberOfRows:d});(d=this.getSaveUrl_())?a.post(d,{data:c},
this.callbackWrapper(this.saveResponseHandler_,null),"json"):(e=this.getSaveFieldName_(),d=this.getHtmlElement().find(":input[type=hidden]").filter(function(){return a(this).attr("name")==e}).first(),0===d.length&&(d=a('<input type="hidden" />'),d.attr("name",e),this.getHtmlElement().append(d)),d.attr("value",c))};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.saveRow=function(c){c.addClass("saveRowResponsePlaceholder");c=this.buildParamsFromInputs_(c.find(":input"));c.modify=!0;this.disableControls();
a.ajax({url:this.getFetchRowUrl(),data:c,success:this.callbackWrapper(this.saveRowResponseHandler_,null),dataType:"json",async:!1})};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.getEmptyElement=function(){return this.getHtmlElement().find(".empty")};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.addItemHandler_=function(){setTimeout(this.callbackWrapper(function(){this.closeEdits();this.disableControls();a.get(this.getFetchRowUrl(),{modify:!0},this.callbackWrapper(this.appendRowResponseHandler_,
null),"json")}),0);return!1};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.deleteItemHandler_=function(c){this.closeEdits();var b=a(c),c=b.closest(".gridRow"),b=b.closest(".pkp_controllers_listbuilder").find(".deletions"),d=c.find('input[name="rowId"]').val();void 0!==d&&b.val(b.val()+" "+d);this.deleteElement(c);return!1};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.appendRowResponseHandler_=function(c,b){var d=this.handleJson(b);!1!==d&&(d=a(d.content),this.getHtmlElement().find(".empty").hide().before(d),
this.attachContentHandlers_(d),d.addClass("gridRowEdit"),d.find(":input").not('[type="hidden"]').first().focus(),this.sourceType_==a.pkp.cons.LISTBUILDER_SOURCE_TYPE_SELECT?(this.disableControls(),a.get(this.fetchOptionsUrl_,{},this.callbackWrapper(this.fetchOptionsResponseHandler_,null),"json")):this.enableControls(),this.callFeaturesHook("addElement",d));return!1};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.fetchOptionsResponseHandler_=function(c,b){var d=this.handleJson(b),e=this.getHtmlElement(),
f=[],i,g,h,j,k,l,p,m,q,s;if(!1!==d){e.find(".gridCellDisplay :input").each(function(c,b){f[c]=a(b).val()});e=e.find(".gridRowEdit:visible .selectMenu:input");i=0;for(g=e.length;i<g;i++){h=a(e[i]);j=h.parents(".gridCellContainer");k=0;h.children().empty();l=null;for(l in d.content[i])if(l!=a.pkp.cons.LISTBUILDER_OPTGROUP_LABEL)if("object"==typeof d.content[i][l]){if(void 0!==d.content[i][a.pkp.cons.LISTBUILDER_OPTGROUP_LABEL]&&"object"==typeof d.content[i][a.pkp.cons.LISTBUILDER_OPTGROUP_LABEL]&&(m=
d.content[i][a.pkp.cons.LISTBUILDER_OPTGROUP_LABEL][l])){q=a("<optgroup></optgroup>");q.attr("label",m);h.append(q);m=null;s=0;for(m in d.content[i][l])if(p=this.populatePulldown_(q,f,d.content[i][l][m],m))k++,s++;0===s&&q.remove()}}else(p=this.populatePulldown_(h,f,d.content[i][l],l))&&k++;h=p;1===k&&h&&h.attr("selected","selected");0===k&&(j.find(".gridCellDisplay").show(),j.find(".gridCellEdit").hide())}}this.enableControls();return!1};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.populatePulldown_=
function(c,b,d,e){var f=c.parents(".gridCellContainer").find(".gridCellDisplay :input").val(),i=!1,g;if(e!=f)for(g=0;g<b.length;g++)b[g]==e&&(i=!0);if(i)return!1;b=a("<option/>");b.attr("value",e);b.text(d);e==f&&b.attr("selected","selected");c.append(b);return b};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.editItemHandler_=function(c){this.closeEdits();this.editItemCallingContext_=c;setTimeout(this.callbackWrapper(function(){var c=a(this.editItemCallingContext_).closest(".gridRow");
c.addClass("gridRowEdit");c.find(":input").not('[type="hidden"]').first().focus();this.sourceType_==a.pkp.cons.LISTBUILDER_SOURCE_TYPE_SELECT&&(this.disableControls(),a.get(this.fetchOptionsUrl_,{},this.callbackWrapper(this.fetchOptionsResponseHandler_,null),"json"))}),0);return!1};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.buildParamsFromInputs_=function(c){var b={};a.each(c.serializeArray(),function(c,e){var f=e.name,i=e.value;b[f]=void 0===b[f]?i:a.isArray(b[f])?b[f].concat(i):
[b[f],i]});return b};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.inputKeystrokeHandler_=function(c,b){var d,e,f;return 13==b.which?(d=a(c),e=d.parents(".gridRow"),f=e.find(":input:visible"),d=f.index(d),f.length==d+1?this.saveRow(e):f[d+1].focus(),!1):!0};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.inputBlurHandler_=function(c){a(c).closest(".gridRow").addClass("editingRowPlaceholder");setTimeout(this.callbackWrapper(function(){var c=a(".editingRowPlaceholder"),d=!1;
c.find(":input").each(function(a,c){c===document.activeElement&&(d=!0)});c.removeClass("editingRowPlaceholder");d||this.closeEdits()}),0);return!0};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.saveRowResponseHandler_=function(c,b){var d=this.handleJson(b),e;!1!==d&&(d=a(d.content),e=this.getHtmlElement().find(".saveRowResponsePlaceholder").attr("id"),this.getHtmlElement().find(".saveRowResponsePlaceholder").replaceWith(d),d.attr("id",e),this.attachContentHandlers_(d),this.callFeaturesHook("replaceElement",
d));this.enableControls()};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.saveResponseHandler_=function(){};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.attachContentHandlers_=function(a){a.find(".gridCellDisplay").click(this.callbackWrapper(this.editItemHandler_));a.find(":input").keypress(this.callbackWrapper(this.inputKeystrokeHandler_)).blur(this.callbackWrapper(this.inputBlurHandler_));a.find(".remove_item").click(this.callbackWrapper(this.deleteItemHandler_))};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.formSubmitHandler_=
function(){this.save();this.getHtmlElement().find(".gridRow :input").attr("disabled","disabled");return!0};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.formSubmittedHandler_=function(){this.getHtmlElement().find(".gridRow :input").removeAttr("disabled")};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.disableControls=function(){this.getHtmlElement().find('span[class="options"] > a[id*="addItem"]').unbind("mousedown");this.getHtmlElement().find('span[class="options"] > a[id*="addItem"]').mousedown(function(){return!1});
this.getHtmlElement().find(".h3").addClass("spinner")};a.pkp.controllers.listbuilder.ListbuilderHandler.prototype.enableControls=function(){this.getHtmlElement().find('span[class="options"] > a[id*="addItem"]').mousedown(this.callbackWrapper(this.addItemHandler_));this.getHtmlElement().find(".h3").removeClass("spinner")}})(jQuery);(function(a){a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler,a.pkp.controllers.listbuilder.ListbuilderHandler);a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.$lists_=null;a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.getRowsByList=function(a){return a.find(".gridRow")};a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.getLists=
function(){return this.$lists_};a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.setLists=function(c){jQuery();var b,d;if(!a.isArray(c))throw Error("Lists id must be passed using an array object!");for(b in c)d=this.getListById(c[b]),this.$lists_=this.$lists_?this.$lists_.add(d):d};a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.getListById=function(c){c=this.getGridIdPrefix()+"-table-"+c;return a("#"+c,this.getHtmlElement())};a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.getListByRow=
function(a){return a.parents("table:first")};a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.getListIdByRow=function(a){a=this.getListByRow(a);return this.getListId(a)};a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.getListId=function(a){var b=this.getGridIdPrefix()+"-table-";return a.attr("id").slice(b.length)};a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.getListNoItemsRow=function(a){return a.find("tr.empty")};a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.initialize=
function(a){this.parent("initialize",a);this.setLists(a.listsId)};a.pkp.controllers.listbuilder.MultipleListsListbuilderHandler.prototype.toggleListNoItemsRow=function(a,b,d){var e=this.getListNoItemsRow(a),f=this.getRowsByList(a);d&&(f=f.not(d));f.length==b?(e.detach(),a.append(e),e.show()):(e.detach(),a.append(e),e.hide())}})(jQuery);(function(a){a.pkp.controllers.modal=a.pkp.controllers.modal||{};a.pkp.controllers.modal.ModalHandler=function(c,b){this.parent(c,b);if(!this.checkOptions(b))throw Error("Missing or invalid modal options!");var d=a.extend(!0,{},b),d=this.mergeOptions(d);c.dialog(d);this.fixTitleBar_(c,d);this.fixCloseButton_(c,d);400>c.width()&&c.dialog("option","width","400");710<c.width()&&c.dialog("option","width","710");c.dialog("option","position",["center",100]);this.bind("dialogclose",this.dialogClose);this.publishEvent("redirectRequested");
this.publishEvent("dataChanged");this.publishEvent("containerReloadRequested");this.publishEvent("modalCanceled");this.publishEvent("updateHeader");this.publishEvent("updateSidebar");this.bind("notifyUser",this.redirectNotifyUserEventHandler_);c.parent().next(".ui-widget-overlay").click(this.callbackWrapper(this.outsideClick))};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.ModalHandler,a.pkp.classes.Handler);a.pkp.controllers.modal.ModalHandler.DEFAULT_OPTIONS_={autoOpen:!0,width:710,modal:!0,
draggable:!1,resizable:!1,position:["center",100]};a.pkp.controllers.modal.ModalHandler.prototype.checkOptions=function(a){return"object"===typeof a&&void 0===a.buttons};a.pkp.controllers.modal.ModalHandler.prototype.mergeOptions=function(c){return a.extend(!0,{},this.self("DEFAULT_OPTIONS_"),c)};a.pkp.controllers.modal.ModalHandler.prototype.modalClose=function(c,b){b&&"cancelFormButton"==b.currentTarget.id&&this.trigger("modalCanceled");var d=this.getHtmlElement(),e=d.find("form").first();if(1==
e.length&&(e.find(".hasDatepicker").datepicker("hide"),e=a.pkp.classes.Handler.getHandler(a("#"+e.attr("id"))),e.formChangesTracked))if(confirm(a.pkp.locale.form_dataHasChanged))this.trigger("unregisterAllForms");else return!1;d.dialog("close");return!1};a.pkp.controllers.modal.ModalHandler.prototype.dialogClose=function(c){a(c).dialog("destroy");this.getHtmlElement().empty();this.remove()};a.pkp.controllers.modal.ModalHandler.prototype.outsideClick=function(a,b){this.modalClose(a,b)};a.pkp.controllers.modal.ModalHandler.prototype.fixTitleBar_=
function(c,b){var d=a('<div class="pkp_controllers_modal_titleBar"></div>'),e,f=b.title||null,i=b.titleIcon||"";e=a('<a class="close ui-corner-all" href="#"><span class="xIcon">close</span></a>"');e.click(this.callbackWrapper(this.modalClose));d.append(e);f&&d.append(['<div class="large_sprite modal_title '+i+'"></div><h2>',f,"</h2>"].join(""));d.append(a('<span style="clear:both" />'));c.parent().find(".ui-dialog-titlebar").replaceWith(d)};a.pkp.controllers.modal.ModalHandler.prototype.fixCloseButton_=
function(c){var b=a('<a id="cancelFormButton" class="cancelFormButton" href="#">Cancel</a>'),c=c.parent();c.find(".ui-dialog-buttonset").css({width:"90%",padding:"10px 20px"});c.find(".ui-dialog-buttonset button:first").css({"float":"right",margin:"0px"});c.find(".ui-dialog-buttonset button:last").replaceWith(b);c.find(".cancelFormButton").bind("click",this.callbackWrapper(this.modalClose))};a.pkp.controllers.modal.ModalHandler.prototype.redirectNotifyUserEventHandler_=function(c,b,d){a.pkp.classes.notification.NotificationHelper.redirectNotifyUserEvent(this,
d)}})(jQuery);(function(a){a.pkp.controllers.modal.ConfirmationModalHandler=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.ConfirmationModalHandler,a.pkp.controllers.modal.ModalHandler);a.pkp.controllers.modal.ConfirmationModalHandler.prototype.checkOptions=function(a){return!this.parent("checkOptions",a)?!1:"string"===typeof a.okButton&&(!1===a.cancelButton||"string"===typeof a.cancelButton)&&"string"===typeof a.dialogText};a.pkp.controllers.modal.ConfirmationModalHandler.prototype.mergeOptions=
function(a){var b=this.parent("mergeOptions",a);b.buttons={};b.buttons[a.okButton]=this.callbackWrapper(this.modalConfirm);delete a.okButton;a.cancelButton&&(b.buttons[a.cancelButton]=this.callbackWrapper(this.modalClose),delete a.cancelButton);this.getHtmlElement().html(b.dialogText);delete b.dialogText;return b};a.pkp.controllers.modal.ConfirmationModalHandler.prototype.modalConfirm=function(a){this.modalClose(a)}})(jQuery);(function(a){a.pkp.controllers.modal.RedirectConfirmationModalHandler=function(a,b){this.parent(a,b);this.remoteUrl_=b.remoteUrl};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.RedirectConfirmationModalHandler,a.pkp.controllers.modal.ConfirmationModalHandler);a.pkp.controllers.modal.RedirectConfirmationModalHandler.prototype.remoteUrl_=null;a.pkp.controllers.modal.RedirectConfirmationModalHandler.prototype.checkOptions=function(a){return!this.parent("checkOptions",a)?!1:"string"===typeof a.cancelButton&&
"string"===typeof a.remoteUrl};a.pkp.controllers.modal.RedirectConfirmationModalHandler.prototype.modalConfirm=function(){document.location=this.remoteUrl_}})(jQuery);(function(a){a.pkp.controllers.modal.RemoteActionConfirmationModalHandler=function(a,b){this.parent(a,b);this.remoteAction_=b.remoteAction};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.RemoteActionConfirmationModalHandler,a.pkp.controllers.modal.ConfirmationModalHandler);a.pkp.controllers.modal.RemoteActionConfirmationModalHandler.prototype.remoteAction_=null;a.pkp.controllers.modal.RemoteActionConfirmationModalHandler.prototype.checkOptions=function(a){return!this.parent("checkOptions",
a)?!1:"string"===typeof a.cancelButton&&"string"===typeof a.remoteAction};a.pkp.controllers.modal.RemoteActionConfirmationModalHandler.prototype.modalConfirm=function(){a.post(this.remoteAction_,this.callbackWrapper(this.remoteResponse),"json")};a.pkp.controllers.modal.RemoteActionConfirmationModalHandler.prototype.remoteResponse=function(a,b){!1!==this.parent("remoteResponse",a,b)&&this.modalClose(a);return!1}})(jQuery);(function(a){a.pkp.controllers.modal.CallbackConfirmationModalHandler=function(a,b){this.parent(a,b);this.confirmationCallback_=b.confirmationCallback};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.CallbackConfirmationModalHandler,a.pkp.controllers.modal.ConfirmationModalHandler);a.pkp.controllers.modal.CallbackConfirmationModalHandler.prototype.confirmationCallback_=null;a.pkp.controllers.modal.CallbackConfirmationModalHandler.prototype.triggerCallbackOnClose_=!1;a.pkp.controllers.modal.CallbackConfirmationModalHandler.prototype.checkOptions=
function(c){return!this.parent("checkOptions",c)?!1:a.isFunction(c.confirmationCallback)};a.pkp.controllers.modal.CallbackConfirmationModalHandler.prototype.modalConfirm=function(a){this.triggerCallbackOnClose_=!0;this.modalClose(a)};a.pkp.controllers.modal.CallbackConfirmationModalHandler.prototype.dialogClose=function(a){!0===this.triggerCallbackOnClose_&&(this.triggerCallbackOnClose_=!1,this.confirmationCallback_());this.parent("dialogClose",a)}})(jQuery);(function(a){a.pkp.controllers.modal.ButtonConfirmationModalHandler=function(a,b){b.confirmationCallback=this.callbackWrapper(this.clickButton);this.parent(a,b);this.$button_=b.$button};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.ButtonConfirmationModalHandler,a.pkp.controllers.modal.CallbackConfirmationModalHandler);a.pkp.controllers.modal.CallbackConfirmationModalHandler.prototype.$button_=null;a.pkp.controllers.modal.ButtonConfirmationModalHandler.prototype.clickButton=function(){var a=
this.$button_;"submit"==a.attr("type")?a.trigger("submit"):a.click()}})(jQuery);(function(a){a.pkp.controllers.modal.JsEventConfirmationModalHandler=function(a,b){this.parent(a,b);this.jsEvent_=b.jsEvent;this.extraArguments_=b.extraArguments};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.JsEventConfirmationModalHandler,a.pkp.controllers.modal.ConfirmationModalHandler);a.pkp.controllers.modal.JsEventConfirmationModalHandler.prototype.jsEvent_=null;a.pkp.controllers.modal.JsEventConfirmationModalHandler.prototype.extraArguments_=null;a.pkp.controllers.modal.JsEventConfirmationModalHandler.prototype.checkOptions=
function(a){return!this.parent("checkOptions",a)?!1:"string"===typeof a.cancelButton&&"string"===typeof a.jsEvent};a.pkp.controllers.modal.JsEventConfirmationModalHandler.prototype.modalConfirm=function(a){this.trigger(this.jsEvent_,this.extraArguments_);this.modalClose(a)}})(jQuery);(function(a){a.pkp.controllers.modal.AjaxModalHandler=function(a,b){this.parent(a,b);this.bind("formSubmitted",this.modalClose);this.bind("formCanceled",this.modalClose);this.bind("ajaxHtmlError",this.modalClose)};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.AjaxModalHandler,a.pkp.controllers.modal.ModalHandler);a.pkp.controllers.modal.AjaxModalHandler.prototype.checkOptions=function(a){return!this.parent("checkOptions",a)?!1:"string"===typeof a.url};a.pkp.controllers.modal.AjaxModalHandler.prototype.mergeOptions=
function(a){this.bind("dialogopen",this.dialogOpen);return this.parent("mergeOptions",a)};a.pkp.controllers.modal.AjaxModalHandler.prototype.modalClose=function(a,b){"formSubmitted"==b.type&&this.getHtmlElement().parent().trigger("notifyUser");return this.parent("modalClose")};a.pkp.controllers.modal.AjaxModalHandler.prototype.dialogOpen=function(c){var c=a(c),b;c.css({"max-height":600,"overflow-y":"auto","z-index":"10000"});b=c.dialog("option","url");c.pkpAjaxHtml(b)}})(jQuery);(function(a){a.pkp.controllers.modal.AjaxLegacyPluginModalHandler=function(a,b){this.parent(a,b);this.bind("refreshLegacyPluginModal",this.callbackWrapper(this.refreshModalHandler_))};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.AjaxLegacyPluginModalHandler,a.pkp.controllers.modal.AjaxModalHandler);a.pkp.controllers.modal.AjaxLegacyPluginModalHandler.prototype.url_=null;a.pkp.controllers.modal.AjaxLegacyPluginModalHandler.prototype.dialogOpen=function(c){var c=a(c),b,d;c.css({"max-height":600,
"overflow-y":"auto","z-index":"10000"});this.url_=b=c.dialog("option","url");d=this.callbackWrapper(this.refreshModalCallback_);c.pkpAjaxHtml(b,d)};a.pkp.controllers.modal.AjaxLegacyPluginModalHandler.prototype.refreshModal_=function(c,b,d){var e=a(this.getHtmlElement());c?(this.url_=c,b=this.callbackWrapper(this.handleResponse_),d?(d=a("form",this.getHtmlElement()),a.post(c,d.serialize(),b,"json")):a.getJSON(c,b)):b&&(e.html(b),this.refreshModalCallback_())};a.pkp.controllers.modal.AjaxLegacyPluginModalHandler.prototype.refreshModalCallback_=
function(){var c=this.getHtmlElement(),b=a("h2",c),d,e,f,i;0<b.length&&(d=c.parent().find(".pkp_controllers_modal_titleBar h2"),d.replaceWith(b));c.addClass("legacy_plugin_content");b=a(":submit, :button, :reset");0<b.length&&b.button();b=a(".menu",c);0<b.length&&(d=a.extend(!0,{},b),e=a('<div class="menu"></div>'),b.replaceWith(e),b=a(".menu"),b.append(d),b.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),b.children().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),
b.children().children().addClass("ui-state-default ui-corner-top"),b.children().find(".current").addClass("ui-tabs-selected ui-state-active"));b=a("a",this.getHtmlElement());f=this.callbackWrapper(this.clickLinkHandler_);i=this.callbackWrapper(this.bindClickEvent_);b.each(function(a,c){i(c,f)});b=a("form.pkp_form",c);0<b.length&&(b.bind("submit",this.callbackWrapper(this.submitFormHandler_)),b.find("#cancelFormButton").unbind("click"),b.find("#cancelFormButton").bind("click",this.callbackWrapper(this.modalClose)));
c.scrollTop(0);b=this.url_;b.match("#")&&(b=b.split("#")[1],c.scrollTop(a('a[name="'+b+'"]').position().top));this.trigger("notifyUser",[this.getHtmlElement()])};a.pkp.controllers.modal.AjaxLegacyPluginModalHandler.prototype.refreshModalHandler_=function(c,b,d,e){e&&(0<a("form",this.getHtmlElement()).length?this.refreshModal_(e,null,!0):this.refreshModal_(e))};a.pkp.controllers.modal.AjaxLegacyPluginModalHandler.prototype.bindClickEvent_=function(c,b,d){var c=a(b),e;c.attr("onclick")?(e=c.attr("onclick"),
c.removeAttr("onclick"),c.bind("click",function(a){d(a,e)})):c.bind("click",d)};a.pkp.controllers.modal.AjaxLegacyPluginModalHandler.prototype.clickLinkHandler_=function(c,b,d){b.preventDefault();if(d&&!1===d.apply(b.target))return!1;c=a(b.target);c.unbind("click");c=c.attr("href");this.refreshModal_(c);return!0};a.pkp.controllers.modal.AjaxLegacyPluginModalHandler.prototype.submitFormHandler_=function(c){c=a(c);c.unbind("submit");c=c.attr("action");this.refreshModal_(c,null,!0);return!1};a.pkp.controllers.modal.AjaxLegacyPluginModalHandler.prototype.handleResponse_=
function(a,b){var d=this.handleJson(b);!1!==d&&(""!==d.content?this.refreshModal_(null,d.content):d.status&&"dataChanged"===d.event.name&&this.trigger("formSubmitted"))}})(jQuery);(function(a){a.pkp.controllers.modal.WizardModalHandler=function(a,b){this.parent(a,b);this.bind("wizardClose",this.wizardClose);this.bind("wizardCancel",this.wizardClose)};a.pkp.classes.Helper.inherits(a.pkp.controllers.modal.WizardModalHandler,a.pkp.controllers.modal.AjaxModalHandler);a.pkp.controllers.modal.WizardModalHandler.prototype.modalClose=function(c,b,d){d?this.parent("modalClose",c,b):(d=new a.Event("wizardCancelRequested"),d.stopPropagation(),this.getHtmlElement().children().first().trigger(d),
d.isDefaultPrevented()||this.parent("modalClose",c,b));return!1};a.pkp.controllers.modal.WizardModalHandler.prototype.wizardClose=function(a,b){this.modalClose(a,b,!0)}})(jQuery);(function(a){a.pkp.controllers.modals=a.pkp.controllers.modals||{editorDecision:{form:{}}};a.pkp.controllers.modals.editorDecision.form.EditorDecisionFormHandler=function(c,b){this.parent(c,b);this.peerReviewUrl_=b.peerReviewUrl;a("#importPeerReviews",c).click(this.callbackWrapper(this.importPeerReviews))};a.pkp.classes.Helper.inherits(a.pkp.controllers.modals.editorDecision.form.EditorDecisionFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.modals.editorDecision.form.EditorDecisionFormHandler.peerReviewUrl_=
null;a.pkp.controllers.modals.editorDecision.form.EditorDecisionFormHandler.prototype.importPeerReviews=function(){a.getJSON(this.peerReviewUrl_,this.callbackWrapper(this.insertPeerReviews));return!1};a.pkp.controllers.modals.editorDecision.form.EditorDecisionFormHandler.prototype.insertPeerReviews=function(c,b){var d=this.handleJson(b),e=this.getHtmlElement(),f;!1!==d&&(e=a('textarea[id^="personalMessage"]',e),f=e.val(),f.match(/__________/)?e.val(f.replace(/__________/,d.content+"__________")):
e.val(f+d.content))}})(jQuery);(function(a){jQuery.pkp.controllers.linkAction=jQuery.pkp.controllers.linkAction||{};a.pkp.controllers.linkAction.LinkActionHandler=function(c,b){this.parent(c,b);this.staticId_=b.staticId?b.staticId:c.attr("id");if(!b.actionRequest||!b.actionRequestOptions)throw Error('The "actionRequest" and "actionRequestOptions"settings are required in a LinkActionHandler');c.hasClass("image")&&this.bind("mouseover",this.imagePreviewHandler_);b.actionRequestOptions.finishCallback=this.callbackWrapper(this.enableLink);
this.linkActionRequest_=a.pkp.classes.Helper.objectFactory(b.actionRequest,[c,b.actionRequestOptions]);this.bindActionRequest();this.publishEvent("dataChanged");this.bind("dataChanged",this.dataChangedHandler_);this.bind("modalCanceled",this.removeDisabledCssClass_);b.selfActivate&&this.trigger("click")};a.pkp.classes.Helper.inherits(a.pkp.controllers.linkAction.LinkActionHandler,a.pkp.classes.Handler);a.pkp.controllers.linkAction.LinkActionHandler.prototype.linkActionRequest_=null;a.pkp.controllers.linkAction.LinkActionHandler.prototype.staticId_=
null;a.pkp.controllers.linkAction.LinkActionHandler.prototype.getStaticId=function(){return this.staticId_};a.pkp.controllers.linkAction.LinkActionHandler.prototype.getUrl=function(){return this.linkActionRequest_.getUrl()};a.pkp.controllers.linkAction.LinkActionHandler.prototype.imagePreviewHandler_=function(c){a(c).imgPreview({preloadImages:!1,imgCSS:{width:"300px"}})};a.pkp.controllers.linkAction.LinkActionHandler.prototype.activateAction=function(a,b){"$.pkp.classes.linkAction.NullAction"!=this.linkActionRequest_.getObjectName()&&
this.disableLink();return this.linkActionRequest_.activate.call(this.linkActionRequest_,a,b)};a.pkp.controllers.linkAction.LinkActionHandler.prototype.bindActionRequest=function(){this.bind("click",this.activateAction)};a.pkp.controllers.linkAction.LinkActionHandler.prototype.enableLink=function(){var c,b;c=a(this.getHtmlElement());this.getHtmlElement().is(":submit")||this.removeDisabledCssClass_();b=this.getUrl();this.getHtmlElement().is("a")&&b&&c.attr("href",b);this.unbind("click",this.noAction_);
this.bindActionRequest()};a.pkp.controllers.linkAction.LinkActionHandler.prototype.disableLink=function(){var c=a(this.getHtmlElement());c.addClass("ui-state-disabled");this.getHtmlElement().is("a")&&c.attr("href","#");this.unbind("click",this.activateAction);this.bind("click",this.noAction_)};a.pkp.controllers.linkAction.LinkActionHandler.prototype.removeDisabledCssClass_=function(){a(this.getHtmlElement()).removeClass("ui-state-disabled")};a.pkp.controllers.linkAction.LinkActionHandler.prototype.dataChangedHandler_=
function(a,b,d){0===this.getHtmlElement().parents(".pkp_controllers_grid").length&&this.trigger("redirectDataChangedToGrid",[d]);this.trigger("notifyUser",[this.getHtmlElement()])};a.pkp.controllers.linkAction.LinkActionHandler.prototype.noAction_=function(){return!1}})(jQuery);(function(a){a.pkp.controllers.wizard=a.pkp.controllers.wizard||{};a.pkp.controllers.wizard.WizardHandler=function(a,b){b.notScrollable=!0;this.parent(a,b);this.startWizard();this.addWizardButtons_(a,b);this.bindWizardEvents();this.bind("formValid",this.formValid);this.bind("formInvalid",this.formInvalid);this.bind("formSubmitted",this.formSubmitted)};a.pkp.classes.Helper.inherits(a.pkp.controllers.wizard.WizardHandler,a.pkp.controllers.TabHandler);a.pkp.controllers.wizard.WizardHandler.prototype.$continueButton_=
null;a.pkp.controllers.wizard.WizardHandler.prototype.$progressIndicator_=null;a.pkp.controllers.wizard.WizardHandler.prototype.continueButtonText_=null;a.pkp.controllers.wizard.WizardHandler.prototype.finishButtonText_=null;a.pkp.controllers.wizard.WizardHandler.prototype.continueRequest=function(){var c=new a.Event("wizardAdvanceRequested");this.getCurrentTab().children().first().trigger(c);c.isDefaultPrevented()||this.advanceOrClose_();return!1};a.pkp.controllers.wizard.WizardHandler.prototype.formValid=
function(){this.getContinueButton().button("enable")};a.pkp.controllers.wizard.WizardHandler.prototype.formInvalid=function(){this.getContinueButton().button("disable")};a.pkp.controllers.wizard.WizardHandler.prototype.formSubmitted=function(){this.advanceOrClose_()};a.pkp.controllers.wizard.WizardHandler.prototype.cancelRequest=function(){this.checkForm_(!1);var c=new a.Event("wizardCancelRequested");this.getCurrentTab().children().first().trigger(c);c.isDefaultPrevented()||this.trigger("wizardCancel");
return!1};a.pkp.controllers.wizard.WizardHandler.prototype.wizardCancelRequested=function(){return this.checkForm_(!0)?!1:!0};a.pkp.controllers.wizard.WizardHandler.prototype.wizardAdvanceRequested=function(a,b){var d=this.getForm_();d&&(d.submit()&&(this.getContinueButton().button("disable"),this.getProgressIndicator().show()),b.preventDefault())};a.pkp.controllers.wizard.WizardHandler.prototype.wizardAdvance=function(){var a=this.getCurrentStep(),b=this.getNumberOfSteps()-1,d=a+1,e;if(d>b)throw Error("Trying to set an invalid wizard step!");
e=this.getHtmlElement();e.tabs("enable",d);e.tabs("select",d);e.tabs("disable",a);a=this.getContinueButton();d===b&&a.button("option","label",this.getFinishButtonText());this.getProgressIndicator().hide();a.button("enable")};a.pkp.controllers.wizard.WizardHandler.prototype.startWizard=function(){var a=this.getHtmlElement(),b,d;0!==this.getCurrentStep()&&(a.tabs("enable",0),a.tabs("select",0),b=this.getContinueButton(),b.button("option","label",this.getContinueButtonText()));b=[];for(d=1;d<this.getNumberOfSteps();d++)b.push(d);
a.tabs("option","disabled",b)};a.pkp.controllers.wizard.WizardHandler.prototype.bindWizardEvents=function(){this.bind("wizardCancelRequested",this.wizardCancelRequested);this.bind("wizardAdvanceRequested",this.wizardAdvanceRequested);this.bind("wizardAdvance",this.wizardAdvance)};a.pkp.controllers.wizard.WizardHandler.prototype.getCurrentStep=function(){return this.getCurrentTabIndex()};a.pkp.controllers.wizard.WizardHandler.prototype.getContinueButton=function(){return this.$continueButton_};a.pkp.controllers.wizard.WizardHandler.prototype.getProgressIndicator=
function(){return this.$progressIndicator_};a.pkp.controllers.wizard.WizardHandler.prototype.getContinueButtonText=function(){return this.continueButtonText_};a.pkp.controllers.wizard.WizardHandler.prototype.getFinishButtonText=function(){return this.finishButtonText_};a.pkp.controllers.wizard.WizardHandler.prototype.getNumberOfSteps=function(){return this.getHtmlElement().find("ul").first().children().length};a.pkp.controllers.wizard.WizardHandler.prototype.getForm_=function(){var a=this.getCurrentTab().children().first();
return a.is("form")?a:null};a.pkp.controllers.wizard.WizardHandler.prototype.advanceOrClose_=function(){var a=this.getCurrentStep(),b=this.getNumberOfSteps()-1;a<b?this.trigger("wizardAdvance"):this.trigger("wizardClose")};a.pkp.controllers.wizard.WizardHandler.prototype.checkForm_=function(c){var b=this.getForm_();if(null!==b)if(b=a.pkp.classes.Handler.getHandler(a("#"+b.attr("id"))),c){if(b.formChangesTracked)if(confirm(a.pkp.locale.form_dataHasChanged))b.unregisterForm();else return!0}else b.unregisterForm();
return!1};a.pkp.controllers.wizard.WizardHandler.prototype.addWizardButtons_=function(c,b){var d=a('<div id="wizardButtons" class="modal-buttons"></div>'),e,f;b.cancelButtonText&&(e=a(['<a id="cancelButton" href="#">',b.cancelButtonText,"</a>"].join("")),d.append(e),e.bind("click",this.callbackWrapper(this.cancelRequest)));b.continueButtonText&&(e=a(['<button id="continueButton"class="button pkp_helpers_align_right">',b.continueButtonText,"</button>"].join("")).button(),d.append(e),f=a('<div class="pkp_helpers_progressIndicator"></div>'),
d.append(f),e.bind("click",this.callbackWrapper(this.continueRequest)),this.$continueButton_=e,this.$progressIndicator_=f,this.continueButtonText_=b.continueButtonText,this.finishButtonText_=b.finishButtonText?b.finishButtonText:b.continueButtonText);c.after(d)}})(jQuery);(function(a){a.pkp.controllers.wizard.fileUpload=a.pkp.controllers.wizard.fileUpload||{};a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler=function(a,b){this.parent(a,b);this.deleteUrl_=b.deleteUrl;this.metadataUrl_=b.metadataUrl;this.finishUrl_=b.finishUrl;this.bind("fileUploaded",this.handleFileUploaded);this.getContinueButton().button("disable")};a.pkp.classes.Helper.inherits(a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler,a.pkp.controllers.wizard.WizardHandler);a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.deleteUrl_=
"";a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.metadataUrl_="";a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.finishUrl_="";a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.uploadedFile_=null;a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.tabsSelect=function(a,b,d){if(0<d.index){if(!this.uploadedFile_)throw Error("Uploaded file missing!");var e=this.getHtmlElement(),f="";switch(d.index){case 1:f=this.metadataUrl_;
break;case 2:f=this.finishUrl_;break;default:throw Error("Unsupported tab index.");}f=f+"&fileId="+this.uploadedFile_.fileId;e.tabs("url",d.index,f)}return this.parent("tabsSelect",a,b,d)};a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.wizardAdvance=function(){var a=this.getCurrentStep(),b=this.getNumberOfSteps()-1,d=a+1,e=this.getHtmlElement();if(d>b)throw Error("Trying to set an invalid wizard step!");e.tabs("enable",d);e.tabs("select",d);0===a&&e.tabs("disable",a);d===b&&
(a=this.getContinueButton(),a.button("option","label",this.getFinishButtonText()),a.button("enable"))};a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.tabsLoad=function(c,b,d){var e=this.getHtmlElement(),f=this.getProgressIndicator();if(2===d.index){e=a("#newFile",e);if(1!==e.length)throw Error('Did not find "new file" button!');e.button();e.bind("click",this.callbackWrapper(this.startWizard))}f.hide();return this.parent("tabsLoad",c,b,d)};a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.formValid=
function(a,b){0===this.getCurrentStep()&&0===this.getHtmlElement().find("#uploadConfirmationForm").length&&!this.uploadedFile_||this.parent("formValid",a,b)};a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.wizardCancelRequested=function(c,b){if(this.parent("wizardCancelRequested",c,b))if(this.uploadedFile_)a.post(this.deleteUrl_,this.uploadedFile_,a.pkp.classes.Helper.curry(this.wizardCancelSuccess,this,c,b),"json"),this.uploadedFile_=null,b.preventDefault();else return!0;return!1};
a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.wizardCancelSuccess=function(a,b,d){!1!==this.handleJson(d)&&this.trigger("wizardCancel")};a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.handleFileUploaded=function(a,b,d){this.uploadedFile_=d};a.pkp.controllers.wizard.fileUpload.FileUploadWizardHandler.prototype.startWizard=function(){this.uploadedFile_=null;this.parent("startWizard")}})(jQuery);(function(a){a.pkp.controllers.wizard.fileUpload.form=a.pkp.controllers.wizard.fileUpload.form||{};a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler=function(a,b){this.parent(a,b);this.hasFileSelector_=b.hasFileSelector;this.hasGenreSelector_=b.hasGenreSelector;b.presetRevisedFileId&&(this.presetRevisedFileId_=b.presetRevisedFileId);this.fileGenres_=b.fileGenres;this.attachUploader_(b.$uploader,b.uploaderOptions);this.uploaderSetup(b.$uploader);var d;a.find("#revisedFileId").change(this.callbackWrapper(this.revisedFileChange));
this.hasGenreSelector_&&(d=a.find("#genreId"),d.change(this.callbackWrapper(this.genreChange)),a.find(".plupload_button.plupload_start").hide())};a.pkp.classes.Helper.inherits(a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.hasFileSelector_=!1;a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.hasGenreSelector_=!1;a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.presetRevisedFileId_=
null;a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.fileGenres_=null;a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.prototype.uploaderSetup=function(a){a=a.plupload("getUploader");a.bind("BeforeUpload",this.callbackWrapper(this.prepareFileUploadRequest));a.bind("FileUploaded",this.callbackWrapper(this.handleUploadResponse))};a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.prototype.prepareFileUploadRequest=function(a,b){var d=this.getHtmlElement(),e=
{},f=d.find("#uploaderUserGroupId");f.attr("disabled","disabled");e.uploaderUserGroupId=f.val();this.hasFileSelector_?(f=d.find("#revisedFileId"),f.attr("disabled","disabled"),e.revisedFileId=f.val()):e.revisedFileId=null!==this.presetRevisedFileId_?this.presetRevisedFileId_:0;this.hasGenreSelector_?(d=d.find("#genreId"),d.attr("disabled","disabled"),e.genreId=d.val()):e.genreId="";b.settings.multipart_params=e};a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.prototype.handleUploadResponse=
function(c,b,d,e){c=this.handleJson(a.parseJSON(e.response));b=this.getHtmlElement();!1!==c&&(this.trigger("fileUploaded",c.uploadedFile),""===c.content?(b.find(":file").attr("disabled","disabled"),b.find("a.plupload_add").button("disable"),this.trigger("formValid")):this.getHtmlElement().replaceWith(c.content))};a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.prototype.submitForm=function(){this.trigger("formSubmitted")};a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.prototype.revisedFileChange=
function(){var a=this.getHtmlElement(),b=a.find("#revisedFileId"),d=a.find("#genreId");""===b.val()?d.removeAttr("disabled"):(d.val(this.fileGenres_[b.val()]),d.attr("disabled","disabled"),a.find(".plupload_button.plupload_start").show());return!1};a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.prototype.genreChange=function(){var a=this.getHtmlElement();""===a.find("#genreId").val()?a.find(".plupload_button.plupload_start").hide():a.find(".plupload_button.plupload_start").show()};
a.pkp.controllers.wizard.fileUpload.form.FileUploadFormHandler.prototype.attachUploader_=function(a,b){a.pkpHandler("$.pkp.controllers.UploaderHandler",b)}})(jQuery);(function(a){a.pkp.controllers.wizard.fileUpload.form.RevisionConfirmationHandler=function(a,b){this.parent(a,b);a.find("#possibleRevision").show("slide");this.trigger("unregisterChangedForm");this.bind("wizardAdvanceRequested",this.wizardAdvanceRequested);this.trackFormChanges=!1};a.pkp.classes.Helper.inherits(a.pkp.controllers.wizard.fileUpload.form.RevisionConfirmationHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.wizard.fileUpload.form.RevisionConfirmationHandler.prototype.wizardAdvanceRequested=
function(a,b){var d=this.getHtmlElement();0<parseInt(d.find("#revisedFileId").val(),10)&&(d.submit(),b.preventDefault())};a.pkp.controllers.wizard.fileUpload.form.RevisionConfirmationHandler.prototype.handleResponse=function(a,b){!0===b.status&&this.trigger("fileUploaded",b.uploadedFile);return this.parent("handleResponse",a,b)}})(jQuery);(function(a){a.pkp.controllers.tab=a.pkp.controllers.tab||{settings:{form:{}}};a.pkp.controllers.tab.settings.form.FileViewFormHandler=function(a,b){this.parent(a,b);this.fetchFileUrl_=b.fetchFileUrl;this.bind("dataChanged",this.refreshForm_)};a.pkp.classes.Helper.inherits(a.pkp.controllers.tab.settings.form.FileViewFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.tab.settings.form.FileViewFormHandler.prototype.fetchFileUrl_=null;a.pkp.controllers.tab.settings.form.FileViewFormHandler.prototype.refreshForm_=
function(c,b,d){a.get(this.fetchFileUrl_,{settingName:d},this.callbackWrapper(this.refreshResponseHandler_),"json")};a.pkp.controllers.tab.settings.form.FileViewFormHandler.prototype.refreshResponseHandler_=function(a,b){var d,e=this.handleJson(b);e.noData?(d=this.getFileHtmlElement_(e.noData),d.empty()):(d=this.getFileHtmlElement_(e.elementId),d.html(e.content))};a.pkp.controllers.tab.settings.form.FileViewFormHandler.prototype.getFileHtmlElement_=function(c){var b=this.getHtmlElement();return a("#"+
c,b)}})(jQuery);(function(a){a.pkp.controllers.tab.settings.announcements=a.pkp.controllers.tab.settings.announcements||{form:{}};a.pkp.controllers.tab.settings.announcements.form.AnnouncementSettingsFormHandler=function(c,b){this.parent(c,b);a("#enableAnnouncementsHomepage",c).click(this.callbackWrapper(this.toggleEnableAnnouncementsHomepage))};a.pkp.classes.Helper.inherits(a.pkp.controllers.tab.settings.announcements.form.AnnouncementSettingsFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.tab.settings.announcements.form.AnnouncementSettingsFormHandler.prototype.toggleEnableAnnouncementsHomepage=
function(){var c=a("#numAnnouncementsHomepage",this.getHtmlElement());c.attr("disabled")?c.removeAttr("disabled"):c.attr("disabled","disabled")}})(jQuery);(function(a){a.pkp.controllers.tab.settings.paymentMethod=a.pkp.controllers.tab.settings.paymentMethod||{};a.pkp.controllers.tab.settings.paymentMethod.PaymentMethodHandler=function(a,b){this.parent(a,b);this.paymentMethodFormUrlTemplate_=b.paymentMethodFormUrlTemplate;this.bind("selectPaymentMethod",this.selectPaymentMethodHandler)};a.pkp.classes.Helper.inherits(a.pkp.controllers.tab.settings.paymentMethod.PaymentMethodHandler,a.pkp.classes.Handler);a.pkp.controllers.tab.settings.paymentMethod.PaymentMethodHandler.prototype.paymentMethodFormUrlTemplate_=
"";a.pkp.controllers.tab.settings.paymentMethod.PaymentMethodHandler.prototype.getPaymentMethodFormUrl_=function(c){a("#paymentPluginName").val(c);return this.paymentMethodFormUrlTemplate_.replace("PAYMENT_PLUGIN_NAME",c)};a.pkp.controllers.tab.settings.paymentMethod.PaymentMethodHandler.prototype.selectPaymentMethodHandler=function(c,b,d){0!==d?a.get(this.getPaymentMethodFormUrl_(d),this.callbackWrapper(this.showFetchedPaymentMethodForm_),"json"):a("#paymentMethodFormContainer").children().remove()};
a.pkp.controllers.tab.settings.paymentMethod.PaymentMethodHandler.prototype.showFetchedPaymentMethodForm_=function(c,b){var d=this.handleJson(b),e=a("#paymentMethodFormContainer");e.children().remove();e.append(d.content)}})(jQuery);(function(a){a.pkp.pages=a.pkp.pages||{header:{}};a.pkp.pages.header.ContextSwitcherFormHandler=function(c,b){this.parent(c,b);a("select.applyPlugin",c).selectBox();a("#contextSwitcherSelect",c).change(this.callbackWrapper(this.switchContextHandler_))};a.pkp.classes.Helper.inherits(a.pkp.pages.header.ContextSwitcherFormHandler,a.pkp.controllers.form.FormHandler);a.pkp.pages.header.ContextSwitcherFormHandler.prototype.switchContextHandler_=function(c){c=a(c).val();""!==c&&this.trigger("redirectRequested",
[c])}})(jQuery);(function(a){a.pkp.pages.header.HeaderHandler=function(a,b){this.options_=b;this.parent(a,b);this.initializeMenu_();a.find('[id^="toggleHelp"]').click(this.callbackWrapper(this.toggleInlineHelpHandler_));this.publishEvent("toggleInlineHelp")};a.pkp.classes.Helper.inherits(a.pkp.pages.header.HeaderHandler,a.pkp.classes.Handler);a.pkp.pages.header.HeaderHandler.prototype.options_=null;a.pkp.pages.header.HeaderHandler.prototype.toggleInlineHelpHandler_=function(){this.trigger("toggleInlineHelp");return!1};
a.pkp.pages.header.HeaderHandler.prototype.initializeMenu_=function(){var c=this.getHtmlElement(),c=a("ul.sf-menu",c),b=this.options_.requestedPage,d=window.location.href,e=a('a[href="'+d+'"]',c).parentsUntil("ul.sf-menu").last();c.superfish();if(0===e.length&&""!==b)for(;;){d=d.substr(0,d.lastIndexOf("/"));if(-1===d.indexOf(b))break;e=e.add(a('a[href="'+d+'"]',c).parentsUntil("ul.sf-menu").last())}1===e.length&&a("a",e).first().addClass("pkp_helpers_underline")}})(jQuery);(function(a){a.pkp.pages.admin=a.pkp.pages.admin||{};a.pkp.pages.admin.ContextsHandler=function(c,b){var d=a("#openWizard a");d&&d.attr("style","display:none");this.parent(c,b)};a.pkp.classes.Helper.inherits(a.pkp.pages.admin.ContextsHandler,a.pkp.classes.Handler)})(jQuery);(function(a){a.pkp.pages.submission=a.pkp.pages.submission||{};a.pkp.pages.submission.SubmissionTabHandler=function(a,b){this.parent(a,b);this.submissionProgress_=b.submissionProgress;this.bind("setStep",this.setStepHandler);this.getHtmlElement().tabs("option","disabled",this.getDisabledSteps(this.submissionProgress_))};a.pkp.classes.Helper.inherits(a.pkp.pages.submission.SubmissionTabHandler,a.pkp.controllers.TabHandler);a.pkp.pages.submission.SubmissionTabHandler.prototype.submissionProgress_=null;
a.pkp.pages.submission.SubmissionTabHandler.prototype.setStepHandler=function(a,b,d){this.getHtmlElement().tabs("option","disabled",this.getDisabledSteps(d));this.getHtmlElement().tabs("option","selected",d-1)};a.pkp.pages.submission.SubmissionTabHandler.prototype.getDisabledSteps=function(a){switch(parseInt(a,10)){case 0:return[];case 1:return[1,2,3,4];case 2:return[2,3,4];case 3:return[3,4];case 4:return[]}throw Error("Illegal submission step number!");}})(jQuery);(function(a){a.pkp.controllers.grid.settings=a.pkp.controllers.grid.settings||{user:{form:{}}};a.pkp.controllers.grid.settings.user.form.UserFormHandler=function(c,b){this.parent(c,b);a('[id^="generatePassword"]',c).click(this.callbackWrapper(this.setGenerateRandom));a('[id^="generatePassword"]',c).attr("checked")&&this.setGenerateRandom('[id^="generatePassword"]')};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.settings.user.form.UserFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.grid.settings.user.form.UserFormHandler.prototype.submitForm=
function(c,b){var d=this.getHtmlElement();a(":password",d).removeAttr("disabled");this.parent("submitForm",c,b)};a.pkp.controllers.grid.settings.user.form.UserFormHandler.prototype.setGenerateRandom=function(c){var c=a(c),b=this.getHtmlElement(),d="",e=0;c.attr("checked")?(d="********",e="disabled"):e=d="";a(":password",b).attr("disabled",e).val(d);a('[id^="sendNotify"]',b).attr("disabled",e).attr("checked",e)}})(jQuery);(function(a){a.pkp.controllers.grid.settings.roles=a.pkp.controllers.grid.settings.roles||{form:{}};a.pkp.controllers.grid.settings.roles.form.UserGroupFormHandler=function(c,b){var d=a('[id^="roleId"]',c);this.parent(c,b);b.selfRegistrationRoleIds&&(this.selfRegistrationRoleIds_=b.selfRegistrationRoleIds);this.roleForbiddenStages_=b.roleForbiddenStagesJSON.content;this.stagesSelector_=b.stagesSelector;this.updatePermitSelfRegistration(d.val());this.updateStageOptions(d.val());d.change(this.callbackWrapper(this.changeRoleId))};
a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.settings.roles.form.UserGroupFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.grid.settings.roles.form.UserGroupFormHandler.prototype.selfRegistrationRoleIds_=null;a.pkp.controllers.grid.settings.roles.form.UserGroupFormHandler.prototype.roleForbiddenStages_=null;a.pkp.controllers.grid.settings.roles.form.UserGroupFormHandler.prototype.stagesSelector_=null;a.pkp.controllers.grid.settings.roles.form.UserGroupFormHandler.prototype.changeRoleId=
function(c){c=a(c).val();this.updatePermitSelfRegistration(c);this.updateStageOptions(c)};a.pkp.controllers.grid.settings.roles.form.UserGroupFormHandler.prototype.updatePermitSelfRegistration=function(c){var b=a('[id^="permitSelfRegistration"]');this.getHtmlElement();var d,e=!1;for(d=0;d<this.selfRegistrationRoleIds_.length;d++)this.selfRegistrationRoleIds_[d]==c&&(e=!0);e?b.removeAttr("disabled"):(b.attr("disabled","disabled"),b.removeAttr("checked"))};a.pkp.controllers.grid.settings.roles.form.UserGroupFormHandler.prototype.updateStageOptions=
function(c){var b=a(this.stagesSelector_,this.getHtmlElement()).filter("input"),d,e=null;b.removeAttr("disabled");if(void 0!=this.roleForbiddenStages_[c])for(d=0;d<this.roleForbiddenStages_[c].length;d++)e=this.roleForbiddenStages_[c][d],b.filter('input[value="'+e+'"]').attr("disabled","disabled")}})(jQuery);(function(a){a.pkp.controllers.grid.files=a.pkp.controllers.grid.files||{signoff:{form:{}}};a.pkp.controllers.grid.files.signoff.form.AddAuditorFormHandler=function(c,b){this.parent(c,b);var d=new Date,e=d.getMonth()+1,f=d.getDate()+7,d=d.getFullYear();a('input[id^="responseDueDate"]').datepicker({dateFormat:"mm-dd-yy",minDate:"0",autoSize:!0});a('input[id^="responseDueDate"]').datepicker("setDate",e+"-"+f+"-"+d)};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.files.signoff.form.AddAuditorFormHandler,
a.pkp.controllers.form.AjaxFormHandler)})(jQuery);(function(a){a.pkp.controllers.tab.settings.siteAccessOptions=a.pkp.controllers.tab.settings.siteAccessOptions||{form:{}};a.pkp.controllers.tab.settings.siteAccessOptions.form.SiteAccessOptionsFormHandler=function(c,b){this.parent(c,b);a("#disableUserReg-0",c).click(this.callbackWrapper(this.changeRegOptsState));a("#disableUserReg-1",c).click(this.callbackWrapper(this.changeRegOptsState))};a.pkp.classes.Helper.inherits(a.pkp.controllers.tab.settings.siteAccessOptions.form.SiteAccessOptionsFormHandler,
a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.tab.settings.siteAccessOptions.form.SiteAccessOptionsFormHandler.prototype.changeRegOptsState=function(a){"disableUserReg-0"===a.id?this.setRegOptsDisabled_(!1):(this.setRegOptsDisabled_(!0),this.setRegOptsChecked_(!1))};a.pkp.controllers.tab.settings.siteAccessOptions.form.SiteAccessOptionsFormHandler.prototype.setRegOptsDisabled_=function(c){c?a('[id^="allow"]').attr("disabled","disabled"):a('[id^="allow"]').removeAttr("disabled")};a.pkp.controllers.tab.settings.siteAccessOptions.form.SiteAccessOptionsFormHandler.prototype.setRegOptsChecked_=
function(c){c?a('[id^="allow"]').attr("checked","checked"):a('[id^="allow"]').removeAttr("checked")}})(jQuery);(function(a){a.pkp.controllers.tab.settings.managementSettings=a.pkp.controllers.tab.managementSettings||{};a.pkp.controllers.tab.settings.managementSettings.UsersAndRolesTabHandler=function(a,b){this.parent(a,b);this.bind("confirmationModalConfirmed",this.confirmationModalConfirmedHandler_);b.userGridContentUrl&&(this.userGridContentUrl_=b.userGridContentUrl)};a.pkp.classes.Helper.inherits(a.pkp.controllers.tab.settings.managementSettings.UsersAndRolesTabHandler,a.pkp.controllers.TabHandler);a.pkp.controllers.tab.settings.managementSettings.UsersAndRolesTabHandler.prototype.userGridContentUrl_=
null;a.pkp.controllers.tab.settings.managementSettings.UsersAndRolesTabHandler.prototype.confirmationModalConfirmedHandler_=function(c,b,d){c=a.parseJSON(d);this.userGridContentUrl_&&c.content.oldUserId&&(this.getHtmlElement(),a.get(this.userGridContentUrl_+"&oldUserId="+encodeURIComponent(c.content.oldUserId),null,this.callbackWrapper(this.updateTabsHandler_),"json"))};a.pkp.controllers.tab.settings.managementSettings.UsersAndRolesTabHandler.prototype.updateTabsHandler_=function(c,b){var d=this.handleJson(b),
e=this.getHtmlElement().find("div").first();a(e).replaceWith(d.content)}})(jQuery);(function(a){a.pkp.controllers.dashboard=a.pkp.controllers.dashboard||{form:{}};a.pkp.controllers.dashboard.form.DashboardTaskFormHandler=function(c,b){this.parent(c,b);this.singleContextSubmissionUrl_=b.singleContextSubmissionUrl;a("#singleContext",c).click(this.callbackWrapper(this.startSingleContextSubmission_));a("#multipleContext",c).change(this.callbackWrapper(this.startMultipleContextSubmission_))};a.pkp.classes.Helper.inherits(a.pkp.controllers.dashboard.form.DashboardTaskFormHandler,a.pkp.controllers.form.FormHandler);
a.pkp.controllers.dashboard.form.DashboardTaskFormHandler.prototype.singleContextSubmissionUrl_=null;a.pkp.controllers.dashboard.form.DashboardTaskFormHandler.prototype.startSingleContextSubmission_=function(){window.location.href=this.singleContextSubmissionUrl_};a.pkp.controllers.dashboard.form.DashboardTaskFormHandler.prototype.startMultipleContextSubmission_=function(){var a=this.getHtmlElement().find("#multipleContext").val();0!=a&&(window.location.href=a)}})(jQuery);jQuery.pkp.controllers.informationCenter=jQuery.pkp.controllers.informationCenter||{};
(function(a){a.pkp.controllers.informationCenter.NotesHandler=function(a,b){this.parent(a,b);this.fetchNotesUrl_=b.fetchNotesUrl;this.fetchPastNotesUrl_=b.fetchPastNotesUrl;this.bind("formSubmitted",this.handleRefreshNoteList);this.loadPastNoteList_();this.loadNoteList_()};a.pkp.classes.Helper.inherits(a.pkp.controllers.informationCenter.NotesHandler,a.pkp.classes.Handler);a.pkp.controllers.informationCenter.NotesHandler.prototype.fetchNotesUrl_="";a.pkp.controllers.informationCenter.NotesHandler.prototype.fetchPastNotesUrl_=
"";a.pkp.controllers.informationCenter.NotesHandler.prototype.handleRefreshNoteList=function(c){a(c).find('[id^="newNote"]').val("");this.loadNoteList_()};a.pkp.controllers.informationCenter.NotesHandler.prototype.loadNoteList_=function(){a.get(this.fetchNotesUrl_,this.callbackWrapper(this.setNoteList_),"json")};a.pkp.controllers.informationCenter.NotesHandler.prototype.setNoteList_=function(c,b){var d=this.handleJson(b);a("#notesList").replaceWith(d.content);this.getHtmlElement().find(".showMore, .showLess").bind("click",
this.switchViz);a("#notesAccordion").hasClass("ui-accordion")?a("#notesAccordion").accordion("destroy").accordion({clearStyle:!0}):a("#notesAccordion").accordion({clearStyle:!0})};a.pkp.controllers.informationCenter.NotesHandler.prototype.loadPastNoteList_=function(){a("#pastNotesList").length&&a.get(this.fetchPastNotesUrl_,this.callbackWrapper(this.setPastNoteList_),"json")};a.pkp.controllers.informationCenter.NotesHandler.prototype.setPastNoteList_=function(c,b){this.handleJson(b);a("#pastNotesList").replaceWith(b.content)}})(jQuery);(function(a){a.pkp.controllers.informationCenter.SignoffNotesHandler=function(a,b){this.parent(a,b);this.signoffNotesFormUrl_=b.signoffNotesFormUrl;this.bind("selectSignoff",this.handleRefreshNotesForm_);this.bind("dropDownOptionSet",this.handleDropDownOptionSet_);var d=null;b.signoffId&&(d=b.signoffId);this.loadNoteForm_(d)};a.pkp.classes.Helper.inherits(a.pkp.controllers.informationCenter.SignoffNotesHandler,a.pkp.classes.Handler);a.pkp.controllers.informationCenter.SignoffNotesHandler.prototype.signoffNotesFormUrl_=
"";a.pkp.controllers.informationCenter.SignoffNotesHandler.prototype.handleRefreshNotesForm_=function(c,b,d){0!==d?this.loadNoteForm_(d):a("#signoffNotesFormContainer").children().remove()};a.pkp.controllers.informationCenter.SignoffNotesHandler.prototype.handleDropDownOptionSet_=function(){var c=a("#signoffSelect",this.getHtmlElement()),b;2==a("option",c).length&&(b=a("option",c).next().val(),c.val(b),this.loadNoteForm_(b))};a.pkp.controllers.informationCenter.SignoffNotesHandler.prototype.loadNoteForm_=
function(c){void 0!==c&&c&&a.get(this.signoffNotesFormUrl_,{signoffId:c},this.callbackWrapper(this.showFetchedNoteForm_),"json")};a.pkp.controllers.informationCenter.SignoffNotesHandler.prototype.showFetchedNoteForm_=function(c,b){var d=this.handleJson(b),e=a("#signoffNotesFormContainer");e.children().remove();e.append(d.content)}})(jQuery);(function(a){a.pkp.controllers.statistics=a.pkp.controllers.statistics||{};a.pkp.controllers.statistics.ReportGeneratorFormHandler=function(c,b){var d;b.trackFormChanges=!1;b.transformButtons=!1;this.parent(c,b);this.getHtmlElement().find(":submit").button();a("#reportUrlFormArea",c).hide();this.timeFilterWrapperSelector_=b.timeFilterWrapperSelector;this.rangeByDaySelector_=b.rangeByDaySelector;this.rangeByMonthSelector_=b.rangeByMonthSelector;this.startDayElementSelector_=b.startDayElementSelector;
this.endDayElementSelector_=b.endDayElementSelector;this.fetchFormUrl_=b.fetchFormUrl;this.$metricTypeSelectElement_=d=a(b.metricTypeSelectSelector,this.getHtmlElement());1==d.length&&d.change(this.callbackWrapper(this.fetchFormHandler_));this.$reportTemplateSelectElement_=d=a(b.reportTemplateSelectSelector,this.getHtmlElement());1==d.length&&d.change(this.callbackWrapper(this.fetchFormHandler_));this.columnsSelector_=b.columnsSelector;d=a(b.aggregationOptionsSelector);0<d.length&&d.change(this.callbackWrapper(this.aggregationOptionsChangeHandler_));
d=a(b.currentMonthSelector,this.getHtmlElement()).add(b.currentDaySelector,this.getHtmlElement()[0]);2==d.length&&d.click(this.callbackWrapper(this.currentTimeElementsClickHandler_));d=a(b.rangeByMonthSelector,this.getHtmlElement()).add(b.rangeByDaySelector,this.getHtmlElement()[0]);2==d.length&&d.click(this.callbackWrapper(this.rangeTimeElementsClickHandler_));this.dateRangeElementsWrapper_=a(b.dateRangeWrapperSelector,this.getHtmlElement());1==d.filter("input:checked").length?d.filter("input:checked").click():
this.dateRangeElementsWrapper_.hide();this.fileAssocTypes_=b.fileAssocTypes;this.$fileTypeSelectElement_=a(b.fileTypeSelectSelector,this.getHtmlElement());d=a(b.objectTypeSelectSelector,this.getHtmlElement());1==this.$fileTypeSelectElement_.length&&(this.$fileTypeSelectElement_.attr("disabled","disabled"),d.change(this.callbackWrapper(this.updateFileTypeSelectHandler_)));d.change();this.fetchRegionsUrl_=b.fetchRegionsUrl;this.$regionSelectElement_=a(b.regionSelectSelector,this.getHtmlElement());1==
this.$regionSelectElement_.length&&(d=a(b.countrySelectSelector,this.getHtmlElement()),d.change(this.callbackWrapper(this.fetchRegionHandler_)))};a.pkp.classes.Helper.inherits(a.pkp.controllers.statistics.ReportGeneratorFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.fetchFormUrl_=null;a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.fetchArticlesUrl_=null;a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.$metricTypeSelectElement_=
{};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.$reportTemplateSelectElement_={};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.$regionSelectElement_={};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.fetchRegionsUrl_=null;a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.$fileAssocTypes_={};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.rangeByDaySelector_=null;a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.rangeByMonthSelector_=
null;a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.startDayElementSelector_=null;a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.endDayElementSelector_=null;a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.timeFilterWrapperSelector_=null;a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.columnsSelector_=null;a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.handleResponse=function(c,b){var d=this.handleJson(b);
!1!==d&&void 0!==d.reportUrl&&(a("#reportUrlFormArea",this.getHtmlElement()).show().find(":input").val(d.reportUrl),window.location=d.reportUrl);this.parent("handleResponse",c,b);return!1};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.fetchFormHandler_=function(){var c,b={};c=a(this.timeFilterWrapperSelector_,this.getHtmlElement()).serializeArray();a.each(c,function(a,c){b[c.name]=c.value});c=a("option:selected",this.$metricTypeSelectElement_);void 0!==c[0]&&void 0!==c[0].value&&
(b.metricType=c[0].value);c=a("option:selected",this.$reportTemplateSelectElement_);void 0!==c[0]&&void 0!==c[0].value&&(b.reportTemplate=c[0].value);b.refreshForm=!0;a.get(this.fetchFormUrl_,b,this.callbackWrapper(this.handleResponse,null),"json");return!1};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.updateFileTypeSelectHandler_=function(c){var b,c=a(c),c=a("option:selected",c);if(1==c.length)for(b in c=c[0].value,this.fileAssocTypes_)if(this.fileAssocTypes_[b]==c)return this.$fileTypeSelectElement_.removeAttr("disabled"),
!1;this.$fileTypeSelectElement_.attr("disabled","disabled");return!1};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.fetchRegionHandler_=function(c){this.$regionSelectElement_.empty();c=a(c);c=a("option:selected",c);1==c.length&&(c=c[0].label,a.get(this.fetchRegionsUrl_,{countryId:c},this.callbackWrapper(this.updateRegionSelectCallback_,null),"json"));return!1};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.updateRegionSelectCallback_=function(c,b){var d,e,f,
i;d=this.$regionSelectElement_;d.empty();e=this.handleJson(b);if(!1!==e){f=e.content;i=0;for(e=f.length;i<e;i++)d.append(a("<option />").val(f[i].id).text(f[i].name))}return!1};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.currentTimeElementsClickHandler_=function(){this.dateRangeElementsWrapper_.hide();return!0};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.rangeTimeElementsClickHandler_=function(c){var b=a(this.startDayElementSelector_).add(this.endDayElementSelector_);
this.dateRangeElementsWrapper_.show();"#"+a(c).attr("id")==this.rangeByDaySelector_&&b.show();"#"+a(c).attr("id")==this.rangeByMonthSelector_&&b.hide();return!0};a.pkp.controllers.statistics.ReportGeneratorFormHandler.prototype.aggregationOptionsChangeHandler_=function(c){var b;b=a(this.columnsSelector_);c=a(c);b=b.find('option[value="'+c.attr("value")+'"]');c.attr("checked")?b.attr("selected","selected"):b.removeAttr("selected");return!1}})(jQuery);jQuery.pkp.pages.submission=jQuery.pkp.pages.submission||{};(function(a){a.pkp.pages.submission.SubmissionStep2FormHandler=function(a,b){this.parent(a,b);this.bind("urlInDivLoaded",this.showFileUploadWizard_)};a.pkp.classes.Helper.inherits(a.pkp.pages.submission.SubmissionStep2FormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.pages.submission.SubmissionStep2FormHandler.prototype.showFileUploadWizard_=function(c,b,d){"submissionFilesGridDiv"==d&&a("#"+d).find('[id*="-addFile-button-"]').click()}})(jQuery);jQuery.pkp.pages.submission=jQuery.pkp.pages.submission||{};
(function(a){a.pkp.pages.submission.SubmissionStep3FormHandler=function(c,b){this.parent(c,b);this.bind("gridRefreshRequested",this.fetchChaptersGrid_);this.authorsGridContainer_=b.authorsGridContainer;this.chaptersGridContainer_=b.chaptersGridContainer;this.isEditedVolume_=b.isEditedVolume;(this.canExpedite_=b.canExpedite)&&a("#metadataAccordion").accordion({clearStyle:!0,collapsible:!0,active:!1})};a.pkp.classes.Helper.inherits(a.pkp.pages.submission.SubmissionStep3FormHandler,a.pkp.controllers.form.AjaxFormHandler);
a.pkp.pages.submission.SubmissionStep3FormHandler.prototype.chaptersGridContainer_="";a.pkp.pages.submission.SubmissionStep3FormHandler.prototype.isEditedVolume_=!1;a.pkp.pages.submission.SubmissionStep3FormHandler.prototype.canExpedite_=!1;a.pkp.pages.submission.SubmissionStep3FormHandler.prototype.fetchChaptersGrid_=function(c,b){var d=b.target;this.isEditedVolume_&&d.id==this.authorsGridContainer_&&a("#"+this.chaptersGridContainer_).find(".pkp_controllers_grid").trigger("dataChanged")}})(jQuery);(function(a){a.pkp.pages.workflow=a.pkp.pages.workflow||{};a.pkp.pages.workflow.WorkflowHandler=function(a,b){this.parent(a,b);this.bind("stageParticipantsChanged",this.handleStageParticipantsChanged_);this.bind("dataChanged",this.dataChangedHandler_)};a.pkp.classes.Helper.inherits(a.pkp.pages.workflow.WorkflowHandler,a.pkp.classes.Handler);a.pkp.pages.workflow.WorkflowHandler.prototype.handleStageParticipantsChanged_=function(){var c=this.getHtmlElement().find(".editorDecisionActions"),b=this.getHtmlElement().find("#submissionProgressBarDiv");
c.add(b).each(function(){a.pkp.classes.Handler.getHandler(a(this)).reload()})};a.pkp.pages.workflow.WorkflowHandler.prototype.dataChangedHandler_=function(c,b,d){a(b.target,this.getHtmlElement()).children("a").attr("id").match(/submissionEntry/)&&(c=a('[id^="formatsGridContainer"]',this.getHtmlElement()).children("div"),c.trigger("dataChanged",[d]),c.trigger("notifyUser",[c]))}})(jQuery);(function(a){a.pkp.pages.workflow.SubmissionHeaderHandler=function(c,b){this.parent(c,b);this.participantToggleSeletor_=b.participantToggleSeletor;a(this.participantToggleSeletor_).click(this.callbackWrapper(this.appendToggleIndicator_));this.bind("gridRefreshRequested",this.refreshWorkflowContent_);this.publishEvent("stageParticipantsChanged")};a.pkp.classes.Helper.inherits(a.pkp.pages.workflow.SubmissionHeaderHandler,a.pkp.classes.Handler);a.pkp.pages.workflow.SubmissionHeaderHandler.prototype.participantToggleSelector_=
null;a.pkp.pages.workflow.SubmissionHeaderHandler.prototype.refreshWorkflowContent_=function(c,b){a(b.target).attr("id").match(/^stageParticipantGridContainer/)&&(this.trigger("stageParticipantsChanged"),a(this.participantToggleSeletor_).click())};a.pkp.pages.workflow.SubmissionHeaderHandler.prototype.appendToggleIndicator_=function(){var a=this.getHtmlElement(),b=a.find(".participant_popover"),d=a.find("li.participants"),a=a.find("#participantToggle");b.toggle();d.toggleClass("expandedIndicator");
a.toggleClass("expandedIndicator");d.hasClass("expandedIndicator")&&this.trigger("callWhenClickOutside",[{container:b.add(d),callback:this.callbackWrapper(this.appendToggleIndicator_),skipWhenVisibleModals:!0}])}})(jQuery);(function(a){a.pkp.pages.workflow.EditorDecisionsHandler=function(c,b){this.parent(c,b);a("a",c).button()};a.pkp.classes.Helper.inherits(a.pkp.pages.workflow.EditorDecisionsHandler,a.pkp.classes.Handler)})(jQuery);(function(a){a.pkp.pages.workflow.ProductionHandler=function(a,b){this.parent(a,b);this.$formatTabsSelector_=b.formatsTabContainerSelector;this.$submissionProgressBarSelector_=b.submissionProgressBarSelector;this.bind("gridRefreshRequested",this.refreshWidgetsHandler_);this.bind("containerReloadRequested",this.refreshWidgetsHandler_)};a.pkp.classes.Helper.inherits(a.pkp.pages.workflow.ProductionHandler,a.pkp.classes.Handler);a.pkp.pages.workflow.ProductionHandler.prototype.$formatTabsSelector_=null;
a.pkp.pages.workflow.ProductionHandler.prototype.$submissionProgressBarSelector_=null;a.pkp.pages.workflow.ProductionHandler.prototype.widgetsRefreshed_=!1;a.pkp.pages.workflow.ProductionHandler.prototype.refreshWidgetsHandler_=function(c,b){var d=a(b.target),e;this.widgetsRefreshed_?this.widgetsRefreshed_=!1:(this.widgetsRefreshed_=!0,d.attr("id").match(/^formatsGridContainer/)||(e=a('[id^="formatsGridContainer"]',this.getHtmlElement()).children(),e.trigger("dataChanged")),e=a(this.$formatTabsSelector_,
this.getHtmlElement()).find(".ui-tabs"),0===e.has("#"+d.attr("id")).length&&e.trigger("refreshTabs"),a.pkp.classes.Handler.getHandler(a(this.$submissionProgressBarSelector_)).reload())}})(jQuery);(function(a){a.pkp.controllers.grid.users=a.pkp.controllers.grid.users||{reviewer:{form:{}}};a.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler=function(c,b){this.parent(c,b);c.find(".button").button();a("#selectReviewerButton").click(this.callbackWrapper(this.reviewerSelected));a("#regularReviewerForm").hide();this.bind("refreshForm",this.handleRefresh_)};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler,a.pkp.classes.Handler);a.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler.prototype.reviewerSelected=
function(){var c=this.getHtmlElement().find("#reviewerSelectGridContainer").find("input:checked"),b=c.val();b&&(c=a.trim(c.parent().next().children("span").text()),a("#reviewerId").val(b),a('input[id^="selectedReviewerName"]',this.getHtmlElement()).val(c),a("#searchGridAndButton").hide(),a("#regularReviewerForm").show())};a.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler.prototype.handleRefresh_=function(a,b,d){d&&this.getHtmlElement().replaceWith(d)}})(jQuery);(function(a){a.pkp.controllers.grid.users.reviewer=a.pkp.controllers.grid.users.reviewer||{form:{}};a.pkp.controllers.grid.users.reviewer.form.LimitFilesFormHandler=function(a,b){this.parent(a,b);a.change(this.callbackWrapper(this.handleFormChange));this.bind("urlInDivLoaded",this.handleFileListLoad_)};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.users.reviewer.form.LimitFilesFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.grid.users.reviewer.form.LimitFilesFormHandler.prototype.handleFormChange=
function(){this.getHtmlElement().find('input[name="selectedFiles[]"]:checked').length?this.hideWarning():this.showWarning()};a.pkp.controllers.grid.users.reviewer.form.LimitFilesFormHandler.prototype.hideWarning=function(){this.getHtmlElement().find("#noFilesWarning").hide(250)};a.pkp.controllers.grid.users.reviewer.form.LimitFilesFormHandler.prototype.showWarning=function(){this.getHtmlElement().find("#noFilesWarning").show(250)};a.pkp.controllers.grid.users.reviewer.form.LimitFilesFormHandler.prototype.handleFileListLoad_=
function(){this.getHtmlElement().change()}})(jQuery);(function(a){a.pkp.controllers.grid.users.reviewer.form.AddReviewerFormHandler=function(a,b){this.parent(a,b);b.templateUrl&&(this.templateUrl_=b.templateUrl);a.find("#template").change(this.callbackWrapper(this.selectTemplateHandler_))};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.users.reviewer.form.AddReviewerFormHandler,a.pkp.controllers.grid.users.reviewer.form.LimitFilesFormHandler);a.pkp.controllers.grid.users.reviewer.form.AddReviewerFormHandler.prototype.templateUrl_=null;a.pkp.controllers.grid.users.reviewer.form.AddReviewerFormHandler.prototype.showWarning=
function(){this.parent("showWarning");this.getHtmlElement().find("#reviewerFormFooter").trigger("expandFileList")};a.pkp.controllers.grid.users.reviewer.form.AddReviewerFormHandler.prototype.selectTemplateHandler_=function(){var c=this.getHtmlElement();a.post(this.templateUrl_,c.find("#template").serialize(),this.callbackWrapper(this.updateTemplate),"json")};a.pkp.controllers.grid.users.reviewer.form.AddReviewerFormHandler.prototype.updateTemplate=function(a,b){var d=this.getHtmlElement(),e=this.handleJson(b);
!1!==e&&""!==e.content&&d.find('textarea[name="personalMessage"]').val(e.content);return e.status}})(jQuery);(function(a){a.pkp.controllers.grid.users.reviewer.form.ReviewerFormFooterHandler=function(c,b){this.parent(c,b);a("input[id^='responseDueDate']").datepicker({dateFormat:"yy-mm-dd"});a("input[id^='reviewDueDate']").datepicker({dateFormat:"yy-mm-dd"});a("#filesAccordion").accordion({collapsible:!0,active:!1,autoHeight:!1,clearStyle:!0});this.bind("expandFileList",this.handleExpandFileList_)};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.users.reviewer.form.ReviewerFormFooterHandler,a.pkp.classes.Handler);
a.pkp.controllers.grid.users.reviewer.form.ReviewerFormFooterHandler.prototype.handleExpandFileList_=function(){var a=this.getHtmlElement().find("#filesAccordion");!1===a.accordion("option","active")&&a.accordion("option","active","0")}})(jQuery);(function(a){a.pkp.controllers.grid.users.reviewer.form.AdvancedSearchReviewerFilterFormHandler=function(a,b){this.parent(a,b);this.initSlider_("#completeRange",0,100,'[id^="doneMin-"]','[id^="doneMax-"]');this.initSlider_("#activeRange",0,100,'[id^="activeMin-"]','[id^="activeMax-"]');this.initSlider_("#averageRange",0,365,'[id^="avgMin-"]','[id^="avgMax-"]');this.initSlider_("#lastRange",0,365,'[id^="lastMin-"]','[id^="lastMax-"]')};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.users.reviewer.form.AdvancedSearchReviewerFilterFormHandler,
a.pkp.controllers.form.ClientFormHandler);a.pkp.controllers.grid.users.reviewer.form.AdvancedSearchReviewerFilterFormHandler.prototype.initSlider_=function(c,b,d,e,f){var i=a(e),g=a(f);a(c).slider({range:!0,min:b,max:d,values:[i.val(),g.val()],slide:function(a,b){i.val(b.values[0]);g.val(b.values[1])}})}})(jQuery);(function(a){a.pkp.controllers.grid.users.stageParticipant=a.pkp.controllers.grid.users.stageParticipant||{form:{}};a.pkp.controllers.grid.users.stageParticipant.form.StageParticipantNotifyHandler=function(a,b){this.parent(a,b);b.templateUrl&&(this.templateUrl_=b.templateUrl);a.find("#template").change(this.callbackWrapper(this.selectTemplateHandler_))};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.users.stageParticipant.form.StageParticipantNotifyHandler,a.pkp.controllers.form.AjaxFormHandler);
a.pkp.controllers.grid.users.stageParticipant.form.StageParticipantNotifyHandler.prototype.templateUrl_=null;a.pkp.controllers.grid.users.stageParticipant.form.StageParticipantNotifyHandler.prototype.selectTemplateHandler_=function(){var c=this.getHtmlElement();a.post(this.templateUrl_,c.find("#template").serialize(),this.callbackWrapper(this.updateTemplate),"json")};a.pkp.controllers.grid.users.stageParticipant.form.StageParticipantNotifyHandler.prototype.updateTemplate=function(a,b){var d=this.getHtmlElement(),
e=this.handleJson(b);!1!==e&&""!==e.content&&d.find('textarea[name="message"]').val(e.content);return e.status}})(jQuery);(function(a){a.pkp.controllers.grid.users.stageParticipant.form=a.pkp.controllers.grid.users.stageParticipant.form||{};a.pkp.controllers.grid.users.stageParticipant.form.AddParticipantFormHandler=function(c,b){this.parent(c,b);this.fetchUserListUrl_=b.fetchUserListUrl;a("#userGroupId",c).change(this.callbackWrapper(this.updateUserList));this.updateUserList()};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.users.stageParticipant.form.AddParticipantFormHandler,a.pkp.controllers.grid.users.stageParticipant.form.StageParticipantNotifyHandler);
a.pkp.controllers.grid.users.stageParticipant.form.AddParticipantFormHandler.prototype.fetchUserListUrl_=null;a.pkp.controllers.grid.users.stageParticipant.form.AddParticipantFormHandler.prototype.updateUserList=function(){var c=this.fetchUserListUrl_,b=this.getHtmlElement().find("#userGroupId"),c=c.replace(/(&userGroupId=\d+)?$/,"&userGroupId="+b.val());a.get(c,null,this.callbackWrapper(this.updateUserListHandler_),"json")};a.pkp.controllers.grid.users.stageParticipant.form.AddParticipantFormHandler.prototype.updateUserListHandler_=
function(c,b){var d=this.handleJson(b),e=this.getHtmlElement().find("#userId"),f,i;e.find('option[value!=""]').remove();for(f in d.content)i=a("<option/>"),i.attr("value",f),i.text(d.content[f]),e.append(i)}})(jQuery);(function(a){a.pkp.pages.reviewer=a.pkp.pages.reviewer||{};a.pkp.pages.reviewer.ReviewerTabHandler=function(a,b){this.parent(a,b);this.reviewStep_=b.reviewStep;this.bind("setStep",this.setStepHandler);this.getHtmlElement().tabs("option","disabled",this.getDisabledSteps(this.reviewStep_))};a.pkp.classes.Helper.inherits(a.pkp.pages.reviewer.ReviewerTabHandler,a.pkp.controllers.TabHandler);a.pkp.pages.reviewer.ReviewerTabHandler.prototype.reviewStep_=null;a.pkp.pages.reviewer.ReviewerTabHandler.prototype.setStepHandler=
function(a,b,d){this.getHtmlElement().tabs("option","disabled",this.getDisabledSteps(d));this.getHtmlElement().tabs("option","selected",d-1)};a.pkp.pages.reviewer.ReviewerTabHandler.prototype.getDisabledSteps=function(a){switch(a){case 1:return[1,2,3];case 2:return[2,3];case 3:return[3];case 4:return[]}throw Error("Illegal review step number.");}})(jQuery);(function(a){a.pkp.pages.authorDashboard=a.pkp.pages.authorDashboard||{};a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler=function(c,b){this.parent(c,b);a(".pkp_authorDashboard_stageContainer",c).accordion({autoHeight:!1,collapsible:!0});this.setWorkflowStage_(b.currentStage);this.forwardGridEvents_()};a.pkp.classes.Helper.inherits(a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler,a.pkp.classes.Handler);a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler.CSS_SELECTORS={};a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler.CSS_SELECTORS[a.pkp.cons.WORKFLOW_STAGE_ID_SUBMISSION]=
"#submission";a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler.CSS_SELECTORS[a.pkp.cons.WORKFLOW_STAGE_ID_EXTERNAL_REVIEW]="#externalReview";a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler.CSS_SELECTORS[a.pkp.cons.WORKFLOW_STAGE_ID_EDITING]="#copyediting";a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler.CSS_SELECTORS[a.pkp.cons.WORKFLOW_STAGE_ID_PRODUCTION]="#production";a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler.prototype.currentStage_=null;a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler.prototype.setWorkflowStage_=
function(c){this.currentStage_=c;var b=this.getHtmlElement(),d=this.self("CSS_SELECTORS"),e,f;for(f=a.pkp.cons.WORKFLOW_STAGE_ID_SUBMISSION;f<=a.pkp.cons.WORKFLOW_STAGE_ID_PRODUCTION;f++)e=f<=c?!1:!0,a(d[f],b).accordion("option","disable",e);a(".pkp_authorDashboard_stageContainer",b).not(d[c]).accordion("activate",!1);c=a(d[c]+".pkp_authorDashboard_stageContainer",b);0!==c.accordion("option","active")&&c.accordion("activate",0)};a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler.prototype.forwardGridEvents_=
function(){var c=this.getHtmlElement();a("#addFile",c).bind("dataChanged",function(b){a('[id^="component-grid-files-review-authorreviewrevisionsgrid"]:visible',c).trigger(b)})}})(jQuery);(function(a){a.pkp.pages.authorDashboard.SubmissionEmailHandler=function(a,b){this.parent(a,b);a.find('a[id^="submissionEmail"]').click(this.callbackWrapper(this.activateAction))};a.pkp.classes.Helper.inherits(a.pkp.pages.authorDashboard.SubmissionEmailHandler,a.pkp.controllers.linkAction.LinkActionHandler)})(jQuery);(function(a){a.pkp.controllers.grid.content=a.pkp.controllers.grid.content||{spotlights:{form:{}}};a.pkp.controllers.grid.content.spotlights.form.SpotlightFormHandler=function(c,b){this.parent(c,b);this.autocompleteUrl_=b.autocompleteUrl;a('[id^="assocId_input"]',c).keyup(this.callbackWrapper(this.addNameToAutocompleteUrl))};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.content.spotlights.form.SpotlightFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.grid.content.spotlights.form.SpotlightFormHandler.prototype.autocompleteUrl_=
null;a.pkp.controllers.grid.content.spotlights.form.SpotlightFormHandler.prototype.addNameToAutocompleteUrl=function(c){var b=this.getHtmlElement().find("#assocId_container"),b=a.pkp.classes.Handler.getHandler(b),d=this.autocompleteUrl_.replace("/(&name=[^&]*)/",""),d=d+("&name="+encodeURIComponent(c.value));b.setAutocompleteUrl(d)}})(jQuery);(function(a){a.pkp.controllers.modals.editorDecision.ApproveProofsHandler=function(a,b){this.parent(a,b);this.bind("gridRefreshRequested",this.callbackWrapper(function(){this.trigger("dataChanged")}))};a.pkp.classes.Helper.inherits(a.pkp.controllers.modals.editorDecision.ApproveProofsHandler,a.pkp.classes.Handler)})(jQuery);(function(a){a.pkp.controllers.modals.catalogEntry=a.pkp.controllers.modals.catalogEntry||{form:{}};a.pkp.controllers.modals.catalogEntry.form.RepresentativeFormHandler=function(a,b){this.parent(a,b);a.find(":radio").change(this.callbackWrapper(this.radioToggleHandler_))};a.pkp.classes.Helper.inherits(a.pkp.controllers.modals.catalogEntry.form.RepresentativeFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.modals.catalogEntry.form.RepresentativeFormHandler.prototype.radioToggleHandler_=
function(a){var b=this.getHtmlElement();"agent"==a.id?(b.find("#agentRole").parent().removeClass("hidden"),b.find("#agentRole").show(),b.find("#supplierRole").hide()):"supplier"==a.id&&(b.find("#agentRole").hide(),b.find("#supplierRole").parent().removeClass("hidden"),b.find("#supplierRole").show())}})(jQuery);(function(a){a.pkp.controllers.modals.catalogEntry.form.PublicationFormatMetadataFormHandler=function(a,b){this.parent(a,b);a.find("#override").click(this.callbackWrapper(this.overrideToggleHandler_));a.find("#override").triggerHandler("click")};a.pkp.classes.Helper.inherits(a.pkp.controllers.modals.catalogEntry.form.PublicationFormatMetadataFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.modals.catalogEntry.form.PublicationFormatMetadataFormHandler.prototype.overrideToggleHandler_=
function(c){var b=this.getHtmlElement().find('[id^="fileSize"]');a(c).is(":checked")?b.attr("disabled",""):b.attr("disabled","disabled")}})(jQuery);(function(a){a.pkp.controllers.modals.submissionMetadata=a.pkp.controllers.modals.submissionMetadata||{};a.pkp.controllers.modals.submissionMetadata.MonographlessCatalogEntryHandler=function(a,b){this.parent(a,b);this.metadataFormUrlTemplate_=b.metadataFormUrlTemplate;this.bind("selectMonograph",this.selectMonographHandler)};a.pkp.classes.Helper.inherits(a.pkp.controllers.modals.submissionMetadata.MonographlessCatalogEntryHandler,a.pkp.classes.Handler);a.pkp.controllers.modals.submissionMetadata.MonographlessCatalogEntryHandler.prototype.metadataFormUrlTemplate_=
"";a.pkp.controllers.modals.submissionMetadata.MonographlessCatalogEntryHandler.prototype.getMetadataEditFormUrl_=function(a,b){return this.metadataFormUrlTemplate_.replace("MONOGRAPH_ID",a).replace("STAGE_ID",b)};a.pkp.controllers.modals.submissionMetadata.MonographlessCatalogEntryHandler.prototype.selectMonographHandler=function(c,b,d){parseInt(d,10)?a.get(this.getMetadataEditFormUrl_(d,a.pkp.cons.WORKFLOW_STAGE_ID_PRODUCTION),this.callbackWrapper(this.showFetchedMetadataForm_),"json"):a("#metadataFormContainer").children().remove()};
a.pkp.controllers.modals.submissionMetadata.MonographlessCatalogEntryHandler.prototype.showFetchedMetadataForm_=function(c,b){var d=this.handleJson(b),e=a("#metadataFormContainer");e.children().remove();e.append(d.content)}})(jQuery);(function(a){a.pkp.controllers.modals.expeditedSubmission=a.pkp.controllers.modals.expeditedSubmission||{form:{}};a.pkp.controllers.modals.expeditedSubmission.form.ExpeditedSubmissionMetadataFormHandler=function(c,b){this.parent(c,b);a('[name^="salesType"]',c).change(this.callbackWrapper(this.setPrices))};a.pkp.classes.Helper.inherits(a.pkp.controllers.modals.expeditedSubmission.form.ExpeditedSubmissionMetadataFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.modals.expeditedSubmission.form.ExpeditedSubmissionMetadataFormHandler.prototype.setPrices=
function(){var a=this.getHtmlElement(),b=a.find('[name^="salesType"]:checked').val(),a=a.find('[id^="price"]');"openAccess"==b?(a.attr("disabled","disabled"),a.val("0")):"notAvailable"==b?(a.attr("disabled","disabled"),a.val("")):a.removeAttr("disabled")}})(jQuery);(function(a){a.pkp.controllers.grid.files.proof=a.pkp.controllers.grid.files.proof||{form:{}};a.pkp.controllers.grid.files.proof.form.ApprovedProofFormHandler=function(c,b){this.parent(c,b);this.salesType_=b.salesType;c.find("#notAvailable, #openAccess, #directSales").click(this.callbackWrapper(this.checkHandler_));var d=a('input[id^="price"]');d.change(this.callbackWrapper(this.changeHandler_));""!==this.salesType_&&(""===d.attr("value")?(a("#notAvailable").attr("checked","true"),d.attr("disabled",
"true")):"0"===d.attr("value")?(a("#openAccess").attr("checked","true"),d.attr("disabled","true").attr("value","")):a("#directSales").attr("checked","true"))};a.pkp.classes.Helper.inherits(a.pkp.controllers.grid.files.proof.form.ApprovedProofFormHandler,a.pkp.controllers.form.AjaxFormHandler);a.pkp.controllers.grid.files.proof.form.ApprovedProofFormHandler.prototype.salesType_=null;a.pkp.controllers.grid.files.proof.form.ApprovedProofFormHandler.prototype.checkHandler_=function(c){var b=a('input[id^="price"]');
"directSales"===a(c).attr("id")?(b.removeAttr("disabled"),""===b.val()?this.disableFormControls():this.enableFormControls()):(b.attr("disabled","true"),this.enableFormControls());return!0};a.pkp.controllers.grid.files.proof.form.ApprovedProofFormHandler.prototype.changeHandler_=function(c){c=a(c);""===c.val()||isNaN(c.val())?this.disableFormControls():this.enableFormControls();return!0}})(jQuery);(function(a){a.pkp.controllers.tab.catalogEntry=a.pkp.controllers.tab.catalogEntry||{};a.pkp.controllers.tab.catalogEntry.CatalogEntryTabHandler=function(a,b){b.selectedFormatId&&(b.selected=this.getTabPositionByFormatId_(b.selectedFormatId,a));this.parent(a,b);this.bind("gridRefreshRequested",this.gridRefreshRequested);b.tabsUrl&&(this.tabsUrl_=b.tabsUrl);b.tabContentUrl&&(this.tabContentUrl_=b.tabContentUrl);this.bind("gridInitialized",this.addFormatsGridRowActionHandlers_);this.publishEvent("gridInitialized")};
a.pkp.classes.Helper.inherits(a.pkp.controllers.tab.catalogEntry.CatalogEntryTabHandler,a.pkp.controllers.TabHandler);a.pkp.controllers.tab.catalogEntry.CatalogEntryTabHandler.prototype.tabContentUrl_=null;a.pkp.controllers.tab.catalogEntry.CatalogEntryTabHandler.prototype.gridRefreshRequested=function(c,b){var d=a(b.target);d.attr("id").match(/^formatsGridContainer/)&&(this.tabsUrl_&&this.tabContentUrl_)&&(this.getHtmlElement(),a.get(this.tabsUrl_,null,this.callbackWrapper(this.updateTabsHandler_),
"json"));d.attr("id").match(/approvedProofGrid/)&&this.trigger("dataChanged")};a.pkp.controllers.tab.catalogEntry.CatalogEntryTabHandler.prototype.updateTabsHandler_=function(a,b){var d=this.handleJson(b),e=this.getHtmlElement(),f=e.find("li a"),i={},g=/publication(\d+)/,h,j,k;e.unwrap();e.prev("div").remove();e.find("li").first().unwrap().unwrap();for(j=0;j<f.length;j++)k=f[j].getAttribute("id"),k=g.exec(k),null!==k&&(i[k[1]]=j);for(h in d.formats)i.hasOwnProperty(h)||(f=this.tabContentUrl_+"&publicationFormatId="+
encodeURIComponent(h),f=f.replace(/[$]/g,"$$$$"),e.tabs("add",f,d.formats[h]),e.find("li a").filter(":last").attr("id","publication"+h));for(h in i)d.formats.hasOwnProperty(h)?e.find("li a").filter('[id="publication'+h+'"]').html(d.formats[h]):e.tabs("remove",i[h]);e.tabs().scrollabletab()};a.pkp.controllers.tab.catalogEntry.CatalogEntryTabHandler.prototype.addFormatsGridRowActionHandlers_=function(){var c=a('[id^="formatsGridContainer"]',this.getHtmlElement());c.length&&(c=a('a[id*="publicationFormatTab"]',
c),c.click(this.callbackWrapper(this.formatsGridLinkClickHandler_)))};a.pkp.controllers.tab.catalogEntry.CatalogEntryTabHandler.prototype.formatsGridLinkClickHandler_=function(c){var b=a('[id^="formatsGridContainer"]',this.getHtmlElement()).children("div"),b=a.pkp.classes.Handler.getHandler(b),c=b.getParentRow(a(c)),c=b.getRowDataId(c);this.getHtmlElement().tabs("select",this.getTabPositionByFormatId_(c,this.getHtmlElement()))};a.pkp.controllers.tab.catalogEntry.CatalogEntryTabHandler.prototype.getTabPositionByFormatId_=
function(c,b){var d=a("#publication"+c,b).parent("li");return d.length?b.find("li").index(d):null};a.pkp.controllers.tab.catalogEntry.CatalogEntryTabHandler.prototype.tabsReloadRequested=function(c,b,d){var e=this.getHtmlElement();a.get(d.tabsUrl,function(b){b=a.parseJSON(b);e.unwrap();e.prev("div").remove();e.replaceWith(b.content)})}})(jQuery);(function(a){a.pkp.controllers.tab.publicationFormat=a.pkp.controllers.tab.publicationFormat||{};a.pkp.controllers.tab.publicationFormat.PublicationFormatsTabHandler=function(c,b){if(void 0!==b.currentFormatTabId){var d=a("#publication"+b.currentFormatTabId,c).parent("li");d.length&&(b.selected=c.children().children().index(d))}this.parent(c,b);this.tabsUrl_=b.tabsUrl;this.bind("refreshTabs",this.refreshTabsHandler_)};a.pkp.classes.Helper.inherits(a.pkp.controllers.tab.publicationFormat.PublicationFormatsTabHandler,
a.pkp.controllers.TabHandler);a.pkp.controllers.tab.publicationFormat.PublicationFormatsTabHandler.prototype.tabsUrl_=null;a.pkp.controllers.tab.publicationFormat.PublicationFormatsTabHandler.prototype.refreshTabsHandler_=function(){if(this.tabsUrl_){var c=null;this.getHtmlElement();var b=a("li.ui-tabs-selected",this.getHtmlElement()).find("a");b.length&&(c=b.attr("id"),c=a.trim(c.replace("publication"," ")));a.get(this.tabsUrl_,{currentFormatTabId:c},this.callbackWrapper(this.updateTabsHandler_),
"json")}};a.pkp.controllers.tab.publicationFormat.PublicationFormatsTabHandler.prototype.updateTabsHandler_=function(a,b){this.trigger("gridRefreshRequested");var d=this.handleJson(b),e=this.getHtmlElement();!1!==d&&e.replaceWith(d.content)}})(jQuery);(function(a){a.pkp.controllers.catalog=a.pkp.controllers.catalog||{form:{}};a.pkp.controllers.catalog.form.CatalogMetadataFormHandler=function(c,b){this.parent(c,b);a("#audienceRangeExact",c).change(this.callbackWrapper(this.ensureValidAudienceRanges_))};a.pkp.classes.Helper.inherits(a.pkp.controllers.catalog.form.CatalogMetadataFormHandler,a.pkp.controllers.form.FileUploadFormHandler);a.pkp.controllers.catalog.form.CatalogMetadataFormHandler.prototype.audienceValues_=null;a.pkp.controllers.catalog.form.CatalogMetadataFormHandler.prototype.ensureValidAudienceRanges_=
function(c){var b=this.getHtmlElement();""!==a(c).val()?(this.audienceValues_=[b.find("#audienceRangeFrom").val(),b.find("#audienceRangeTo").val()],b.find("#audienceRangeFrom, #audienceRangeTo").val("").attr("disabled","disabled")):(b.find("#audienceRangeFrom, #audienceRangeTo").attr("disabled",""),b.find("#audienceRangeFrom").val(this.audienceValues_[0]),b.find("#audienceRangeTo").val(this.audienceValues_[1]))}})(jQuery);(function(a){a.pkp.controllers.monographList=a.pkp.controllers.monographList||{};a.pkp.controllers.monographList.MonographListHandler=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.controllers.monographList.MonographListHandler,a.pkp.classes.Handler);a.pkp.controllers.monographList.MonographListHandler.prototype.getMonographs=function(){throw Error("Method must be implemented by subclasses.");};a.pkp.controllers.monographList.MonographListHandler.prototype.formatList=function(){for(var a=
this.getMonographs(),b=a.first().width()+10,d=this.getHtmlElement().width(),b=Math.floor(d/b),d=0;d<a.size();d+=b)a.slice(d,d+b).equalizeElementHeights()}})(jQuery);(function(a){a.pkp.pages.catalog=a.pkp.pages.catalog||{};a.pkp.pages.catalog.CarouselHandler=function(c,b){this.parent(c,b);a(".details_box",c).hide();var d=c.find("img");d.bind("load",this.callbackWrapper(this.loadCallback_));d.css("opacity",this.MIN_OPACITY_);a("li.mover",c).click(this.callbackWrapper(this.clickHandler_));this.bind("blur",this.callbackWrapper(this.blurCallback_));this.bind("focus",this.callbackWrapper(this.focusCallback_));a("#nextCarouselItem",c).click(this.callbackWrapper(this.nextItemClickHandler_));
a("#previousCarouselItem",c).click(this.callbackWrapper(this.previousItemClickHandler_));this.applyCarouselPlugin_()};a.pkp.classes.Helper.inherits(a.pkp.pages.catalog.CarouselHandler,a.pkp.classes.Handler);a.pkp.pages.catalog.CarouselHandler.prototype.TRANSITION_DURATION_=550;a.pkp.pages.catalog.CarouselHandler.prototype.MIN_OPACITY_=0.5;a.pkp.pages.catalog.CarouselHandler.prototype.MAX_PLACEHOLDER_NUMBER_=8;a.pkp.pages.catalog.CarouselHandler.prototype.blurCallback_=function(c,b,d){this.toggleFeature_(a(d.target),
!1)};a.pkp.pages.catalog.CarouselHandler.prototype.focusCallback_=function(c,b,d){this.toggleFeature_(a(d.target),!0)};a.pkp.pages.catalog.CarouselHandler.prototype.loadCallback_=function(c,b){var d=a(b.target).parents(".mover");d.hasClass("mover")&&(d.find(".pkp_helpers_progressIndicator").hide(),d.find("img").parent("div").addClass("pkp_helpers_black_bg"),d.hasClass("roundabout-in-focus")&&this.toggleFeature_(a(".roundabout-in-focus"),!0))};a.pkp.pages.catalog.CarouselHandler.prototype.clickHandler_=
function(c){c=a(c);if(c.hasClass("placeholder"))return!1;this.getHtmlElement().find("ul.pkp_catalog_carousel").roundabout("animateToChild",c.index());return!0};a.pkp.pages.catalog.CarouselHandler.prototype.nextItemClickHandler_=function(){this.moveItems_(1)};a.pkp.pages.catalog.CarouselHandler.prototype.previousItemClickHandler_=function(){this.moveItems_(-1)};a.pkp.pages.catalog.CarouselHandler.prototype.moveItems_=function(c){var b=a(".roundabout-in-focus",this.getHtmlElement()).index(),d=a(".mover",
this.getHtmlElement()).length;b==d-1&&0<c&&(b=-1);c=a(a("li",this.getHtmlElement()).get(b+c));return c.hasClass("mover")&&!c.hasClass("placeholder")?(this.getHtmlElement().find("ul.pkp_catalog_carousel").roundabout("animateToChild",c.index()),!0):!1};a.pkp.pages.catalog.CarouselHandler.prototype.applyCarouselPlugin_=function(){var c=this.getHtmlElement(),b=this.getMinScale_(),d,e;this.addPlaceholders_();d=a("li.mover",c).not(".placeholder").first().index();e=a("li.mover",c).not(".placeholder").length;
e=Math.ceil(e/2);d=d+e-1;c.parent().show();a("ul.pkp_catalog_carousel",c).roundabout({minZ:0,maxZ:360,minOpacity:1,minScale:b,duration:this.TRANSITION_DURATION_,triggerFocusEvents:!0,triggerBlurEvents:!0,clickToFocus:!1,startingChild:d})};a.pkp.pages.catalog.CarouselHandler.prototype.toggleFeature_=function(c,b){var d=a("img",c),e=a(".details_box",c),f=1,i=this.TRANSITION_DURATION_;b||(f=this.MIN_OPACITY_,i=250,e.hide(250));d.css("opacity")!=f&&(a("img",c).animate({opacity:f},i),b?e.show(250):e.hide(250))};
a.pkp.pages.catalog.CarouselHandler.prototype.addPlaceholders_=function(){var a=this.getHtmlElement().find("ul.pkp_catalog_carousel"),b=a.find("li.mover").length,b=this.MAX_PLACEHOLDER_NUMBER_-b;if(0<b)for(;0<b;b--)a.prepend('<li class="mover placeholder"></li>')};a.pkp.pages.catalog.CarouselHandler.prototype.getMinScale_=function(){var a=0.3-0.003*4*this.getHtmlElement().find("li").length;return 0.05>a?0.05:a}})(jQuery);(function(a){a.pkp.pages.catalog.MonographPublicListHandler=function(a,b){this.parent(a,b);this.formatList()};a.pkp.classes.Helper.inherits(a.pkp.pages.catalog.MonographPublicListHandler,a.pkp.controllers.monographList.MonographListHandler);a.pkp.pages.catalog.MonographPublicListHandler.prototype.getMonographs=function(){return this.getHtmlElement().find(".pkp_catalog_monograph")}})(jQuery);(function(a){a.pkp.pages.manageCatalog=a.pkp.pages.manageCatalog||{};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler=function(c,b){this.parent(c,b);this.searchTabIndex_=b.searchTabIndex;this.spotlightTabName_=b.spotlightTabName;this.seriesFetchUrlTemplate_=b.seriesFetchUrlTemplate;this.categoryFetchUrlTemplate_=b.categoryFetchUrlTemplate;this.spotlightsUrl_=b.spotlightsUrl;var d=a("#catalogTabs").tabs();d.tabs("disable",this.searchTabIndex_);this.bind("searchCatalog",this.searchCatalogHandler_);
this.bind("selectCategory",this.selectCategoryHandler_);this.bind("selectSeries",this.selectSeriesHandler_);d.bind("tabsselect",this.callbackWrapper(this.selectTabHandler_));d.bind("tabsshow",this.callbackWrapper(this.showTabHandler_));this.bind("dataChanged",this.dataChangedHandler_)};a.pkp.classes.Helper.inherits(a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler,a.pkp.classes.Handler);a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.searchTabIndex_=0;a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.spotlightTabName_=
null;a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.seriesFetchUrlTemplate_=null;a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.categoryFetchUrlTemplate_=null;a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.spotlightsUrl_=null;a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.getSeriesFetchUrl_=function(a){return this.seriesFetchUrlTemplate_.replace("SERIES_PATH",a)};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.getCategoryFetchUrl_=
function(a){return this.categoryFetchUrlTemplate_.replace("CATEGORY_PATH",a)};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.searchCatalogHandler_=function(c,b,d){c=this.searchTabIndex_;b=a("#catalogTabs");b.tabs("option","selected")===c?b.tabs("url",c,d).tabs("load",c):b.tabs("url",c,d).tabs("enable",c).tabs("select",c)};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.selectSeriesHandler_=function(c,b,d){a("#seriesContainer").children().remove();"0"!==d&&a.get(this.getSeriesFetchUrl_(d),
this.callbackWrapper(this.showFetchedSeries_),"json")};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.selectCategoryHandler_=function(c,b,d){a("#categoryContainer").children().remove();"0"!==d&&a.get(this.getCategoryFetchUrl_(d),this.callbackWrapper(this.showFetchedCategory_),"json")};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.selectTabHandler_=function(c,b,d){var e,f;"categoryTab"==d.panel.id&&(e=a(c).find("#categorySelect"),f=e.find("option").first().val(),void 0!==
f&&(e.find("option").eq(0).attr("selected","selected"),this.selectCategoryHandler_(c,b,f)));"seriesTab"==d.panel.id&&(e=a(c).find("#seriesSelect"),d=e.find("option").first().val(),void 0!==d&&(e.find("option").eq(0).attr("selected","selected"),this.selectSeriesHandler_(c,b,d)));return!0};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.showTabHandler_=function(){var c;a("#catalogTabs").tabs().tabs("option","selected")!==this.searchTabIndex_&&(c=this.getHtmlElement(),c.find('[id^="catalogSearch"]').val(""));
return!0};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.loadSpotlightsContent_=function(c){a.get(c,function(b){b=a.parseJSON(b);a("#spotlightsTab").html(b.content)})};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.dataChangedHandler_=function(){var c=a("#catalogTabs").tabs(),b=c.tabs("option","selected");switch(b){case 0:c.tabs("load",0);break;case 1:a("#selectCategoryForm",this.getHtmlElement()).trigger("containerReloadRequested");break;case 2:a("#selectSeriesForm",
this.getHtmlElement()).trigger("containerReloadRequested");break;case 3:case 4:this.searchTabIndex_==b?a("#catalogSearchForm",this.getHtmlElement()).trigger("submit"):this.loadSpotlightsContent_(this.spotlightsUrl_)}};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.showFetchedSeries_=function(c,b){var d=this.handleJson(b);a("#seriesContainer").append(d.content)};a.pkp.pages.manageCatalog.ManageCatalogHeaderHandler.prototype.showFetchedCategory_=function(c,b){var d=this.handleJson(b);
a("#categoryContainer").append(d.content)}})(jQuery);(function(a){a.pkp.pages.manageCatalog.ManageCatalogModalHandler=function(c,b){this.parent(c,b);a("#cancelFormButton",c).click(this.callbackWrapper(this.cancelForm))};a.pkp.classes.Helper.inherits(a.pkp.pages.manageCatalog.ManageCatalogModalHandler,a.pkp.controllers.form.FormHandler);a.pkp.pages.manageCatalog.ManageCatalogModalHandler.prototype.cancelForm=function(){this.trigger("containerReloadRequested");this.trigger("formCanceled");return!1}})(jQuery);(function(a){a.pkp.pages.manageCatalog.ManageCatalogSearchFormHandler=function(a,b){b.submitHandler=this.submitForm;this.parent(a,b);this.publishEvent("searchCatalog")};a.pkp.classes.Helper.inherits(a.pkp.pages.manageCatalog.ManageCatalogSearchFormHandler,a.pkp.controllers.form.FormHandler);a.pkp.pages.manageCatalog.ManageCatalogSearchFormHandler.prototype.submitForm=function(){var a=this.getHtmlElement(),b=a.attr("action"),a=a.find(":input").val();this.trigger("searchCatalog",[b.replace("SEARCH_TEXT_DUMMY",
encodeURIComponent(a))])}})(jQuery);(function(a){a.pkp.pages.manageCatalog.MonographManagementListHandler=function(a,b){this.parent(a,b);a.find(".feature").click(this.callbackWrapper(this.featureButtonHandler_));this.bind("monographListChanged",this.monographListChangedHandler_);this.bind("monographSequencesChanged",this.monographSequencesChangedHandler_);this.useGridView()};a.pkp.classes.Helper.inherits(a.pkp.pages.manageCatalog.MonographManagementListHandler,a.pkp.controllers.monographList.MonographListHandler);a.pkp.pages.manageCatalog.MonographManagementListHandler.prototype.inFeatureMode_=
!1;a.pkp.pages.manageCatalog.MonographManagementListHandler.prototype.inGridMode_=null;a.pkp.pages.manageCatalog.MonographManagementListHandler.prototype.useGridView=function(){var c=a(this.getHtmlElement());c.find(".pkp_manageCatalog_monographList").removeClass("list_view").addClass("grid_view");this.resetElementHeights_();c=c.find(".submission_actions");c.find(".grid_view").addClass("ui-state-active");c.find(".list_view").removeClass("ui-state-active");this.inGridMode_=!0;return!1};a.pkp.pages.manageCatalog.MonographManagementListHandler.prototype.getMonographs=
function(){return this.getHtmlElement().find(".pkp_manageCatalog_monograph")};a.pkp.pages.manageCatalog.MonographManagementListHandler.prototype.featureButtonHandler_=function(){this.inFeatureMode_=!this.inFeatureMode_;var c=a(this.getHtmlElement()),b=c.find(".submission_actions").find(".feature"),c=c.find("ul.pkp_manageCatalog_monographList"),d=c.find(".pkp_manageCatalog_featureTools");this.inFeatureMode_?(b.css("font-weight","bold"),d.removeClass("pkp_helpers_invisible")):(b.css("font-weight","normal"),
d.addClass("pkp_helpers_invisible"));c.children().trigger("changeDragMode",[this.inFeatureMode_]);this.trigger("monographListChanged");return!1};a.pkp.pages.manageCatalog.MonographManagementListHandler.prototype.monographListChangedHandler_=function(){this.getHtmlElement().find("ul.pkp_manageCatalog_monographList").children("li").sortElements(function(c,b){var d=a.pkp.classes.Handler.getHandler(a(c)),e=a.pkp.classes.Handler.getHandler(a(b));return d.getFeatured()&&!e.getFeatured()?-1:e.getFeatured()&&
!d.getFeatured()?1:d.getFeatured()&&e.getFeatured()?d.getSeq()-e.getSeq():e.getDatePublished()-d.getDatePublished()});this.getHtmlElement().sortable("destroy");this.getHtmlElement().sortable({disabled:!this.inFeatureMode_,items:"li.pkp_manageCatalog_monograph:not(.not_sortable)",update:this.callbackWrapper(this.sortUpdateHandler_),start:function(c,b){a(b.placeholder).slideUp()},change:function(c,b){a(b.placeholder).hide().slideDown()}});this.resetElementHeights_();return!1};a.pkp.pages.manageCatalog.MonographManagementListHandler.prototype.monographSequencesChangedHandler_=
function(c,b,d){this.getHtmlElement().find("ul.pkp_manageCatalog_monographList").children("li").each(function(b,c){var i=a.pkp.classes.Handler.getHandler(a(c)),g=d[i.getId()];g&&i.trigger("setSequence",[g,!1])});this.trigger("monographListChanged");return!1};a.pkp.pages.manageCatalog.MonographManagementListHandler.prototype.sortUpdateHandler_=function(c,b,d){c=d.item;b=c.prev();d=c.next();if(b.length)b=a.pkp.classes.Handler.getHandler(b),b=b.getSeq()+1;else if(d.length)b=a.pkp.classes.Handler.getHandler(d),
b=b.getSeq()-1;else return!1;c.trigger("setSequence",[b]);return!1};a.pkp.pages.manageCatalog.MonographManagementListHandler.prototype.resetElementHeights_=function(){this.formatList()}})(jQuery);(function(a){a.pkp.pages.manageCatalog.MonographHandler=function(a,b){this.parent(a,b);this.submissionId_=b.submissionId;this.seq_=b.seq;this.setFeaturedUrlTemplate_=b.setFeaturedUrlTemplate;this.setNewReleaseUrlTemplate_=b.setNewReleaseUrlTemplate;this.isFeatured_=b.isFeatured;this.isNewRelease_=b.isNewRelease;this.datePublished_=b.datePublished;this.workflowUrl_=b.workflowUrl;this.catalogUrl_=b.catalogUrl;a.find('a[id^="featureMonograph"]').click(this.callbackWrapper(this.featureButtonHandler_));
a.find('a[id^="releaseMonograph"]').click(this.callbackWrapper(this.releaseButtonHandler_));a.unbind("click");a.find('a[id^="catalogEntry"]').click(this.callbackWrapper(this.activateAction));a.find('a[id^="itemWorkflow"]').click(this.callbackWrapper(this.workflowButtonHandler_));a.find('a[id^="publicCatalog"]').click(this.callbackWrapper(this.publicCatalogButtonHandler_));this.publishEvent("monographListChanged");this.publishEvent("monographSequencesChanged");this.bind("changeDragMode",this.changeDragModeHandler_);
this.bind("setSequence",this.setSequenceHandler_);var d=a.find(".pkp_manageCatalog_monograph_image").position(),e=a.find(".pkp_manageCatalog_featureTools").position();a.find(".pkp_manageCatalog_featureTools").css("position","relative").css("top",d.top-e.top)};a.pkp.classes.Helper.inherits(a.pkp.pages.manageCatalog.MonographHandler,a.pkp.controllers.linkAction.LinkActionHandler);a.pkp.pages.manageCatalog.MonographHandler.prototype.seq_=null;a.pkp.pages.manageCatalog.MonographHandler.prototype.datePublished_=
null;a.pkp.pages.manageCatalog.MonographHandler.prototype.submissionId_=null;a.pkp.pages.manageCatalog.MonographHandler.prototype.isFeatured_=null;a.pkp.pages.manageCatalog.MonographHandler.prototype.isNewRelease_=null;a.pkp.pages.manageCatalog.MonographHandler.prototype.workflowUrl_=null;a.pkp.pages.manageCatalog.MonographHandler.prototype.catalogUrl_=null;a.pkp.pages.manageCatalog.MonographHandler.prototype.setFeaturedUrlTemplate_=null;a.pkp.pages.manageCatalog.MonographHandler.prototype.setNewReleaseUrlTemplate_=
null;a.pkp.pages.manageCatalog.MonographHandler.prototype.getDatePublished=function(){return this.datePublished_};a.pkp.pages.manageCatalog.MonographHandler.prototype.getFeatured=function(){return this.isFeatured_};a.pkp.pages.manageCatalog.MonographHandler.prototype.getSeq=function(){return this.seq_};a.pkp.pages.manageCatalog.MonographHandler.prototype.getId=function(){return this.submissionId_};a.pkp.pages.manageCatalog.MonographHandler.prototype.getSetFeaturedUrl_=function(){return this.setFeaturedUrlTemplate_.replace("FEATURED_DUMMY",
this.isFeatured_?"1":"0").replace("SEQ_DUMMY",this.isFeatured_?this.seq_:a.pkp.cons.REALLY_BIG_NUMBER)};a.pkp.pages.manageCatalog.MonographHandler.prototype.getSetNewReleaseUrl_=function(){return this.setNewReleaseUrlTemplate_.replace("RELEASE_DUMMY",this.isNewRelease_?"1":"0")};a.pkp.pages.manageCatalog.MonographHandler.prototype.featureButtonHandler_=function(){this.isFeatured_=this.isFeatured_?!1:!0;a.get(this.getSetFeaturedUrl_(),this.callbackWrapper(this.handleSetFeaturedResponse_),"json");return!1};
a.pkp.pages.manageCatalog.MonographHandler.prototype.releaseButtonHandler_=function(){this.isNewRelease_=this.isNewRelease_?!1:!0;a.get(this.getSetNewReleaseUrl_(),this.callbackWrapper(this.handleSetNewReleaseResponse_),"json");return!1};a.pkp.pages.manageCatalog.MonographHandler.prototype.workflowButtonHandler_=function(){this.workflowUrl_&&(document.location=this.workflowUrl_);return!1};a.pkp.pages.manageCatalog.MonographHandler.prototype.publicCatalogButtonHandler_=function(){this.catalogUrl_&&
(document.location=this.catalogUrl_);return!1};a.pkp.pages.manageCatalog.MonographHandler.prototype.handleSetFeaturedResponse_=function(a,b){var d=this.handleJson(b),e=this.getHtmlElement();this.isFeatured_=null!==d.content?!0:!1;this.seq_=d.content;this.isFeatured_?(e.removeClass("not_sortable").addClass("pkp_helpers_moveicon"),e.find(".star").removeClass("star").addClass("star_highlighted")):(e.addClass("not_sortable").removeClass("pkp_helpers_moveicon"),e.find(".star_highlighted").addClass("star").removeClass("star_highlighted"));
this.trigger("monographListChanged");return!1};a.pkp.pages.manageCatalog.MonographHandler.prototype.handleSetNewReleaseResponse_=function(a,b){var d=this.handleJson(b),e=this.getHtmlElement();(this.isNewRelease_=null!==d.content?!0:!1)?e.find(".release").removeClass("release").addClass("release_highlighted"):e.find(".release_highlighted").addClass("release").removeClass("release_highlighted");return!1};a.pkp.pages.manageCatalog.MonographHandler.prototype.changeDragModeHandler_=function(a,b,d){a=this.getHtmlElement();
d?a.hasClass("not_sortable")||a.addClass("pkp_helpers_moveicon"):a.removeClass("pkp_helpers_moveicon");return!1};a.pkp.pages.manageCatalog.MonographHandler.prototype.setSequenceHandler_=function(c,b,d,e){"undefined"===typeof e&&(e=!0);this.seq_=d;c=this.callbackWrapper(this.handleSetSequenceResponse_);e&&a.get(this.getSetFeaturedUrl_(),c,"json");return!1};a.pkp.pages.manageCatalog.MonographHandler.prototype.handleSetSequenceResponse_=function(a,b){var d=this.handleJson(b);this.trigger("monographSequencesChanged",
d.content);return!1}})(jQuery);(function(a){a.pkp.pages.authorDashboard.AuthorDashboardHandler=function(a,b){this.parent(a,b)};a.pkp.classes.Helper.inherits(a.pkp.pages.authorDashboard.AuthorDashboardHandler,a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler);a.pkp.pages.authorDashboard.AuthorDashboardHandler.CSS_SELECTORS=a.pkp.pages.authorDashboard.PKPAuthorDashboardHandler.CSS_SELECTORS;a.pkp.pages.authorDashboard.AuthorDashboardHandler.CSS_SELECTORS[a.pkp.cons.WORKFLOW_STAGE_ID_INTERNAL_REVIEW]="#internalReview"})(jQuery);(function(a){a.fn.pkpHandler=function(c,b){this.each(function(){var d=a(this);b=b||{};a.pkp.classes.Helper.objectFactory(c,[d,b])});return this};a.fn.pkpAjaxHtml=function(c,b){var d=this.first();a.ajax({url:c,dataType:"json",success:function(a){d.find("#loading").hide();!0===a.status?(a.content&&d.html(a.content),b&&b()):(d.trigger("ajaxHtmlError",a.content),alert(a.content))},error:function(){alert("Failed Ajax request or invalid JSON returned.")}});d.html("<div id='loading' class='throbber'></div>");
return this}})(jQuery);
